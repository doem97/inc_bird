2023-10-25 14:20:43,710 [trainer.py] => config: ./configs/foster_caf22ft1k_384_cs701_lr1e-3_mpc25_bs16.json
2023-10-25 14:20:43,710 [trainer.py] => config_id: foster_caf22ft1k_384_cs701_lr1e-3_mpc25_bs16
2023-10-25 14:20:43,710 [trainer.py] => prefix: cil
2023-10-25 14:20:43,711 [trainer.py] => dataset: cs701
2023-10-25 14:20:43,711 [trainer.py] => memory_size: 2000
2023-10-25 14:20:43,711 [trainer.py] => memory_per_class: 25
2023-10-25 14:20:43,711 [trainer.py] => fixed_memory: True
2023-10-25 14:20:43,711 [trainer.py] => shuffle: False
2023-10-25 14:20:43,711 [trainer.py] => init_cls: 10
2023-10-25 14:20:43,711 [trainer.py] => increment: 10
2023-10-25 14:20:43,711 [trainer.py] => model_name: foster
2023-10-25 14:20:43,711 [trainer.py] => backbone_type: caformer_m36.sail_in22k_ft_in1k_384
2023-10-25 14:20:43,711 [trainer.py] => img_size: 384
2023-10-25 14:20:43,711 [trainer.py] => device: [device(type='cuda', index=0)]
2023-10-25 14:20:43,711 [trainer.py] => seed: 42
2023-10-25 14:20:43,711 [trainer.py] => beta1: 0.96
2023-10-25 14:20:43,711 [trainer.py] => beta2: 0.97
2023-10-25 14:20:43,711 [trainer.py] => oofc: ft
2023-10-25 14:20:43,711 [trainer.py] => is_teacher_wa: False
2023-10-25 14:20:43,711 [trainer.py] => is_student_wa: False
2023-10-25 14:20:43,711 [trainer.py] => lambda_okd: 1
2023-10-25 14:20:43,711 [trainer.py] => wa_value: 1
2023-10-25 14:20:43,711 [trainer.py] => init_epochs: 20
2023-10-25 14:20:43,711 [trainer.py] => init_lr: 0.001
2023-10-25 14:20:43,711 [trainer.py] => init_weight_decay: 0.0005
2023-10-25 14:20:43,711 [trainer.py] => boosting_epochs: 20
2023-10-25 14:20:43,711 [trainer.py] => compression_epochs: 20
2023-10-25 14:20:43,711 [trainer.py] => lr: 0.001
2023-10-25 14:20:43,711 [trainer.py] => batch_size: 16
2023-10-25 14:20:43,712 [trainer.py] => weight_decay: 0.0005
2023-10-25 14:20:43,712 [trainer.py] => num_workers: 8
2023-10-25 14:20:43,712 [trainer.py] => T: 2
2023-10-25 14:20:43,775 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2023-10-25 14:20:46,924 [trainer.py] => All params: 0
2023-10-25 14:20:46,924 [trainer.py] => Trainable params: 0
2023-10-25 14:20:47,662 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
model.safetensors:   0%|          | 0.00/225M [00:00<?, ?B/s]model.safetensors:   5%|▍         | 10.5M/225M [00:01<00:37, 5.77MB/s]model.safetensors:   9%|▉         | 21.0M/225M [00:02<00:19, 10.3MB/s]model.safetensors:  14%|█▍        | 31.5M/225M [00:02<00:15, 12.8MB/s]model.safetensors:  19%|█▊        | 41.9M/225M [00:03<00:12, 14.3MB/s]model.safetensors:  23%|██▎       | 52.4M/225M [00:03<00:10, 16.5MB/s]model.safetensors:  28%|██▊       | 62.9M/225M [00:04<00:09, 17.0MB/s]model.safetensors:  33%|███▎      | 73.4M/225M [00:05<00:08, 17.1MB/s]model.safetensors:  37%|███▋      | 83.9M/225M [00:05<00:07, 18.7MB/s]model.safetensors:  42%|████▏     | 94.4M/225M [00:06<00:07, 18.4MB/s]model.safetensors:  47%|████▋     | 105M/225M [00:06<00:06, 18.0MB/s] model.safetensors:  51%|█████▏    | 115M/225M [00:07<00:06, 17.9MB/s]model.safetensors:  56%|█████▌    | 126M/225M [00:07<00:05, 19.4MB/s]model.safetensors:  61%|██████    | 136M/225M [00:08<00:04, 18.7MB/s]model.safetensors:  65%|██████▌   | 147M/225M [00:08<00:03, 19.9MB/s]model.safetensors:  70%|██████▉   | 157M/225M [00:09<00:03, 19.3MB/s]model.safetensors:  75%|███████▍  | 168M/225M [00:10<00:03, 18.7MB/s]model.safetensors:  79%|███████▉  | 178M/225M [00:10<00:02, 20.0MB/s]model.safetensors:  84%|████████▍ | 189M/225M [00:11<00:01, 19.1MB/s]model.safetensors:  89%|████████▊ | 199M/225M [00:11<00:01, 20.2MB/s]model.safetensors:  93%|█████████▎| 210M/225M [00:12<00:00, 19.5MB/s]model.safetensors:  98%|█████████▊| 220M/225M [00:12<00:00, 18.8MB/s]model.safetensors: 100%|██████████| 225M/225M [00:12<00:00, 19.3MB/s]model.safetensors: 100%|██████████| 225M/225M [00:12<00:00, 17.4MB/s]
2023-10-25 14:21:02,711 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 14:21:03,222 [foster.py] => Learning on 0-10
2023-10-25 14:21:03,223 [foster.py] => All params: 52577402
2023-10-25 14:21:03,225 [foster.py] => Trainable params: 52577402
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.763, Train_accy 41.50, Test_accy 89.66:   0%|          | 0/20 [00:25<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.763, Train_accy 41.50, Test_accy 89.66:   5%|▌         | 1/20 [00:25<07:58, 25.19s/it]Task 0, Epoch 2/20 => Loss 0.565, Train_accy 84.69:   5%|▌         | 1/20 [00:33<07:58, 25.19s/it]                 Task 0, Epoch 2/20 => Loss 0.565, Train_accy 84.69:  10%|█         | 2/20 [00:33<04:35, 15.28s/it]Task 0, Epoch 3/20 => Loss 0.311, Train_accy 91.84:  10%|█         | 2/20 [00:42<04:35, 15.28s/it]Task 0, Epoch 3/20 => Loss 0.311, Train_accy 91.84:  15%|█▌        | 3/20 [00:42<03:26, 12.17s/it]Task 0, Epoch 4/20 => Loss 0.214, Train_accy 92.52:  15%|█▌        | 3/20 [00:50<03:26, 12.17s/it]Task 0, Epoch 4/20 => Loss 0.214, Train_accy 92.52:  20%|██        | 4/20 [00:50<02:50, 10.66s/it]Task 0, Epoch 5/20 => Loss 0.187, Train_accy 94.56:  20%|██        | 4/20 [00:58<02:50, 10.66s/it]Task 0, Epoch 5/20 => Loss 0.187, Train_accy 94.56:  25%|██▌       | 5/20 [00:58<02:27,  9.84s/it]Task 0, Epoch 6/20 => Loss 0.162, Train_accy 94.22, Test_accy 96.55:  25%|██▌       | 5/20 [01:08<02:27,  9.84s/it]Task 0, Epoch 6/20 => Loss 0.162, Train_accy 94.22, Test_accy 96.55:  30%|███       | 6/20 [01:08<02:15,  9.70s/it]Task 0, Epoch 7/20 => Loss 0.221, Train_accy 93.54:  30%|███       | 6/20 [01:16<02:15,  9.70s/it]                 Task 0, Epoch 7/20 => Loss 0.221, Train_accy 93.54:  35%|███▌      | 7/20 [01:16<02:00,  9.25s/it]Task 0, Epoch 8/20 => Loss 0.126, Train_accy 96.26:  35%|███▌      | 7/20 [01:24<02:00,  9.25s/it]Task 0, Epoch 8/20 => Loss 0.126, Train_accy 96.26:  40%|████      | 8/20 [01:24<01:47,  8.97s/it]Task 0, Epoch 9/20 => Loss 0.119, Train_accy 96.60:  40%|████      | 8/20 [01:33<01:47,  8.97s/it]Task 0, Epoch 9/20 => Loss 0.119, Train_accy 96.60:  45%|████▌     | 9/20 [01:33<01:36,  8.77s/it]Task 0, Epoch 10/20 => Loss 0.135, Train_accy 95.58:  45%|████▌     | 9/20 [01:41<01:36,  8.77s/it]Task 0, Epoch 10/20 => Loss 0.135, Train_accy 95.58:  50%|█████     | 10/20 [01:41<01:26,  8.63s/it]Task 0, Epoch 11/20 => Loss 0.172, Train_accy 95.24, Test_accy 96.55:  50%|█████     | 10/20 [01:50<01:26,  8.63s/it]Task 0, Epoch 11/20 => Loss 0.172, Train_accy 95.24, Test_accy 96.55:  55%|█████▌    | 11/20 [01:50<01:19,  8.87s/it]Task 0, Epoch 12/20 => Loss 0.156, Train_accy 94.56:  55%|█████▌    | 11/20 [01:59<01:19,  8.87s/it]                 Task 0, Epoch 12/20 => Loss 0.156, Train_accy 94.56:  60%|██████    | 12/20 [01:59<01:09,  8.71s/it]Task 0, Epoch 13/20 => Loss 0.156, Train_accy 94.56:  60%|██████    | 12/20 [02:07<01:09,  8.71s/it]Task 0, Epoch 13/20 => Loss 0.156, Train_accy 94.56:  65%|██████▌   | 13/20 [02:07<01:00,  8.60s/it]Task 0, Epoch 14/20 => Loss 0.136, Train_accy 95.24:  65%|██████▌   | 13/20 [02:16<01:00,  8.60s/it]Task 0, Epoch 14/20 => Loss 0.136, Train_accy 95.24:  70%|███████   | 14/20 [02:16<00:51,  8.65s/it]Task 0, Epoch 15/20 => Loss 0.113, Train_accy 95.58:  70%|███████   | 14/20 [02:24<00:51,  8.65s/it]Task 0, Epoch 15/20 => Loss 0.113, Train_accy 95.58:  75%|███████▌  | 15/20 [02:24<00:42,  8.56s/it]Task 0, Epoch 16/20 => Loss 0.148, Train_accy 94.56, Test_accy 96.55:  75%|███████▌  | 15/20 [02:34<00:42,  8.56s/it]Task 0, Epoch 16/20 => Loss 0.148, Train_accy 94.56, Test_accy 96.55:  80%|████████  | 16/20 [02:34<00:35,  8.84s/it]Task 0, Epoch 17/20 => Loss 0.111, Train_accy 96.26:  80%|████████  | 16/20 [02:42<00:35,  8.84s/it]                 Task 0, Epoch 17/20 => Loss 0.111, Train_accy 96.26:  85%|████████▌ | 17/20 [02:42<00:26,  8.71s/it]Task 0, Epoch 18/20 => Loss 0.123, Train_accy 95.92:  85%|████████▌ | 17/20 [02:50<00:26,  8.71s/it]Task 0, Epoch 18/20 => Loss 0.123, Train_accy 95.92:  90%|█████████ | 18/20 [02:50<00:17,  8.60s/it]Task 0, Epoch 19/20 => Loss 0.089, Train_accy 96.60:  90%|█████████ | 18/20 [02:59<00:17,  8.60s/it]Task 0, Epoch 19/20 => Loss 0.089, Train_accy 96.60:  95%|█████████▌| 19/20 [02:59<00:08,  8.53s/it]Task 0, Epoch 20/20 => Loss 0.107, Train_accy 95.92:  95%|█████████▌| 19/20 [03:07<00:08,  8.53s/it]Task 0, Epoch 20/20 => Loss 0.107, Train_accy 95.92: 100%|██████████| 20/20 [03:07<00:00,  8.47s/it]Task 0, Epoch 20/20 => Loss 0.107, Train_accy 95.92: 100%|██████████| 20/20 [03:07<00:00,  9.38s/it]
2023-10-25 14:24:19,283 [foster.py] => Task 0, Epoch 20/20 => Loss 0.107, Train_accy 95.92
2023-10-25 14:24:19,285 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 14:24:35,225 [foster.py] => Exemplar size: 250
2023-10-25 14:24:35,614 [trainer.py] => CNN: {'total': 96.55, '00-09': 96.55, 'old': 0, 'new': 96.55}
2023-10-25 14:24:35,615 [trainer.py] => NME: {'total': 97.7, '00-09': 97.7, 'old': 0, 'new': 97.7}
2023-10-25 14:24:35,615 [trainer.py] => CNN top1 curve: [96.55]
2023-10-25 14:24:35,615 [trainer.py] => CNN top5 curve: [100.0]
2023-10-25 14:24:35,615 [trainer.py] => NME top1 curve: [97.7]
2023-10-25 14:24:35,615 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 96.55
Average Accuracy (NME): 97.7
2023-10-25 14:24:35,615 [trainer.py] => Average Accuracy (CNN): 96.55
2023-10-25 14:24:35,615 [trainer.py] => Average Accuracy (NME): 97.7
2023-10-25 14:24:35,617 [trainer.py] => All params: 52577402
2023-10-25 14:24:35,618 [trainer.py] => Trainable params: 52577402
2023-10-25 14:24:36,160 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 14:24:36,582 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 14:24:37,261 [foster.py] => Learning on 10-20
2023-10-25 14:24:37,266 [foster.py] => All params: 105172094
2023-10-25 14:24:37,269 [foster.py] => Trainable params: 52600462
2023-10-25 14:24:37,351 [foster.py] => per cls weights : [1.21980727 1.21980727 1.21980727 1.21980727 1.21980727 1.21980727
 1.21980727 1.21980727 1.21980727 1.21980727 0.78019273 0.78019273
 0.78019273 0.78019273 0.78019273 0.78019273 0.78019273 0.78019273
 0.78019273 0.78019273]
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.942, Loss_clf 1.094, Loss_fe 1.547, Loss_kd 0.651, Train_accy 69.58, Test_accy 86.36:   0%|          | 0/20 [00:22<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.942, Loss_clf 1.094, Loss_fe 1.547, Loss_kd 0.651, Train_accy 69.58, Test_accy 86.36:   5%|▌         | 1/20 [00:22<06:58, 22.02s/it]Task 1, Epoch 2/20 => Loss 2.328, Loss_clf 0.443, Loss_fe 0.588, Loss_kd 0.649, Train_accy 79.60:   5%|▌         | 1/20 [00:40<06:58, 22.02s/it]                 Task 1, Epoch 2/20 => Loss 2.328, Loss_clf 0.443, Loss_fe 0.588, Loss_kd 0.649, Train_accy 79.60:  10%|█         | 2/20 [00:40<06:00, 20.02s/it]Task 1, Epoch 3/20 => Loss 2.152, Loss_clf 0.400, Loss_fe 0.469, Loss_kd 0.641, Train_accy 80.15:  10%|█         | 2/20 [00:59<06:00, 20.02s/it]Task 1, Epoch 3/20 => Loss 2.152, Loss_clf 0.400, Loss_fe 0.469, Loss_kd 0.641, Train_accy 80.15:  15%|█▌        | 3/20 [00:59<05:29, 19.38s/it]Task 1, Epoch 4/20 => Loss 2.121, Loss_clf 0.383, Loss_fe 0.450, Loss_kd 0.643, Train_accy 82.88:  15%|█▌        | 3/20 [01:17<05:29, 19.38s/it]Task 1, Epoch 4/20 => Loss 2.121, Loss_clf 0.383, Loss_fe 0.450, Loss_kd 0.643, Train_accy 82.88:  20%|██        | 4/20 [01:17<05:05, 19.10s/it]Task 1, Epoch 5/20 => Loss 2.373, Loss_clf 0.388, Loss_fe 0.702, Loss_kd 0.642, Train_accy 81.79:  20%|██        | 4/20 [01:36<05:05, 19.10s/it]Task 1, Epoch 5/20 => Loss 2.373, Loss_clf 0.388, Loss_fe 0.702, Loss_kd 0.642, Train_accy 81.79:  25%|██▌       | 5/20 [01:36<04:43, 18.93s/it]Task 1, Epoch 6/20 => Loss 1.994, Loss_clf 0.315, Loss_fe 0.412, Loss_kd 0.633, Train_accy 83.79, Test_accy 86.93:  25%|██▌       | 5/20 [01:57<04:43, 18.93s/it]Task 1, Epoch 6/20 => Loss 1.994, Loss_clf 0.315, Loss_fe 0.412, Loss_kd 0.633, Train_accy 83.79, Test_accy 86.93:  30%|███       | 6/20 [01:57<04:36, 19.79s/it]Task 1, Epoch 7/20 => Loss 2.002, Loss_clf 0.330, Loss_fe 0.405, Loss_kd 0.633, Train_accy 84.70:  30%|███       | 6/20 [02:16<04:36, 19.79s/it]                 Task 1, Epoch 7/20 => Loss 2.002, Loss_clf 0.330, Loss_fe 0.405, Loss_kd 0.633, Train_accy 84.70:  35%|███▌      | 7/20 [02:16<04:12, 19.41s/it]Task 1, Epoch 8/20 => Loss 1.989, Loss_clf 0.313, Loss_fe 0.406, Loss_kd 0.635, Train_accy 84.34:  35%|███▌      | 7/20 [02:35<04:12, 19.41s/it]Task 1, Epoch 8/20 => Loss 1.989, Loss_clf 0.313, Loss_fe 0.406, Loss_kd 0.635, Train_accy 84.34:  40%|████      | 8/20 [02:35<03:49, 19.16s/it]Task 1, Epoch 9/20 => Loss 1.820, Loss_clf 0.247, Loss_fe 0.308, Loss_kd 0.633, Train_accy 86.89:  40%|████      | 8/20 [02:53<03:49, 19.16s/it]Task 1, Epoch 9/20 => Loss 1.820, Loss_clf 0.247, Loss_fe 0.308, Loss_kd 0.633, Train_accy 86.89:  45%|████▌     | 9/20 [02:53<03:28, 18.99s/it]Task 1, Epoch 10/20 => Loss 1.809, Loss_clf 0.265, Loss_fe 0.274, Loss_kd 0.635, Train_accy 84.52:  45%|████▌     | 9/20 [03:12<03:28, 18.99s/it]Task 1, Epoch 10/20 => Loss 1.809, Loss_clf 0.265, Loss_fe 0.274, Loss_kd 0.635, Train_accy 84.52:  50%|█████     | 10/20 [03:12<03:08, 18.87s/it]Task 1, Epoch 11/20 => Loss 1.804, Loss_clf 0.274, Loss_fe 0.262, Loss_kd 0.634, Train_accy 85.43, Test_accy 87.50:  50%|█████     | 10/20 [03:33<03:08, 18.87s/it]Task 1, Epoch 11/20 => Loss 1.804, Loss_clf 0.274, Loss_fe 0.262, Loss_kd 0.634, Train_accy 85.43, Test_accy 87.50:  55%|█████▌    | 11/20 [03:33<02:56, 19.66s/it]Task 1, Epoch 12/20 => Loss 1.757, Loss_clf 0.247, Loss_fe 0.233, Loss_kd 0.639, Train_accy 87.07:  55%|█████▌    | 11/20 [03:52<02:56, 19.66s/it]                 Task 1, Epoch 12/20 => Loss 1.757, Loss_clf 0.247, Loss_fe 0.233, Loss_kd 0.639, Train_accy 87.07:  60%|██████    | 12/20 [03:52<02:34, 19.34s/it]Task 1, Epoch 13/20 => Loss 1.632, Loss_clf 0.181, Loss_fe 0.191, Loss_kd 0.630, Train_accy 88.16:  60%|██████    | 12/20 [04:11<02:34, 19.34s/it]Task 1, Epoch 13/20 => Loss 1.632, Loss_clf 0.181, Loss_fe 0.191, Loss_kd 0.630, Train_accy 88.16:  65%|██████▌   | 13/20 [04:11<02:13, 19.11s/it]Task 1, Epoch 14/20 => Loss 1.754, Loss_clf 0.243, Loss_fe 0.235, Loss_kd 0.638, Train_accy 86.34:  65%|██████▌   | 13/20 [04:29<02:13, 19.11s/it]Task 1, Epoch 14/20 => Loss 1.754, Loss_clf 0.243, Loss_fe 0.235, Loss_kd 0.638, Train_accy 86.34:  70%|███████   | 14/20 [04:29<01:53, 18.98s/it]Task 1, Epoch 15/20 => Loss 1.598, Loss_clf 0.174, Loss_fe 0.167, Loss_kd 0.629, Train_accy 89.62:  70%|███████   | 14/20 [04:48<01:53, 18.98s/it]Task 1, Epoch 15/20 => Loss 1.598, Loss_clf 0.174, Loss_fe 0.167, Loss_kd 0.629, Train_accy 89.62:  75%|███████▌  | 15/20 [04:48<01:34, 18.89s/it]Task 1, Epoch 16/20 => Loss 1.722, Loss_clf 0.209, Loss_fe 0.218, Loss_kd 0.647, Train_accy 87.25, Test_accy 91.48:  75%|███████▌  | 15/20 [05:09<01:34, 18.89s/it]Task 1, Epoch 16/20 => Loss 1.722, Loss_clf 0.209, Loss_fe 0.218, Loss_kd 0.647, Train_accy 87.25, Test_accy 91.48:  80%|████████  | 16/20 [05:09<01:18, 19.66s/it]Task 1, Epoch 17/20 => Loss 1.584, Loss_clf 0.164, Loss_fe 0.161, Loss_kd 0.629, Train_accy 88.34:  80%|████████  | 16/20 [05:28<01:18, 19.66s/it]                 Task 1, Epoch 17/20 => Loss 1.584, Loss_clf 0.164, Loss_fe 0.161, Loss_kd 0.629, Train_accy 88.34:  85%|████████▌ | 17/20 [05:28<00:58, 19.35s/it]Task 1, Epoch 18/20 => Loss 1.567, Loss_clf 0.150, Loss_fe 0.152, Loss_kd 0.633, Train_accy 89.07:  85%|████████▌ | 17/20 [05:47<00:58, 19.35s/it]Task 1, Epoch 18/20 => Loss 1.567, Loss_clf 0.150, Loss_fe 0.152, Loss_kd 0.633, Train_accy 89.07:  90%|█████████ | 18/20 [05:47<00:38, 19.13s/it]Task 1, Epoch 19/20 => Loss 1.668, Loss_clf 0.212, Loss_fe 0.198, Loss_kd 0.629, Train_accy 87.07:  90%|█████████ | 18/20 [06:05<00:38, 19.13s/it]Task 1, Epoch 19/20 => Loss 1.668, Loss_clf 0.212, Loss_fe 0.198, Loss_kd 0.629, Train_accy 87.07:  95%|█████████▌| 19/20 [06:05<00:18, 19.00s/it]Task 1, Epoch 20/20 => Loss 1.637, Loss_clf 0.195, Loss_fe 0.175, Loss_kd 0.634, Train_accy 88.71:  95%|█████████▌| 19/20 [06:24<00:18, 19.00s/it]Task 1, Epoch 20/20 => Loss 1.637, Loss_clf 0.195, Loss_fe 0.175, Loss_kd 0.634, Train_accy 88.71: 100%|██████████| 20/20 [06:24<00:00, 18.88s/it]Task 1, Epoch 20/20 => Loss 1.637, Loss_clf 0.195, Loss_fe 0.175, Loss_kd 0.634, Train_accy 88.71: 100%|██████████| 20/20 [06:24<00:00, 19.22s/it]
2023-10-25 14:31:01,813 [foster.py] => Task 1, Epoch 20/20 => Loss 1.637, Loss_clf 0.195, Loss_fe 0.175, Loss_kd 0.634, Train_accy 88.71
2023-10-25 14:31:01,815 [foster.py] => do not weight align teacher!
2023-10-25 14:31:01,816 [foster.py] => per cls weights : [1.30460992 1.30460992 1.30460992 1.30460992 1.30460992 1.30460992
 1.30460992 1.30460992 1.30460992 1.30460992 0.69539008 0.69539008
 0.69539008 0.69539008 0.69539008 0.69539008 0.69539008 0.69539008
 0.69539008 0.69539008]
2023-10-25 14:31:02,368 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 14:31:02,761 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 1, Epoch 1/20 => Loss 1.825,  Train_accy 50.46, Test_accy 81.25:   0%|          | 0/20 [00:24<?, ?it/s]SNet: Task 1, Epoch 1/20 => Loss 1.825,  Train_accy 50.46, Test_accy 81.25:   5%|▌         | 1/20 [00:24<07:45, 24.52s/it]SNet: Task 1, Epoch 2/20 => Loss 1.500,  Train_accy 77.23:   5%|▌         | 1/20 [00:46<07:45, 24.52s/it]                 SNet: Task 1, Epoch 2/20 => Loss 1.500,  Train_accy 77.23:  10%|█         | 2/20 [00:46<06:54, 23.02s/it]SNet: Task 1, Epoch 3/20 => Loss 1.399,  Train_accy 83.06:  10%|█         | 2/20 [01:08<06:54, 23.02s/it]SNet: Task 1, Epoch 3/20 => Loss 1.399,  Train_accy 83.06:  15%|█▌        | 3/20 [01:08<06:22, 22.51s/it]SNet: Task 1, Epoch 4/20 => Loss 1.409,  Train_accy 80.87:  15%|█▌        | 3/20 [01:30<06:22, 22.51s/it]SNet: Task 1, Epoch 4/20 => Loss 1.409,  Train_accy 80.87:  20%|██        | 4/20 [01:30<05:56, 22.30s/it]SNet: Task 1, Epoch 5/20 => Loss 1.390,  Train_accy 82.33:  20%|██        | 4/20 [01:52<05:56, 22.30s/it]SNet: Task 1, Epoch 5/20 => Loss 1.390,  Train_accy 82.33:  25%|██▌       | 5/20 [01:52<05:35, 22.39s/it]SNet: Task 1, Epoch 6/20 => Loss 1.386,  Train_accy 81.97, Test_accy 86.93:  25%|██▌       | 5/20 [02:16<05:35, 22.39s/it]SNet: Task 1, Epoch 6/20 => Loss 1.386,  Train_accy 81.97, Test_accy 86.93:  30%|███       | 6/20 [02:16<05:19, 22.82s/it]SNet: Task 1, Epoch 7/20 => Loss 1.406,  Train_accy 80.69:  30%|███       | 6/20 [02:38<05:19, 22.82s/it]                 SNet: Task 1, Epoch 7/20 => Loss 1.406,  Train_accy 80.69:  35%|███▌      | 7/20 [02:38<04:52, 22.53s/it]SNet: Task 1, Epoch 8/20 => Loss 1.365,  Train_accy 82.15:  35%|███▌      | 7/20 [03:00<04:52, 22.53s/it]SNet: Task 1, Epoch 8/20 => Loss 1.365,  Train_accy 82.15:  40%|████      | 8/20 [03:00<04:28, 22.36s/it]SNet: Task 1, Epoch 9/20 => Loss 1.373,  Train_accy 81.06:  40%|████      | 8/20 [03:22<04:28, 22.36s/it]SNet: Task 1, Epoch 9/20 => Loss 1.373,  Train_accy 81.06:  45%|████▌     | 9/20 [03:22<04:05, 22.35s/it]SNet: Task 1, Epoch 10/20 => Loss 1.338,  Train_accy 82.88:  45%|████▌     | 9/20 [03:47<04:05, 22.35s/it]SNet: Task 1, Epoch 10/20 => Loss 1.338,  Train_accy 82.88:  50%|█████     | 10/20 [03:47<03:50, 23.03s/it]SNet: Task 1, Epoch 11/20 => Loss 1.337,  Train_accy 82.51, Test_accy 86.93:  50%|█████     | 10/20 [04:11<03:50, 23.03s/it]SNet: Task 1, Epoch 11/20 => Loss 1.337,  Train_accy 82.51, Test_accy 86.93:  55%|█████▌    | 11/20 [04:11<03:29, 23.33s/it]SNet: Task 1, Epoch 12/20 => Loss 1.362,  Train_accy 81.42:  55%|█████▌    | 11/20 [04:33<03:29, 23.33s/it]                 SNet: Task 1, Epoch 12/20 => Loss 1.362,  Train_accy 81.42:  60%|██████    | 12/20 [04:33<03:03, 22.91s/it]SNet: Task 1, Epoch 13/20 => Loss 1.348,  Train_accy 81.60:  60%|██████    | 12/20 [04:55<03:03, 22.91s/it]SNet: Task 1, Epoch 13/20 => Loss 1.348,  Train_accy 81.60:  65%|██████▌   | 13/20 [04:55<02:38, 22.62s/it]SNet: Task 1, Epoch 14/20 => Loss 1.370,  Train_accy 79.60:  65%|██████▌   | 13/20 [05:17<02:38, 22.62s/it]SNet: Task 1, Epoch 14/20 => Loss 1.370,  Train_accy 79.60:  70%|███████   | 14/20 [05:17<02:14, 22.41s/it]SNet: Task 1, Epoch 15/20 => Loss 1.357,  Train_accy 83.61:  70%|███████   | 14/20 [05:39<02:14, 22.41s/it]SNet: Task 1, Epoch 15/20 => Loss 1.357,  Train_accy 83.61:  75%|███████▌  | 15/20 [05:39<01:51, 22.28s/it]SNet: Task 1, Epoch 16/20 => Loss 1.393,  Train_accy 80.33, Test_accy 86.93:  75%|███████▌  | 15/20 [06:02<01:51, 22.28s/it]SNet: Task 1, Epoch 16/20 => Loss 1.393,  Train_accy 80.33, Test_accy 86.93:  80%|████████  | 16/20 [06:02<01:30, 22.70s/it]SNet: Task 1, Epoch 17/20 => Loss 1.403,  Train_accy 81.24:  80%|████████  | 16/20 [06:24<01:30, 22.70s/it]                 SNet: Task 1, Epoch 17/20 => Loss 1.403,  Train_accy 81.24:  85%|████████▌ | 17/20 [06:24<01:07, 22.46s/it]SNet: Task 1, Epoch 18/20 => Loss 1.361,  Train_accy 82.88:  85%|████████▌ | 17/20 [06:46<01:07, 22.46s/it]SNet: Task 1, Epoch 18/20 => Loss 1.361,  Train_accy 82.88:  90%|█████████ | 18/20 [06:46<00:44, 22.31s/it]SNet: Task 1, Epoch 19/20 => Loss 1.362,  Train_accy 81.24:  90%|█████████ | 18/20 [07:08<00:44, 22.31s/it]SNet: Task 1, Epoch 19/20 => Loss 1.362,  Train_accy 81.24:  95%|█████████▌| 19/20 [07:08<00:22, 22.20s/it]SNet: Task 1, Epoch 20/20 => Loss 1.339,  Train_accy 82.70:  95%|█████████▌| 19/20 [07:30<00:22, 22.20s/it]SNet: Task 1, Epoch 20/20 => Loss 1.339,  Train_accy 82.70: 100%|██████████| 20/20 [07:30<00:00, 22.13s/it]SNet: Task 1, Epoch 20/20 => Loss 1.339,  Train_accy 82.70: 100%|██████████| 20/20 [07:30<00:00, 22.53s/it]
2023-10-25 14:38:34,272 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 1.339,  Train_accy 82.70
2023-10-25 14:38:34,273 [foster.py] => do not weight align student!
2023-10-25 14:38:36,039 [foster.py] => darknet eval: 
2023-10-25 14:38:36,039 [foster.py] => CNN top1 curve: 86.93
2023-10-25 14:38:36,039 [foster.py] => CNN top5 curve: 100.0
2023-10-25 14:38:36,041 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 14:39:07,675 [foster.py] => Exemplar size: 500
2023-10-25 14:39:08,252 [trainer.py] => CNN: {'total': 90.34, '00-09': 96.55, '10-19': 84.27, 'old': 96.55, 'new': 84.27}
2023-10-25 14:39:08,252 [trainer.py] => NME: {'total': 93.18, '00-09': 93.1, '10-19': 93.26, 'old': 93.1, 'new': 93.26}
2023-10-25 14:39:08,252 [trainer.py] => CNN top1 curve: [96.55, 90.34]
2023-10-25 14:39:08,252 [trainer.py] => CNN top5 curve: [100.0, 100.0]
2023-10-25 14:39:08,252 [trainer.py] => NME top1 curve: [97.7, 93.18]
2023-10-25 14:39:08,252 [trainer.py] => NME top5 curve: [100.0, 100.0]

Average Accuracy (CNN): 93.445
Average Accuracy (NME): 95.44
2023-10-25 14:39:08,252 [trainer.py] => Average Accuracy (CNN): 93.445
2023-10-25 14:39:08,253 [trainer.py] => Average Accuracy (NME): 95.44
2023-10-25 14:39:08,256 [trainer.py] => All params: 105172094
2023-10-25 14:39:08,259 [trainer.py] => Trainable params: 52600462
2023-10-25 14:39:08,911 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 14:39:09,292 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 14:39:10,012 [foster.py] => Learning on 20-30
2023-10-25 14:39:10,017 [foster.py] => All params: 105195164
2023-10-25 14:39:10,020 [foster.py] => Trainable params: 52617762
2023-10-25 14:39:10,053 [foster.py] => per cls weights : [1.13653443 1.13653443 1.13653443 1.13653443 1.13653443 1.13653443
 1.13653443 1.13653443 1.13653443 1.13653443 1.13653443 1.13653443
 1.13653443 1.13653443 1.13653443 1.13653443 1.13653443 1.13653443
 1.13653443 1.13653443 0.72693115 0.72693115 0.72693115 0.72693115
 0.72693115 0.72693115 0.72693115 0.72693115 0.72693115 0.72693115]
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 4.363, Loss_clf 0.833, Loss_fe 1.791, Loss_kd 1.159, Train_accy 73.64, Test_accy 85.61:   0%|          | 0/20 [00:30<?, ?it/s]Task 2, Epoch 1/20 => Loss 4.363, Loss_clf 0.833, Loss_fe 1.791, Loss_kd 1.159, Train_accy 73.64, Test_accy 85.61:   5%|▌         | 1/20 [00:30<09:43, 30.73s/it]Task 2, Epoch 2/20 => Loss 2.816, Loss_clf 0.439, Loss_fe 0.638, Loss_kd 1.160, Train_accy 81.34:   5%|▌         | 1/20 [00:57<09:43, 30.73s/it]                 Task 2, Epoch 2/20 => Loss 2.816, Loss_clf 0.439, Loss_fe 0.638, Loss_kd 1.160, Train_accy 81.34:  10%|█         | 2/20 [00:57<08:30, 28.35s/it]Task 2, Epoch 3/20 => Loss 2.714, Loss_clf 0.451, Loss_fe 0.525, Loss_kd 1.158, Train_accy 82.85:  10%|█         | 2/20 [01:24<08:30, 28.35s/it]Task 2, Epoch 3/20 => Loss 2.714, Loss_clf 0.451, Loss_fe 0.525, Loss_kd 1.158, Train_accy 82.85:  15%|█▌        | 3/20 [01:24<07:54, 27.89s/it]Task 2, Epoch 4/20 => Loss 2.631, Loss_clf 0.391, Loss_fe 0.504, Loss_kd 1.158, Train_accy 84.87:  15%|█▌        | 3/20 [01:51<07:54, 27.89s/it]Task 2, Epoch 4/20 => Loss 2.631, Loss_clf 0.391, Loss_fe 0.504, Loss_kd 1.158, Train_accy 84.87:  20%|██        | 4/20 [01:51<07:18, 27.40s/it]Task 2, Epoch 5/20 => Loss 2.527, Loss_clf 0.362, Loss_fe 0.421, Loss_kd 1.163, Train_accy 84.99:  20%|██        | 4/20 [02:18<07:18, 27.40s/it]Task 2, Epoch 5/20 => Loss 2.527, Loss_clf 0.362, Loss_fe 0.421, Loss_kd 1.163, Train_accy 84.99:  25%|██▌       | 5/20 [02:18<06:46, 27.13s/it]Task 2, Epoch 6/20 => Loss 2.584, Loss_clf 0.382, Loss_fe 0.457, Loss_kd 1.163, Train_accy 85.25, Test_accy 90.53:  25%|██▌       | 5/20 [02:48<06:46, 27.13s/it]Task 2, Epoch 6/20 => Loss 2.584, Loss_clf 0.382, Loss_fe 0.457, Loss_kd 1.163, Train_accy 85.25, Test_accy 90.53:  30%|███       | 6/20 [02:48<06:36, 28.34s/it]Task 2, Epoch 7/20 => Loss 2.601, Loss_clf 0.391, Loss_fe 0.461, Loss_kd 1.165, Train_accy 86.51:  30%|███       | 6/20 [03:15<06:36, 28.34s/it]                 Task 2, Epoch 7/20 => Loss 2.601, Loss_clf 0.391, Loss_fe 0.461, Loss_kd 1.165, Train_accy 86.51:  35%|███▌      | 7/20 [03:15<06:01, 27.78s/it]Task 2, Epoch 8/20 => Loss 2.507, Loss_clf 0.373, Loss_fe 0.395, Loss_kd 1.160, Train_accy 85.62:  35%|███▌      | 7/20 [03:42<06:01, 27.78s/it]Task 2, Epoch 8/20 => Loss 2.507, Loss_clf 0.373, Loss_fe 0.395, Loss_kd 1.160, Train_accy 85.62:  40%|████      | 8/20 [03:42<05:29, 27.43s/it]Task 2, Epoch 9/20 => Loss 2.445, Loss_clf 0.342, Loss_fe 0.349, Loss_kd 1.169, Train_accy 88.40:  40%|████      | 8/20 [04:08<05:29, 27.43s/it]Task 2, Epoch 9/20 => Loss 2.445, Loss_clf 0.342, Loss_fe 0.349, Loss_kd 1.169, Train_accy 88.40:  45%|████▌     | 9/20 [04:08<04:59, 27.19s/it]Task 2, Epoch 10/20 => Loss 2.426, Loss_clf 0.327, Loss_fe 0.337, Loss_kd 1.174, Train_accy 88.40:  45%|████▌     | 9/20 [04:35<04:59, 27.19s/it]Task 2, Epoch 10/20 => Loss 2.426, Loss_clf 0.327, Loss_fe 0.337, Loss_kd 1.174, Train_accy 88.40:  50%|█████     | 10/20 [04:35<04:30, 27.02s/it]Task 2, Epoch 11/20 => Loss 2.442, Loss_clf 0.346, Loss_fe 0.351, Loss_kd 1.163, Train_accy 87.77, Test_accy 92.42:  50%|█████     | 10/20 [05:06<04:30, 27.02s/it]Task 2, Epoch 11/20 => Loss 2.442, Loss_clf 0.346, Loss_fe 0.351, Loss_kd 1.163, Train_accy 87.77, Test_accy 92.42:  55%|█████▌    | 11/20 [05:06<04:14, 28.31s/it]Task 2, Epoch 12/20 => Loss 2.199, Loss_clf 0.237, Loss_fe 0.244, Loss_kd 1.145, Train_accy 91.30:  55%|█████▌    | 11/20 [05:33<04:14, 28.31s/it]                 Task 2, Epoch 12/20 => Loss 2.199, Loss_clf 0.237, Loss_fe 0.244, Loss_kd 1.145, Train_accy 91.30:  60%|██████    | 12/20 [05:33<03:42, 27.80s/it]Task 2, Epoch 13/20 => Loss 2.184, Loss_clf 0.242, Loss_fe 0.225, Loss_kd 1.145, Train_accy 90.67:  60%|██████    | 12/20 [05:59<03:42, 27.80s/it]Task 2, Epoch 13/20 => Loss 2.184, Loss_clf 0.242, Loss_fe 0.225, Loss_kd 1.145, Train_accy 90.67:  65%|██████▌   | 13/20 [05:59<03:12, 27.46s/it]Task 2, Epoch 14/20 => Loss 2.243, Loss_clf 0.270, Loss_fe 0.216, Loss_kd 1.171, Train_accy 90.67:  65%|██████▌   | 13/20 [06:26<03:12, 27.46s/it]Task 2, Epoch 14/20 => Loss 2.243, Loss_clf 0.270, Loss_fe 0.216, Loss_kd 1.171, Train_accy 90.67:  70%|███████   | 14/20 [06:26<02:43, 27.23s/it]Task 2, Epoch 15/20 => Loss 2.246, Loss_clf 0.274, Loss_fe 0.228, Loss_kd 1.163, Train_accy 90.42:  70%|███████   | 14/20 [06:53<02:43, 27.23s/it]Task 2, Epoch 15/20 => Loss 2.246, Loss_clf 0.274, Loss_fe 0.228, Loss_kd 1.163, Train_accy 90.42:  75%|███████▌  | 15/20 [06:53<02:15, 27.06s/it]Task 2, Epoch 16/20 => Loss 2.185, Loss_clf 0.270, Loss_fe 0.193, Loss_kd 1.148, Train_accy 90.16, Test_accy 93.18:  75%|███████▌  | 15/20 [07:23<02:15, 27.06s/it]Task 2, Epoch 16/20 => Loss 2.185, Loss_clf 0.270, Loss_fe 0.193, Loss_kd 1.148, Train_accy 90.16, Test_accy 93.18:  80%|████████  | 16/20 [07:23<01:52, 28.15s/it]Task 2, Epoch 17/20 => Loss 2.120, Loss_clf 0.224, Loss_fe 0.173, Loss_kd 1.149, Train_accy 91.55:  80%|████████  | 16/20 [07:50<01:52, 28.15s/it]                 Task 2, Epoch 17/20 => Loss 2.120, Loss_clf 0.224, Loss_fe 0.173, Loss_kd 1.149, Train_accy 91.55:  85%|████████▌ | 17/20 [07:50<01:23, 27.69s/it]Task 2, Epoch 18/20 => Loss 2.183, Loss_clf 0.261, Loss_fe 0.209, Loss_kd 1.142, Train_accy 90.42:  85%|████████▌ | 17/20 [08:17<01:23, 27.69s/it]Task 2, Epoch 18/20 => Loss 2.183, Loss_clf 0.261, Loss_fe 0.209, Loss_kd 1.142, Train_accy 90.42:  90%|█████████ | 18/20 [08:17<00:54, 27.46s/it]Task 2, Epoch 19/20 => Loss 2.169, Loss_clf 0.254, Loss_fe 0.185, Loss_kd 1.153, Train_accy 89.91:  90%|█████████ | 18/20 [08:44<00:54, 27.46s/it]Task 2, Epoch 19/20 => Loss 2.169, Loss_clf 0.254, Loss_fe 0.185, Loss_kd 1.153, Train_accy 89.91:  95%|█████████▌| 19/20 [08:44<00:27, 27.22s/it]Task 2, Epoch 20/20 => Loss 2.165, Loss_clf 0.250, Loss_fe 0.181, Loss_kd 1.156, Train_accy 90.92:  95%|█████████▌| 19/20 [09:10<00:27, 27.22s/it]Task 2, Epoch 20/20 => Loss 2.165, Loss_clf 0.250, Loss_fe 0.181, Loss_kd 1.156, Train_accy 90.92: 100%|██████████| 20/20 [09:10<00:00, 27.05s/it]Task 2, Epoch 20/20 => Loss 2.165, Loss_clf 0.250, Loss_fe 0.181, Loss_kd 1.156, Train_accy 90.92: 100%|██████████| 20/20 [09:10<00:00, 27.54s/it]
2023-10-25 14:48:20,847 [foster.py] => Task 2, Epoch 20/20 => Loss 2.165, Loss_clf 0.250, Loss_fe 0.181, Loss_kd 1.156, Train_accy 90.92
2023-10-25 14:48:20,849 [foster.py] => do not weight align teacher!
2023-10-25 14:48:20,850 [foster.py] => per cls weights : [1.18435454 1.18435454 1.18435454 1.18435454 1.18435454 1.18435454
 1.18435454 1.18435454 1.18435454 1.18435454 1.18435454 1.18435454
 1.18435454 1.18435454 1.18435454 1.18435454 1.18435454 1.18435454
 1.18435454 1.18435454 0.63129093 0.63129093 0.63129093 0.63129093
 0.63129093 0.63129093 0.63129093 0.63129093 0.63129093 0.63129093]
2023-10-25 14:48:21,478 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 14:48:22,303 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 2, Epoch 1/20 => Loss 2.005,  Train_accy 55.86, Test_accy 76.52:   0%|          | 0/20 [00:33<?, ?it/s]SNet: Task 2, Epoch 1/20 => Loss 2.005,  Train_accy 55.86, Test_accy 76.52:   5%|▌         | 1/20 [00:33<10:43, 33.88s/it]SNet: Task 2, Epoch 2/20 => Loss 1.814,  Train_accy 74.65:   5%|▌         | 1/20 [01:05<10:43, 33.88s/it]                 SNet: Task 2, Epoch 2/20 => Loss 1.814,  Train_accy 74.65:  10%|█         | 2/20 [01:05<09:44, 32.50s/it]SNet: Task 2, Epoch 3/20 => Loss 1.723,  Train_accy 81.21:  10%|█         | 2/20 [01:36<09:44, 32.50s/it]SNet: Task 2, Epoch 3/20 => Loss 1.723,  Train_accy 81.21:  15%|█▌        | 3/20 [01:36<09:04, 32.06s/it]SNet: Task 2, Epoch 4/20 => Loss 1.709,  Train_accy 82.35:  15%|█▌        | 3/20 [02:08<09:04, 32.06s/it]SNet: Task 2, Epoch 4/20 => Loss 1.709,  Train_accy 82.35:  20%|██        | 4/20 [02:08<08:29, 31.82s/it]SNet: Task 2, Epoch 5/20 => Loss 1.707,  Train_accy 83.10:  20%|██        | 4/20 [02:39<08:29, 31.82s/it]SNet: Task 2, Epoch 5/20 => Loss 1.707,  Train_accy 83.10:  25%|██▌       | 5/20 [02:39<07:55, 31.73s/it]SNet: Task 2, Epoch 6/20 => Loss 1.706,  Train_accy 83.98, Test_accy 90.53:  25%|██▌       | 5/20 [03:14<07:55, 31.73s/it]SNet: Task 2, Epoch 6/20 => Loss 1.706,  Train_accy 83.98, Test_accy 90.53:  30%|███       | 6/20 [03:14<07:36, 32.61s/it]SNet: Task 2, Epoch 7/20 => Loss 1.712,  Train_accy 83.86:  30%|███       | 6/20 [03:45<07:36, 32.61s/it]                 SNet: Task 2, Epoch 7/20 => Loss 1.712,  Train_accy 83.86:  35%|███▌      | 7/20 [03:45<06:58, 32.22s/it]SNet: Task 2, Epoch 8/20 => Loss 1.674,  Train_accy 84.36:  35%|███▌      | 7/20 [04:17<06:58, 32.22s/it]SNet: Task 2, Epoch 8/20 => Loss 1.674,  Train_accy 84.36:  40%|████      | 8/20 [04:17<06:23, 31.99s/it]SNet: Task 2, Epoch 9/20 => Loss 1.698,  Train_accy 85.50:  40%|████      | 8/20 [04:48<06:23, 31.99s/it]SNet: Task 2, Epoch 9/20 => Loss 1.698,  Train_accy 85.50:  45%|████▌     | 9/20 [04:48<05:49, 31.81s/it]SNet: Task 2, Epoch 10/20 => Loss 1.709,  Train_accy 84.87:  45%|████▌     | 9/20 [05:20<05:49, 31.81s/it]SNet: Task 2, Epoch 10/20 => Loss 1.709,  Train_accy 84.87:  50%|█████     | 10/20 [05:20<05:17, 31.71s/it]SNet: Task 2, Epoch 11/20 => Loss 1.710,  Train_accy 83.98, Test_accy 92.42:  50%|█████     | 10/20 [05:53<05:17, 31.71s/it]SNet: Task 2, Epoch 11/20 => Loss 1.710,  Train_accy 83.98, Test_accy 92.42:  55%|█████▌    | 11/20 [05:53<04:51, 32.37s/it]SNet: Task 2, Epoch 12/20 => Loss 1.690,  Train_accy 84.87:  55%|█████▌    | 11/20 [06:25<04:51, 32.37s/it]                 SNet: Task 2, Epoch 12/20 => Loss 1.690,  Train_accy 84.87:  60%|██████    | 12/20 [06:25<04:16, 32.09s/it]SNet: Task 2, Epoch 13/20 => Loss 1.701,  Train_accy 85.75:  60%|██████    | 12/20 [06:56<04:16, 32.09s/it]SNet: Task 2, Epoch 13/20 => Loss 1.701,  Train_accy 85.75:  65%|██████▌   | 13/20 [06:56<03:43, 31.92s/it]SNet: Task 2, Epoch 14/20 => Loss 1.683,  Train_accy 85.88:  65%|██████▌   | 13/20 [07:28<03:43, 31.92s/it]SNet: Task 2, Epoch 14/20 => Loss 1.683,  Train_accy 85.88:  70%|███████   | 14/20 [07:28<03:10, 31.78s/it]SNet: Task 2, Epoch 15/20 => Loss 1.693,  Train_accy 84.62:  70%|███████   | 14/20 [07:59<03:10, 31.78s/it]SNet: Task 2, Epoch 15/20 => Loss 1.693,  Train_accy 84.62:  75%|███████▌  | 15/20 [07:59<02:38, 31.67s/it]SNet: Task 2, Epoch 16/20 => Loss 1.702,  Train_accy 84.49, Test_accy 91.29:  75%|███████▌  | 15/20 [08:33<02:38, 31.67s/it]SNet: Task 2, Epoch 16/20 => Loss 1.702,  Train_accy 84.49, Test_accy 91.29:  80%|████████  | 16/20 [08:33<02:09, 32.32s/it]SNet: Task 2, Epoch 17/20 => Loss 1.676,  Train_accy 86.38:  80%|████████  | 16/20 [09:05<02:09, 32.32s/it]                 SNet: Task 2, Epoch 17/20 => Loss 1.676,  Train_accy 86.38:  85%|████████▌ | 17/20 [09:05<01:36, 32.08s/it]SNet: Task 2, Epoch 18/20 => Loss 1.700,  Train_accy 85.12:  85%|████████▌ | 17/20 [09:36<01:36, 32.08s/it]SNet: Task 2, Epoch 18/20 => Loss 1.700,  Train_accy 85.12:  90%|█████████ | 18/20 [09:36<01:03, 31.89s/it]SNet: Task 2, Epoch 19/20 => Loss 1.690,  Train_accy 85.37:  90%|█████████ | 18/20 [10:08<01:03, 31.89s/it]SNet: Task 2, Epoch 19/20 => Loss 1.690,  Train_accy 85.37:  95%|█████████▌| 19/20 [10:08<00:31, 31.96s/it]SNet: Task 2, Epoch 20/20 => Loss 1.706,  Train_accy 84.99:  95%|█████████▌| 19/20 [10:40<00:31, 31.96s/it]SNet: Task 2, Epoch 20/20 => Loss 1.706,  Train_accy 84.99: 100%|██████████| 20/20 [10:40<00:00, 31.80s/it]SNet: Task 2, Epoch 20/20 => Loss 1.706,  Train_accy 84.99: 100%|██████████| 20/20 [10:40<00:00, 32.01s/it]
2023-10-25 14:59:02,581 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.706,  Train_accy 84.99
2023-10-25 14:59:02,581 [foster.py] => do not weight align student!
2023-10-25 14:59:04,985 [foster.py] => darknet eval: 
2023-10-25 14:59:04,985 [foster.py] => CNN top1 curve: 91.29
2023-10-25 14:59:04,986 [foster.py] => CNN top5 curve: 100.0
2023-10-25 14:59:04,988 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 14:59:50,205 [foster.py] => Exemplar size: 750
2023-10-25 14:59:50,770 [trainer.py] => CNN: {'total': 93.56, '00-09': 94.25, '10-19': 88.76, '20-29': 97.73, 'old': 91.48, 'new': 97.73}
2023-10-25 14:59:50,771 [trainer.py] => NME: {'total': 96.21, '00-09': 94.25, '10-19': 95.51, '20-29': 98.86, 'old': 94.89, 'new': 98.86}
2023-10-25 14:59:50,771 [trainer.py] => CNN top1 curve: [96.55, 90.34, 93.56]
2023-10-25 14:59:50,771 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0]
2023-10-25 14:59:50,771 [trainer.py] => NME top1 curve: [97.7, 93.18, 96.21]
2023-10-25 14:59:50,771 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0]

Average Accuracy (CNN): 93.48333333333333
Average Accuracy (NME): 95.69666666666666
2023-10-25 14:59:50,771 [trainer.py] => Average Accuracy (CNN): 93.48333333333333
2023-10-25 14:59:50,771 [trainer.py] => Average Accuracy (NME): 95.69666666666666
2023-10-25 14:59:50,775 [trainer.py] => All params: 105195164
2023-10-25 14:59:50,777 [trainer.py] => Trainable params: 52617762
2023-10-25 14:59:51,328 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 14:59:51,680 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 14:59:51,768 [foster.py] => Learning on 30-40
2023-10-25 14:59:51,773 [foster.py] => All params: 105218234
2023-10-25 14:59:51,776 [foster.py] => Trainable params: 52635062
2023-10-25 14:59:51,808 [foster.py] => per cls weights : [1.09902088 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088
 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088
 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088
 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088
 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088 1.09902088
 0.70293736 0.70293736 0.70293736 0.70293736 0.70293736 0.70293736
 0.70293736 0.70293736 0.70293736 0.70293736]
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 6.570, Loss_clf 0.885, Loss_fe 3.662, Loss_kd 1.517, Train_accy 72.07, Test_accy 88.92:   0%|          | 0/20 [00:39<?, ?it/s]Task 3, Epoch 1/20 => Loss 6.570, Loss_clf 0.885, Loss_fe 3.662, Loss_kd 1.517, Train_accy 72.07, Test_accy 88.92:   5%|▌         | 1/20 [00:39<12:39, 39.96s/it]Task 3, Epoch 2/20 => Loss 6.299, Loss_clf 0.483, Loss_fe 3.797, Loss_kd 1.514, Train_accy 82.15:   5%|▌         | 1/20 [01:14<12:39, 39.96s/it]                 Task 3, Epoch 2/20 => Loss 6.299, Loss_clf 0.483, Loss_fe 3.797, Loss_kd 1.514, Train_accy 82.15:  10%|█         | 2/20 [01:14<11:05, 36.95s/it]Task 3, Epoch 3/20 => Loss 6.287, Loss_clf 0.504, Loss_fe 3.780, Loss_kd 1.503, Train_accy 81.96:  10%|█         | 2/20 [01:49<11:05, 36.95s/it]Task 3, Epoch 3/20 => Loss 6.287, Loss_clf 0.504, Loss_fe 3.780, Loss_kd 1.503, Train_accy 81.96:  15%|█▌        | 3/20 [01:49<10:11, 35.99s/it]Task 3, Epoch 4/20 => Loss 6.158, Loss_clf 0.393, Loss_fe 3.761, Loss_kd 1.503, Train_accy 83.97:  15%|█▌        | 3/20 [02:24<10:11, 35.99s/it]Task 3, Epoch 4/20 => Loss 6.158, Loss_clf 0.393, Loss_fe 3.761, Loss_kd 1.503, Train_accy 83.97:  20%|██        | 4/20 [02:24<09:28, 35.56s/it]Task 3, Epoch 5/20 => Loss 6.159, Loss_clf 0.389, Loss_fe 3.779, Loss_kd 1.494, Train_accy 84.64:  20%|██        | 4/20 [02:59<09:28, 35.56s/it]Task 3, Epoch 5/20 => Loss 6.159, Loss_clf 0.389, Loss_fe 3.779, Loss_kd 1.494, Train_accy 84.64:  25%|██▌       | 5/20 [02:59<08:49, 35.30s/it]Task 3, Epoch 6/20 => Loss 6.182, Loss_clf 0.381, Loss_fe 3.769, Loss_kd 1.524, Train_accy 85.03, Test_accy 88.64:  25%|██▌       | 5/20 [03:39<08:49, 35.30s/it]Task 3, Epoch 6/20 => Loss 6.182, Loss_clf 0.381, Loss_fe 3.769, Loss_kd 1.524, Train_accy 85.03, Test_accy 88.64:  30%|███       | 6/20 [03:39<08:37, 36.94s/it]Task 3, Epoch 7/20 => Loss 6.125, Loss_clf 0.346, Loss_fe 3.763, Loss_kd 1.512, Train_accy 86.37:  30%|███       | 6/20 [04:14<08:37, 36.94s/it]                 Task 3, Epoch 7/20 => Loss 6.125, Loss_clf 0.346, Loss_fe 3.763, Loss_kd 1.512, Train_accy 86.37:  35%|███▌      | 7/20 [04:14<07:51, 36.25s/it]Task 3, Epoch 8/20 => Loss 6.207, Loss_clf 0.422, Loss_fe 3.765, Loss_kd 1.515, Train_accy 84.84:  35%|███▌      | 7/20 [04:49<07:51, 36.25s/it]Task 3, Epoch 8/20 => Loss 6.207, Loss_clf 0.422, Loss_fe 3.765, Loss_kd 1.515, Train_accy 84.84:  40%|████      | 8/20 [04:49<07:09, 35.80s/it]Task 3, Epoch 9/20 => Loss 6.141, Loss_clf 0.394, Loss_fe 3.741, Loss_kd 1.504, Train_accy 85.60:  40%|████      | 8/20 [05:24<07:09, 35.80s/it]Task 3, Epoch 9/20 => Loss 6.141, Loss_clf 0.394, Loss_fe 3.741, Loss_kd 1.504, Train_accy 85.60:  45%|████▌     | 9/20 [05:24<06:31, 35.58s/it]Task 3, Epoch 10/20 => Loss 6.149, Loss_clf 0.394, Loss_fe 3.734, Loss_kd 1.515, Train_accy 85.32:  45%|████▌     | 9/20 [05:59<06:31, 35.58s/it]Task 3, Epoch 10/20 => Loss 6.149, Loss_clf 0.394, Loss_fe 3.734, Loss_kd 1.515, Train_accy 85.32:  50%|█████     | 10/20 [05:59<05:53, 35.34s/it]Task 3, Epoch 11/20 => Loss 6.108, Loss_clf 0.369, Loss_fe 3.732, Loss_kd 1.505, Train_accy 85.03, Test_accy 90.62:  50%|█████     | 10/20 [06:39<05:53, 35.34s/it]Task 3, Epoch 11/20 => Loss 6.108, Loss_clf 0.369, Loss_fe 3.732, Loss_kd 1.505, Train_accy 85.03, Test_accy 90.62:  55%|█████▌    | 11/20 [06:39<05:30, 36.76s/it]Task 3, Epoch 12/20 => Loss 6.161, Loss_clf 0.405, Loss_fe 3.727, Loss_kd 1.522, Train_accy 85.03:  55%|█████▌    | 11/20 [07:13<05:30, 36.76s/it]                 Task 3, Epoch 12/20 => Loss 6.161, Loss_clf 0.405, Loss_fe 3.727, Loss_kd 1.522, Train_accy 85.03:  60%|██████    | 12/20 [07:13<04:49, 36.18s/it]Task 3, Epoch 13/20 => Loss 6.072, Loss_clf 0.342, Loss_fe 3.723, Loss_kd 1.505, Train_accy 86.76:  60%|██████    | 12/20 [07:48<04:49, 36.18s/it]Task 3, Epoch 13/20 => Loss 6.072, Loss_clf 0.342, Loss_fe 3.723, Loss_kd 1.505, Train_accy 86.76:  65%|██████▌   | 13/20 [07:48<04:10, 35.78s/it]Task 3, Epoch 14/20 => Loss 6.069, Loss_clf 0.337, Loss_fe 3.714, Loss_kd 1.514, Train_accy 86.18:  65%|██████▌   | 13/20 [08:23<04:10, 35.78s/it]Task 3, Epoch 14/20 => Loss 6.069, Loss_clf 0.337, Loss_fe 3.714, Loss_kd 1.514, Train_accy 86.18:  70%|███████   | 14/20 [08:23<03:32, 35.49s/it]Task 3, Epoch 15/20 => Loss 6.105, Loss_clf 0.354, Loss_fe 3.710, Loss_kd 1.531, Train_accy 85.22:  70%|███████   | 14/20 [08:58<03:32, 35.49s/it]Task 3, Epoch 15/20 => Loss 6.105, Loss_clf 0.354, Loss_fe 3.710, Loss_kd 1.531, Train_accy 85.22:  75%|███████▌  | 15/20 [08:58<02:56, 35.29s/it]Task 3, Epoch 16/20 => Loss 6.047, Loss_clf 0.340, Loss_fe 3.704, Loss_kd 1.502, Train_accy 86.85, Test_accy 89.49:  75%|███████▌  | 15/20 [09:38<02:56, 35.29s/it]Task 3, Epoch 16/20 => Loss 6.047, Loss_clf 0.340, Loss_fe 3.704, Loss_kd 1.502, Train_accy 86.85, Test_accy 89.49:  80%|████████  | 16/20 [09:38<02:26, 36.71s/it]Task 3, Epoch 17/20 => Loss 6.151, Loss_clf 0.400, Loss_fe 3.696, Loss_kd 1.541, Train_accy 85.12:  80%|████████  | 16/20 [10:13<02:26, 36.71s/it]                 Task 3, Epoch 17/20 => Loss 6.151, Loss_clf 0.400, Loss_fe 3.696, Loss_kd 1.541, Train_accy 85.12:  85%|████████▌ | 17/20 [10:13<01:48, 36.14s/it]Task 3, Epoch 18/20 => Loss 6.116, Loss_clf 0.395, Loss_fe 3.693, Loss_kd 1.521, Train_accy 84.93:  85%|████████▌ | 17/20 [10:48<01:48, 36.14s/it]Task 3, Epoch 18/20 => Loss 6.116, Loss_clf 0.395, Loss_fe 3.693, Loss_kd 1.521, Train_accy 84.93:  90%|█████████ | 18/20 [10:48<01:11, 35.75s/it]Task 3, Epoch 19/20 => Loss 5.993, Loss_clf 0.309, Loss_fe 3.688, Loss_kd 1.497, Train_accy 87.04:  90%|█████████ | 18/20 [11:22<01:11, 35.75s/it]Task 3, Epoch 19/20 => Loss 5.993, Loss_clf 0.309, Loss_fe 3.688, Loss_kd 1.497, Train_accy 87.04:  95%|█████████▌| 19/20 [11:22<00:35, 35.48s/it]Task 3, Epoch 20/20 => Loss 6.029, Loss_clf 0.341, Loss_fe 3.687, Loss_kd 1.501, Train_accy 87.14:  95%|█████████▌| 19/20 [11:57<00:35, 35.48s/it]Task 3, Epoch 20/20 => Loss 6.029, Loss_clf 0.341, Loss_fe 3.687, Loss_kd 1.501, Train_accy 87.14: 100%|██████████| 20/20 [11:57<00:00, 35.27s/it]Task 3, Epoch 20/20 => Loss 6.029, Loss_clf 0.341, Loss_fe 3.687, Loss_kd 1.501, Train_accy 87.14: 100%|██████████| 20/20 [11:57<00:00, 35.89s/it]
2023-10-25 15:11:49,556 [foster.py] => Task 3, Epoch 20/20 => Loss 6.029, Loss_clf 0.341, Loss_fe 3.687, Loss_kd 1.501, Train_accy 87.14
2023-10-25 15:11:49,558 [foster.py] => do not weight align teacher!
2023-10-25 15:11:49,559 [foster.py] => per cls weights : [1.13217418 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418
 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418
 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418
 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418
 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418 1.13217418
 0.60347747 0.60347747 0.60347747 0.60347747 0.60347747 0.60347747
 0.60347747 0.60347747 0.60347747 0.60347747]
2023-10-25 15:11:50,234 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 15:11:50,587 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 3, Epoch 1/20 => Loss 2.207,  Train_accy 63.72, Test_accy 71.02:   0%|          | 0/20 [00:44<?, ?it/s]SNet: Task 3, Epoch 1/20 => Loss 2.207,  Train_accy 63.72, Test_accy 71.02:   5%|▌         | 1/20 [00:44<13:59, 44.18s/it]SNet: Task 3, Epoch 2/20 => Loss 2.112,  Train_accy 73.03:   5%|▌         | 1/20 [01:25<13:59, 44.18s/it]                 SNet: Task 3, Epoch 2/20 => Loss 2.112,  Train_accy 73.03:  10%|█         | 2/20 [01:25<12:43, 42.40s/it]SNet: Task 3, Epoch 3/20 => Loss 2.083,  Train_accy 78.50:  10%|█         | 2/20 [02:06<12:43, 42.40s/it]SNet: Task 3, Epoch 3/20 => Loss 2.083,  Train_accy 78.50:  15%|█▌        | 3/20 [02:06<11:51, 41.83s/it]SNet: Task 3, Epoch 4/20 => Loss 2.084,  Train_accy 79.46:  15%|█▌        | 3/20 [02:47<11:51, 41.83s/it]SNet: Task 3, Epoch 4/20 => Loss 2.084,  Train_accy 79.46:  20%|██        | 4/20 [02:47<11:05, 41.57s/it]SNet: Task 3, Epoch 5/20 => Loss 2.076,  Train_accy 79.56:  20%|██        | 4/20 [03:37<11:05, 41.57s/it]SNet: Task 3, Epoch 5/20 => Loss 2.076,  Train_accy 79.56:  25%|██▌       | 5/20 [03:37<11:06, 44.46s/it]SNet: Task 3, Epoch 6/20 => Loss 2.070,  Train_accy 80.04, Test_accy 86.36:  25%|██▌       | 5/20 [04:21<11:06, 44.46s/it]SNet: Task 3, Epoch 6/20 => Loss 2.070,  Train_accy 80.04, Test_accy 86.36:  30%|███       | 6/20 [04:21<10:20, 44.34s/it]SNet: Task 3, Epoch 7/20 => Loss 2.046,  Train_accy 80.61:  30%|███       | 6/20 [05:02<10:20, 44.34s/it]                 SNet: Task 3, Epoch 7/20 => Loss 2.046,  Train_accy 80.61:  35%|███▌      | 7/20 [05:02<09:22, 43.30s/it]SNet: Task 3, Epoch 8/20 => Loss 2.081,  Train_accy 80.61:  35%|███▌      | 7/20 [05:43<09:22, 43.30s/it]SNet: Task 3, Epoch 8/20 => Loss 2.081,  Train_accy 80.61:  40%|████      | 8/20 [05:43<08:31, 42.62s/it]SNet: Task 3, Epoch 9/20 => Loss 2.075,  Train_accy 79.46:  40%|████      | 8/20 [06:24<08:31, 42.62s/it]SNet: Task 3, Epoch 9/20 => Loss 2.075,  Train_accy 79.46:  45%|████▌     | 9/20 [06:24<07:43, 42.16s/it]SNet: Task 3, Epoch 10/20 => Loss 2.095,  Train_accy 81.77:  45%|████▌     | 9/20 [07:06<07:43, 42.16s/it]SNet: Task 3, Epoch 10/20 => Loss 2.095,  Train_accy 81.77:  50%|█████     | 10/20 [07:06<06:58, 41.86s/it]SNet: Task 3, Epoch 11/20 => Loss 2.069,  Train_accy 80.13, Test_accy 86.36:  50%|█████     | 10/20 [07:50<06:58, 41.86s/it]SNet: Task 3, Epoch 11/20 => Loss 2.069,  Train_accy 80.13, Test_accy 86.36:  55%|█████▌    | 11/20 [07:50<06:23, 42.58s/it]SNet: Task 3, Epoch 12/20 => Loss 2.072,  Train_accy 79.37:  55%|█████▌    | 11/20 [08:31<06:23, 42.58s/it]                 SNet: Task 3, Epoch 12/20 => Loss 2.072,  Train_accy 79.37:  60%|██████    | 12/20 [08:31<05:37, 42.16s/it]SNet: Task 3, Epoch 13/20 => Loss 2.087,  Train_accy 78.89:  60%|██████    | 12/20 [09:12<05:37, 42.16s/it]SNet: Task 3, Epoch 13/20 => Loss 2.087,  Train_accy 78.89:  65%|██████▌   | 13/20 [09:12<04:52, 41.85s/it]SNet: Task 3, Epoch 14/20 => Loss 2.028,  Train_accy 82.82:  65%|██████▌   | 13/20 [09:53<04:52, 41.85s/it]SNet: Task 3, Epoch 14/20 => Loss 2.028,  Train_accy 82.82:  70%|███████   | 14/20 [09:53<04:09, 41.64s/it]SNet: Task 3, Epoch 15/20 => Loss 2.052,  Train_accy 80.61:  70%|███████   | 14/20 [10:34<04:09, 41.64s/it]SNet: Task 3, Epoch 15/20 => Loss 2.052,  Train_accy 80.61:  75%|███████▌  | 15/20 [10:34<03:27, 41.51s/it]SNet: Task 3, Epoch 16/20 => Loss 2.095,  Train_accy 81.57, Test_accy 86.08:  75%|███████▌  | 15/20 [11:19<03:27, 41.51s/it]SNet: Task 3, Epoch 16/20 => Loss 2.095,  Train_accy 81.57, Test_accy 86.08:  80%|████████  | 16/20 [11:19<02:49, 42.29s/it]SNet: Task 3, Epoch 17/20 => Loss 2.075,  Train_accy 80.71:  80%|████████  | 16/20 [12:00<02:49, 42.29s/it]                 SNet: Task 3, Epoch 17/20 => Loss 2.075,  Train_accy 80.71:  85%|████████▌ | 17/20 [12:00<02:05, 41.95s/it]SNet: Task 3, Epoch 18/20 => Loss 2.038,  Train_accy 79.85:  85%|████████▌ | 17/20 [12:41<02:05, 41.95s/it]SNet: Task 3, Epoch 18/20 => Loss 2.038,  Train_accy 79.85:  90%|█████████ | 18/20 [12:41<01:23, 41.72s/it]SNet: Task 3, Epoch 19/20 => Loss 2.066,  Train_accy 81.96:  90%|█████████ | 18/20 [13:22<01:23, 41.72s/it]SNet: Task 3, Epoch 19/20 => Loss 2.066,  Train_accy 81.96:  95%|█████████▌| 19/20 [13:22<00:41, 41.56s/it]SNet: Task 3, Epoch 20/20 => Loss 2.083,  Train_accy 81.19:  95%|█████████▌| 19/20 [14:03<00:41, 41.56s/it]SNet: Task 3, Epoch 20/20 => Loss 2.083,  Train_accy 81.19: 100%|██████████| 20/20 [14:03<00:00, 41.45s/it]SNet: Task 3, Epoch 20/20 => Loss 2.083,  Train_accy 81.19: 100%|██████████| 20/20 [14:03<00:00, 42.19s/it]
2023-10-25 15:25:54,446 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 2.083,  Train_accy 81.19
2023-10-25 15:25:54,500 [foster.py] => do not weight align student!
2023-10-25 15:25:57,479 [foster.py] => darknet eval: 
2023-10-25 15:25:57,479 [foster.py] => CNN top1 curve: 86.36
2023-10-25 15:25:57,479 [foster.py] => CNN top5 curve: 99.15
2023-10-25 15:25:57,481 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 15:26:53,274 [foster.py] => Exemplar size: 1000
2023-10-25 15:26:53,854 [trainer.py] => CNN: {'total': 90.06, '00-09': 94.25, '10-19': 89.89, '20-29': 97.73, '30-39': 78.41, 'old': 93.94, 'new': 78.41}
2023-10-25 15:26:53,854 [trainer.py] => NME: {'total': 92.05, '00-09': 93.1, '10-19': 89.89, '20-29': 93.18, '30-39': 92.05, 'old': 92.05, 'new': 92.05}
2023-10-25 15:26:53,854 [trainer.py] => CNN top1 curve: [96.55, 90.34, 93.56, 90.06]
2023-10-25 15:26:53,854 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.43]
2023-10-25 15:26:53,854 [trainer.py] => NME top1 curve: [97.7, 93.18, 96.21, 92.05]
2023-10-25 15:26:53,854 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.72]

Average Accuracy (CNN): 92.6275
Average Accuracy (NME): 94.785
2023-10-25 15:26:53,854 [trainer.py] => Average Accuracy (CNN): 92.6275
2023-10-25 15:26:53,854 [trainer.py] => Average Accuracy (NME): 94.785
2023-10-25 15:26:53,858 [trainer.py] => All params: 105218234
2023-10-25 15:26:53,861 [trainer.py] => Trainable params: 52635062
2023-10-25 15:26:54,469 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 15:26:54,824 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 15:26:54,914 [foster.py] => Learning on 40-50
2023-10-25 15:26:54,919 [foster.py] => All params: 105241304
2023-10-25 15:26:54,922 [foster.py] => Trainable params: 52652362
2023-10-25 15:26:54,954 [foster.py] => per cls weights : [1.07767835 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835
 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835
 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835
 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835
 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835
 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835 1.07767835
 1.07767835 1.07767835 1.07767835 1.07767835 0.68928661 0.68928661
 0.68928661 0.68928661 0.68928661 0.68928661 0.68928661 0.68928661
 0.68928661 0.68928661]
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 5.163, Loss_clf 0.826, Loss_fe 2.057, Loss_kd 1.824, Train_accy 74.25, Test_accy 84.81:   0%|          | 0/20 [00:49<?, ?it/s]Task 4, Epoch 1/20 => Loss 5.163, Loss_clf 0.826, Loss_fe 2.057, Loss_kd 1.824, Train_accy 74.25, Test_accy 84.81:   5%|▌         | 1/20 [00:49<15:42, 49.59s/it]Task 4, Epoch 2/20 => Loss 3.744, Loss_clf 0.581, Loss_fe 0.868, Loss_kd 1.836, Train_accy 79.41:   5%|▌         | 1/20 [01:32<15:42, 49.59s/it]                 Task 4, Epoch 2/20 => Loss 3.744, Loss_clf 0.581, Loss_fe 0.868, Loss_kd 1.836, Train_accy 79.41:  10%|█         | 2/20 [01:32<13:44, 45.83s/it]Task 4, Epoch 3/20 => Loss 3.471, Loss_clf 0.487, Loss_fe 0.710, Loss_kd 1.819, Train_accy 82.19:  10%|█         | 2/20 [02:16<13:44, 45.83s/it]Task 4, Epoch 3/20 => Loss 3.471, Loss_clf 0.487, Loss_fe 0.710, Loss_kd 1.819, Train_accy 82.19:  15%|█▌        | 3/20 [02:16<12:38, 44.64s/it]Task 4, Epoch 4/20 => Loss 3.346, Loss_clf 0.459, Loss_fe 0.589, Loss_kd 1.839, Train_accy 83.58:  15%|█▌        | 3/20 [02:59<12:38, 44.64s/it]Task 4, Epoch 4/20 => Loss 3.346, Loss_clf 0.459, Loss_fe 0.589, Loss_kd 1.839, Train_accy 83.58:  20%|██        | 4/20 [02:59<11:44, 44.06s/it]Task 4, Epoch 5/20 => Loss 3.210, Loss_clf 0.432, Loss_fe 0.492, Loss_kd 1.829, Train_accy 85.12:  20%|██        | 4/20 [03:42<11:44, 44.06s/it]Task 4, Epoch 5/20 => Loss 3.210, Loss_clf 0.432, Loss_fe 0.492, Loss_kd 1.829, Train_accy 85.12:  25%|██▌       | 5/20 [03:42<10:56, 43.75s/it]Task 4, Epoch 6/20 => Loss 3.150, Loss_clf 0.408, Loss_fe 0.461, Loss_kd 1.825, Train_accy 85.12, Test_accy 88.89:  25%|██▌       | 5/20 [04:31<10:56, 43.75s/it]Task 4, Epoch 6/20 => Loss 3.150, Loss_clf 0.408, Loss_fe 0.461, Loss_kd 1.825, Train_accy 85.12, Test_accy 88.89:  30%|███       | 6/20 [04:31<10:39, 45.70s/it]Task 4, Epoch 7/20 => Loss 3.070, Loss_clf 0.387, Loss_fe 0.416, Loss_kd 1.814, Train_accy 85.35:  30%|███       | 6/20 [05:15<10:39, 45.70s/it]                 Task 4, Epoch 7/20 => Loss 3.070, Loss_clf 0.387, Loss_fe 0.416, Loss_kd 1.814, Train_accy 85.35:  35%|███▌      | 7/20 [05:15<09:43, 44.88s/it]Task 4, Epoch 8/20 => Loss 3.082, Loss_clf 0.369, Loss_fe 0.418, Loss_kd 1.837, Train_accy 86.43:  35%|███▌      | 7/20 [05:58<09:43, 44.88s/it]Task 4, Epoch 8/20 => Loss 3.082, Loss_clf 0.369, Loss_fe 0.418, Loss_kd 1.837, Train_accy 86.43:  40%|████      | 8/20 [05:58<08:52, 44.34s/it]Task 4, Epoch 9/20 => Loss 2.956, Loss_clf 0.348, Loss_fe 0.341, Loss_kd 1.814, Train_accy 87.90:  40%|████      | 8/20 [06:41<08:52, 44.34s/it]Task 4, Epoch 9/20 => Loss 2.956, Loss_clf 0.348, Loss_fe 0.341, Loss_kd 1.814, Train_accy 87.90:  45%|████▌     | 9/20 [06:41<08:03, 43.98s/it]Task 4, Epoch 10/20 => Loss 3.051, Loss_clf 0.384, Loss_fe 0.367, Loss_kd 1.840, Train_accy 86.89:  45%|████▌     | 9/20 [07:24<08:03, 43.98s/it]Task 4, Epoch 10/20 => Loss 3.051, Loss_clf 0.384, Loss_fe 0.367, Loss_kd 1.840, Train_accy 86.89:  50%|█████     | 10/20 [07:24<07:17, 43.74s/it]Task 4, Epoch 11/20 => Loss 3.042, Loss_clf 0.371, Loss_fe 0.392, Loss_kd 1.823, Train_accy 86.97, Test_accy 90.02:  50%|█████     | 10/20 [08:14<07:17, 43.74s/it]Task 4, Epoch 11/20 => Loss 3.042, Loss_clf 0.371, Loss_fe 0.392, Loss_kd 1.823, Train_accy 86.97, Test_accy 90.02:  55%|█████▌    | 11/20 [08:14<06:50, 45.56s/it]Task 4, Epoch 12/20 => Loss 3.029, Loss_clf 0.373, Loss_fe 0.375, Loss_kd 1.825, Train_accy 85.81:  55%|█████▌    | 11/20 [08:57<06:50, 45.56s/it]                 Task 4, Epoch 12/20 => Loss 3.029, Loss_clf 0.373, Loss_fe 0.375, Loss_kd 1.825, Train_accy 85.81:  60%|██████    | 12/20 [08:57<05:58, 44.84s/it]Task 4, Epoch 13/20 => Loss 2.984, Loss_clf 0.363, Loss_fe 0.336, Loss_kd 1.828, Train_accy 88.43:  60%|██████    | 12/20 [09:40<05:58, 44.84s/it]Task 4, Epoch 13/20 => Loss 2.984, Loss_clf 0.363, Loss_fe 0.336, Loss_kd 1.828, Train_accy 88.43:  65%|██████▌   | 13/20 [09:40<05:10, 44.34s/it]Task 4, Epoch 14/20 => Loss 2.947, Loss_clf 0.354, Loss_fe 0.313, Loss_kd 1.824, Train_accy 90.13:  65%|██████▌   | 13/20 [10:23<05:10, 44.34s/it]Task 4, Epoch 14/20 => Loss 2.947, Loss_clf 0.354, Loss_fe 0.313, Loss_kd 1.824, Train_accy 90.13:  70%|███████   | 14/20 [10:23<04:24, 44.01s/it]Task 4, Epoch 15/20 => Loss 2.912, Loss_clf 0.331, Loss_fe 0.293, Loss_kd 1.830, Train_accy 88.67:  70%|███████   | 14/20 [11:07<04:24, 44.01s/it]Task 4, Epoch 15/20 => Loss 2.912, Loss_clf 0.331, Loss_fe 0.293, Loss_kd 1.830, Train_accy 88.67:  75%|███████▌  | 15/20 [11:07<03:38, 43.76s/it]Task 4, Epoch 16/20 => Loss 2.935, Loss_clf 0.356, Loss_fe 0.305, Loss_kd 1.819, Train_accy 87.74, Test_accy 90.25:  75%|███████▌  | 15/20 [11:56<03:38, 43.76s/it]Task 4, Epoch 16/20 => Loss 2.935, Loss_clf 0.356, Loss_fe 0.305, Loss_kd 1.819, Train_accy 87.74, Test_accy 90.25:  80%|████████  | 16/20 [11:56<03:02, 45.52s/it]Task 4, Epoch 17/20 => Loss 2.926, Loss_clf 0.352, Loss_fe 0.291, Loss_kd 1.826, Train_accy 87.90:  80%|████████  | 16/20 [12:39<03:02, 45.52s/it]                 Task 4, Epoch 17/20 => Loss 2.926, Loss_clf 0.352, Loss_fe 0.291, Loss_kd 1.826, Train_accy 87.90:  85%|████████▌ | 17/20 [12:39<02:14, 44.82s/it]Task 4, Epoch 18/20 => Loss 2.955, Loss_clf 0.365, Loss_fe 0.296, Loss_kd 1.835, Train_accy 88.36:  85%|████████▌ | 17/20 [13:23<02:14, 44.82s/it]Task 4, Epoch 18/20 => Loss 2.955, Loss_clf 0.365, Loss_fe 0.296, Loss_kd 1.835, Train_accy 88.36:  90%|█████████ | 18/20 [13:23<01:28, 44.34s/it]Task 4, Epoch 19/20 => Loss 2.822, Loss_clf 0.301, Loss_fe 0.241, Loss_kd 1.825, Train_accy 91.52:  90%|█████████ | 18/20 [14:06<01:28, 44.34s/it]Task 4, Epoch 19/20 => Loss 2.822, Loss_clf 0.301, Loss_fe 0.241, Loss_kd 1.825, Train_accy 91.52:  95%|█████████▌| 19/20 [14:06<00:44, 44.01s/it]Task 4, Epoch 20/20 => Loss 2.847, Loss_clf 0.328, Loss_fe 0.257, Loss_kd 1.810, Train_accy 88.74:  95%|█████████▌| 19/20 [14:49<00:44, 44.01s/it]Task 4, Epoch 20/20 => Loss 2.847, Loss_clf 0.328, Loss_fe 0.257, Loss_kd 1.810, Train_accy 88.74: 100%|██████████| 20/20 [14:49<00:00, 43.77s/it]Task 4, Epoch 20/20 => Loss 2.847, Loss_clf 0.328, Loss_fe 0.257, Loss_kd 1.810, Train_accy 88.74: 100%|██████████| 20/20 [14:49<00:00, 44.48s/it]
2023-10-25 15:41:44,548 [foster.py] => Task 4, Epoch 20/20 => Loss 2.847, Loss_clf 0.328, Loss_fe 0.257, Loss_kd 1.810, Train_accy 88.74
2023-10-25 15:41:44,549 [foster.py] => do not weight align teacher!
2023-10-25 15:41:44,550 [foster.py] => per cls weights : [1.10301613 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613
 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613
 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613
 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613
 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613
 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613 1.10301613
 1.10301613 1.10301613 1.10301613 1.10301613 0.5879355  0.5879355
 0.5879355  0.5879355  0.5879355  0.5879355  0.5879355  0.5879355
 0.5879355  0.5879355 ]
2023-10-25 15:41:45,173 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 15:41:45,537 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 4, Epoch 1/20 => Loss 2.295,  Train_accy 67.77, Test_accy 80.27:   0%|          | 0/20 [00:54<?, ?it/s]SNet: Task 4, Epoch 1/20 => Loss 2.295,  Train_accy 67.77, Test_accy 80.27:   5%|▌         | 1/20 [00:54<17:19, 54.72s/it]SNet: Task 4, Epoch 2/20 => Loss 2.255,  Train_accy 71.47:   5%|▌         | 1/20 [01:45<17:19, 54.72s/it]                 SNet: Task 4, Epoch 2/20 => Loss 2.255,  Train_accy 71.47:  10%|█         | 2/20 [01:45<15:46, 52.59s/it]SNet: Task 4, Epoch 3/20 => Loss 2.217,  Train_accy 75.56:  10%|█         | 2/20 [02:36<15:46, 52.59s/it]SNet: Task 4, Epoch 3/20 => Loss 2.217,  Train_accy 75.56:  15%|█▌        | 3/20 [02:36<14:42, 51.90s/it]SNet: Task 4, Epoch 4/20 => Loss 2.182,  Train_accy 79.65:  15%|█▌        | 3/20 [03:28<14:42, 51.90s/it]SNet: Task 4, Epoch 4/20 => Loss 2.182,  Train_accy 79.65:  20%|██        | 4/20 [03:28<13:45, 51.59s/it]SNet: Task 4, Epoch 5/20 => Loss 2.187,  Train_accy 79.41:  20%|██        | 4/20 [04:19<13:45, 51.59s/it]SNet: Task 4, Epoch 5/20 => Loss 2.187,  Train_accy 79.41:  25%|██▌       | 5/20 [04:19<12:51, 51.41s/it]SNet: Task 4, Epoch 6/20 => Loss 2.145,  Train_accy 80.11, Test_accy 87.53:  25%|██▌       | 5/20 [05:13<12:51, 51.41s/it]SNet: Task 4, Epoch 6/20 => Loss 2.145,  Train_accy 80.11, Test_accy 87.53:  30%|███       | 6/20 [05:13<12:15, 52.53s/it]SNet: Task 4, Epoch 7/20 => Loss 2.168,  Train_accy 80.03:  30%|███       | 6/20 [06:04<12:15, 52.53s/it]                 SNet: Task 4, Epoch 7/20 => Loss 2.168,  Train_accy 80.03:  35%|███▌      | 7/20 [06:04<11:16, 52.07s/it]SNet: Task 4, Epoch 8/20 => Loss 2.168,  Train_accy 82.34:  35%|███▌      | 7/20 [06:56<11:16, 52.07s/it]SNet: Task 4, Epoch 8/20 => Loss 2.168,  Train_accy 82.34:  40%|████      | 8/20 [06:56<10:21, 51.76s/it]SNet: Task 4, Epoch 9/20 => Loss 2.140,  Train_accy 82.34:  40%|████      | 8/20 [07:47<10:21, 51.76s/it]SNet: Task 4, Epoch 9/20 => Loss 2.140,  Train_accy 82.34:  45%|████▌     | 9/20 [07:47<09:27, 51.56s/it]SNet: Task 4, Epoch 10/20 => Loss 2.154,  Train_accy 81.03:  45%|████▌     | 9/20 [08:38<09:27, 51.56s/it]SNet: Task 4, Epoch 10/20 => Loss 2.154,  Train_accy 81.03:  50%|█████     | 10/20 [08:38<08:34, 51.43s/it]SNet: Task 4, Epoch 11/20 => Loss 2.168,  Train_accy 82.88, Test_accy 87.07:  50%|█████     | 10/20 [09:33<08:34, 51.43s/it]SNet: Task 4, Epoch 11/20 => Loss 2.168,  Train_accy 82.88, Test_accy 87.07:  55%|█████▌    | 11/20 [09:33<07:51, 52.44s/it]SNet: Task 4, Epoch 12/20 => Loss 2.171,  Train_accy 81.50:  55%|█████▌    | 11/20 [10:24<07:51, 52.44s/it]                 SNet: Task 4, Epoch 12/20 => Loss 2.171,  Train_accy 81.50:  60%|██████    | 12/20 [10:24<06:56, 52.04s/it]SNet: Task 4, Epoch 13/20 => Loss 2.142,  Train_accy 82.34:  60%|██████    | 12/20 [11:15<06:56, 52.04s/it]SNet: Task 4, Epoch 13/20 => Loss 2.142,  Train_accy 82.34:  65%|██████▌   | 13/20 [11:15<06:02, 51.75s/it]SNet: Task 4, Epoch 14/20 => Loss 2.169,  Train_accy 82.34:  65%|██████▌   | 13/20 [12:06<06:02, 51.75s/it]SNet: Task 4, Epoch 14/20 => Loss 2.169,  Train_accy 82.34:  70%|███████   | 14/20 [12:06<05:09, 51.56s/it]SNet: Task 4, Epoch 15/20 => Loss 2.128,  Train_accy 81.96:  70%|███████   | 14/20 [12:57<05:09, 51.56s/it]SNet: Task 4, Epoch 15/20 => Loss 2.128,  Train_accy 81.96:  75%|███████▌  | 15/20 [12:57<04:17, 51.42s/it]SNet: Task 4, Epoch 16/20 => Loss 2.169,  Train_accy 83.35, Test_accy 86.85:  75%|███████▌  | 15/20 [13:52<04:17, 51.42s/it]SNet: Task 4, Epoch 16/20 => Loss 2.169,  Train_accy 83.35, Test_accy 86.85:  80%|████████  | 16/20 [13:52<03:29, 52.41s/it]SNet: Task 4, Epoch 17/20 => Loss 2.160,  Train_accy 82.27:  80%|████████  | 16/20 [14:43<03:29, 52.41s/it]                 SNet: Task 4, Epoch 17/20 => Loss 2.160,  Train_accy 82.27:  85%|████████▌ | 17/20 [14:43<02:36, 52.02s/it]SNet: Task 4, Epoch 18/20 => Loss 2.138,  Train_accy 83.73:  85%|████████▌ | 17/20 [15:34<02:36, 52.02s/it]SNet: Task 4, Epoch 18/20 => Loss 2.138,  Train_accy 83.73:  90%|█████████ | 18/20 [15:34<01:43, 51.75s/it]SNet: Task 4, Epoch 19/20 => Loss 2.135,  Train_accy 83.42:  90%|█████████ | 18/20 [16:25<01:43, 51.75s/it]SNet: Task 4, Epoch 19/20 => Loss 2.135,  Train_accy 83.42:  95%|█████████▌| 19/20 [16:25<00:51, 51.56s/it]SNet: Task 4, Epoch 20/20 => Loss 2.111,  Train_accy 81.34:  95%|█████████▌| 19/20 [17:16<00:51, 51.56s/it]SNet: Task 4, Epoch 20/20 => Loss 2.111,  Train_accy 81.34: 100%|██████████| 20/20 [17:16<00:00, 51.42s/it]SNet: Task 4, Epoch 20/20 => Loss 2.111,  Train_accy 81.34: 100%|██████████| 20/20 [17:16<00:00, 51.83s/it]
2023-10-25 15:59:02,287 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 2.111,  Train_accy 81.34
2023-10-25 15:59:02,288 [foster.py] => do not weight align student!
2023-10-25 15:59:05,884 [foster.py] => darknet eval: 
2023-10-25 15:59:05,884 [foster.py] => CNN top1 curve: 86.85
2023-10-25 15:59:05,884 [foster.py] => CNN top5 curve: 99.09
2023-10-25 15:59:05,886 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 16:00:11,075 [foster.py] => Exemplar size: 1250
2023-10-25 16:00:12,351 [trainer.py] => CNN: {'total': 90.48, '00-09': 90.8, '10-19': 93.26, '20-29': 96.59, '30-39': 90.91, '40-49': 80.9, 'old': 92.9, 'new': 80.9}
2023-10-25 16:00:12,351 [trainer.py] => NME: {'total': 93.42, '00-09': 91.95, '10-19': 92.13, '20-29': 94.32, '30-39': 95.45, '40-49': 93.26, 'old': 93.47, 'new': 93.26}
2023-10-25 16:00:12,351 [trainer.py] => CNN top1 curve: [96.55, 90.34, 93.56, 90.06, 90.48]
2023-10-25 16:00:12,351 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.43, 99.09]
2023-10-25 16:00:12,351 [trainer.py] => NME top1 curve: [97.7, 93.18, 96.21, 92.05, 93.42]
2023-10-25 16:00:12,352 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.72, 99.77]

Average Accuracy (CNN): 92.19800000000001
Average Accuracy (NME): 94.512
2023-10-25 16:00:12,352 [trainer.py] => Average Accuracy (CNN): 92.19800000000001
2023-10-25 16:00:12,352 [trainer.py] => Average Accuracy (NME): 94.512
2023-10-25 16:00:12,355 [trainer.py] => All params: 105241304
2023-10-25 16:00:12,358 [trainer.py] => Trainable params: 52652362
2023-10-25 16:00:12,944 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 16:00:13,463 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 16:00:14,210 [foster.py] => Learning on 50-60
2023-10-25 16:00:14,215 [foster.py] => All params: 105264374
2023-10-25 16:00:14,218 [foster.py] => Trainable params: 52669662
2023-10-25 16:00:14,252 [foster.py] => per cls weights : [1.06390462 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462
 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462
 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462
 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462
 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462
 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462
 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462
 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462 1.06390462
 1.06390462 1.06390462 0.68047689 0.68047689 0.68047689 0.68047689
 0.68047689 0.68047689 0.68047689 0.68047689 0.68047689 0.68047689]
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 5.334, Loss_clf 0.856, Loss_fe 2.103, Loss_kd 1.979, Train_accy 76.18, Test_accy 88.14:   0%|          | 0/20 [00:58<?, ?it/s]Task 5, Epoch 1/20 => Loss 5.334, Loss_clf 0.856, Loss_fe 2.103, Loss_kd 1.979, Train_accy 76.18, Test_accy 88.14:   5%|▌         | 1/20 [00:58<18:37, 58.80s/it]Task 5, Epoch 2/20 => Loss 3.727, Loss_clf 0.533, Loss_fe 0.834, Loss_kd 1.966, Train_accy 80.76:   5%|▌         | 1/20 [01:50<18:37, 58.80s/it]                 Task 5, Epoch 2/20 => Loss 3.727, Loss_clf 0.533, Loss_fe 0.834, Loss_kd 1.966, Train_accy 80.76:  10%|█         | 2/20 [01:50<16:20, 54.46s/it]Task 5, Epoch 3/20 => Loss 3.504, Loss_clf 0.506, Loss_fe 0.648, Loss_kd 1.959, Train_accy 82.50:  10%|█         | 2/20 [02:41<16:20, 54.46s/it]Task 5, Epoch 3/20 => Loss 3.504, Loss_clf 0.506, Loss_fe 0.648, Loss_kd 1.959, Train_accy 82.50:  15%|█▌        | 3/20 [02:41<15:02, 53.09s/it]Task 5, Epoch 4/20 => Loss 3.259, Loss_clf 0.417, Loss_fe 0.517, Loss_kd 1.938, Train_accy 84.96:  15%|█▌        | 3/20 [03:33<15:02, 53.09s/it]Task 5, Epoch 4/20 => Loss 3.259, Loss_clf 0.417, Loss_fe 0.517, Loss_kd 1.938, Train_accy 84.96:  20%|██        | 4/20 [03:33<13:59, 52.44s/it]Task 5, Epoch 5/20 => Loss 3.280, Loss_clf 0.421, Loss_fe 0.493, Loss_kd 1.972, Train_accy 85.35:  20%|██        | 4/20 [04:24<13:59, 52.44s/it]Task 5, Epoch 5/20 => Loss 3.280, Loss_clf 0.421, Loss_fe 0.493, Loss_kd 1.972, Train_accy 85.35:  25%|██▌       | 5/20 [04:24<13:01, 52.07s/it]Task 5, Epoch 6/20 => Loss 3.210, Loss_clf 0.395, Loss_fe 0.481, Loss_kd 1.945, Train_accy 85.67, Test_accy 90.21:  25%|██▌       | 5/20 [05:23<13:01, 52.07s/it]Task 5, Epoch 6/20 => Loss 3.210, Loss_clf 0.395, Loss_fe 0.481, Loss_kd 1.945, Train_accy 85.67, Test_accy 90.21:  30%|███       | 6/20 [05:23<12:42, 54.47s/it]Task 5, Epoch 7/20 => Loss 3.145, Loss_clf 0.382, Loss_fe 0.423, Loss_kd 1.950, Train_accy 86.77:  30%|███       | 6/20 [06:15<12:42, 54.47s/it]                 Task 5, Epoch 7/20 => Loss 3.145, Loss_clf 0.382, Loss_fe 0.423, Loss_kd 1.950, Train_accy 86.77:  35%|███▌      | 7/20 [06:15<11:35, 53.48s/it]Task 5, Epoch 8/20 => Loss 3.246, Loss_clf 0.445, Loss_fe 0.458, Loss_kd 1.952, Train_accy 84.25:  35%|███▌      | 7/20 [07:06<11:35, 53.48s/it]Task 5, Epoch 8/20 => Loss 3.246, Loss_clf 0.445, Loss_fe 0.458, Loss_kd 1.952, Train_accy 84.25:  40%|████      | 8/20 [07:06<10:33, 52.83s/it]Task 5, Epoch 9/20 => Loss 3.195, Loss_clf 0.421, Loss_fe 0.433, Loss_kd 1.951, Train_accy 86.57:  40%|████      | 8/20 [07:58<10:33, 52.83s/it]Task 5, Epoch 9/20 => Loss 3.195, Loss_clf 0.421, Loss_fe 0.433, Loss_kd 1.951, Train_accy 86.57:  45%|████▌     | 9/20 [07:58<09:36, 52.41s/it]Task 5, Epoch 10/20 => Loss 2.966, Loss_clf 0.333, Loss_fe 0.319, Loss_kd 1.929, Train_accy 87.28:  45%|████▌     | 9/20 [08:49<09:36, 52.41s/it]Task 5, Epoch 10/20 => Loss 2.966, Loss_clf 0.333, Loss_fe 0.319, Loss_kd 1.929, Train_accy 87.28:  50%|█████     | 10/20 [08:49<08:41, 52.10s/it]Task 5, Epoch 11/20 => Loss 3.117, Loss_clf 0.395, Loss_fe 0.365, Loss_kd 1.964, Train_accy 86.25, Test_accy 90.21:  50%|█████     | 10/20 [09:48<08:41, 52.10s/it]Task 5, Epoch 11/20 => Loss 3.117, Loss_clf 0.395, Loss_fe 0.365, Loss_kd 1.964, Train_accy 86.25, Test_accy 90.21:  55%|█████▌    | 11/20 [09:48<08:07, 54.20s/it]Task 5, Epoch 12/20 => Loss 2.890, Loss_clf 0.319, Loss_fe 0.261, Loss_kd 1.925, Train_accy 89.74:  55%|█████▌    | 11/20 [10:39<08:07, 54.20s/it]                 Task 5, Epoch 12/20 => Loss 2.890, Loss_clf 0.319, Loss_fe 0.261, Loss_kd 1.925, Train_accy 89.74:  60%|██████    | 12/20 [10:39<07:06, 53.37s/it]Task 5, Epoch 13/20 => Loss 2.877, Loss_clf 0.309, Loss_fe 0.255, Loss_kd 1.928, Train_accy 89.28:  60%|██████    | 12/20 [11:31<07:06, 53.37s/it]Task 5, Epoch 13/20 => Loss 2.877, Loss_clf 0.309, Loss_fe 0.255, Loss_kd 1.928, Train_accy 89.28:  65%|██████▌   | 13/20 [11:31<06:09, 52.79s/it]Task 5, Epoch 14/20 => Loss 2.985, Loss_clf 0.362, Loss_fe 0.291, Loss_kd 1.943, Train_accy 88.12:  65%|██████▌   | 13/20 [12:22<06:09, 52.79s/it]Task 5, Epoch 14/20 => Loss 2.985, Loss_clf 0.362, Loss_fe 0.291, Loss_kd 1.943, Train_accy 88.12:  70%|███████   | 14/20 [12:22<05:14, 52.39s/it]Task 5, Epoch 15/20 => Loss 2.948, Loss_clf 0.333, Loss_fe 0.274, Loss_kd 1.951, Train_accy 88.77:  70%|███████   | 14/20 [13:14<05:14, 52.39s/it]Task 5, Epoch 15/20 => Loss 2.948, Loss_clf 0.333, Loss_fe 0.274, Loss_kd 1.951, Train_accy 88.77:  75%|███████▌  | 15/20 [13:14<04:20, 52.09s/it]Task 5, Epoch 16/20 => Loss 2.988, Loss_clf 0.362, Loss_fe 0.286, Loss_kd 1.950, Train_accy 87.60, Test_accy 91.15:  75%|███████▌  | 15/20 [14:13<04:20, 52.09s/it]Task 5, Epoch 16/20 => Loss 2.988, Loss_clf 0.362, Loss_fe 0.286, Loss_kd 1.950, Train_accy 87.60, Test_accy 91.15:  80%|████████  | 16/20 [14:13<03:36, 54.13s/it]Task 5, Epoch 17/20 => Loss 3.008, Loss_clf 0.360, Loss_fe 0.303, Loss_kd 1.954, Train_accy 87.99:  80%|████████  | 16/20 [15:04<03:36, 54.13s/it]                 Task 5, Epoch 17/20 => Loss 3.008, Loss_clf 0.360, Loss_fe 0.303, Loss_kd 1.954, Train_accy 87.99:  85%|████████▌ | 17/20 [15:04<02:39, 53.33s/it]Task 5, Epoch 18/20 => Loss 2.956, Loss_clf 0.349, Loss_fe 0.271, Loss_kd 1.946, Train_accy 88.32:  85%|████████▌ | 17/20 [15:55<02:39, 53.33s/it]Task 5, Epoch 18/20 => Loss 2.956, Loss_clf 0.349, Loss_fe 0.271, Loss_kd 1.946, Train_accy 88.32:  90%|█████████ | 18/20 [15:55<01:45, 52.77s/it]Task 5, Epoch 19/20 => Loss 2.896, Loss_clf 0.325, Loss_fe 0.242, Loss_kd 1.941, Train_accy 88.32:  90%|█████████ | 18/20 [16:47<01:45, 52.77s/it]Task 5, Epoch 19/20 => Loss 2.896, Loss_clf 0.325, Loss_fe 0.242, Loss_kd 1.941, Train_accy 88.32:  95%|█████████▌| 19/20 [16:47<00:52, 52.37s/it]Task 5, Epoch 20/20 => Loss 2.872, Loss_clf 0.315, Loss_fe 0.226, Loss_kd 1.943, Train_accy 88.44:  95%|█████████▌| 19/20 [17:39<00:52, 52.37s/it]Task 5, Epoch 20/20 => Loss 2.872, Loss_clf 0.315, Loss_fe 0.226, Loss_kd 1.943, Train_accy 88.44: 100%|██████████| 20/20 [17:39<00:00, 52.18s/it]Task 5, Epoch 20/20 => Loss 2.872, Loss_clf 0.315, Loss_fe 0.226, Loss_kd 1.943, Train_accy 88.44: 100%|██████████| 20/20 [17:39<00:00, 52.96s/it]
2023-10-25 16:17:53,389 [foster.py] => Task 5, Epoch 20/20 => Loss 2.872, Loss_clf 0.315, Loss_fe 0.226, Loss_kd 1.943, Train_accy 88.44
2023-10-25 16:17:53,391 [foster.py] => do not weight align teacher!
2023-10-25 16:17:53,392 [foster.py] => per cls weights : [1.08439772 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772
 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772
 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772
 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772
 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772
 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772
 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772
 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772 1.08439772
 1.08439772 1.08439772 0.57801141 0.57801141 0.57801141 0.57801141
 0.57801141 0.57801141 0.57801141 0.57801141 0.57801141 0.57801141]
2023-10-25 16:17:53,976 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 16:17:54,366 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 5, Epoch 1/20 => Loss 2.327,  Train_accy 72.50, Test_accy 82.11:   0%|          | 0/20 [01:05<?, ?it/s]SNet: Task 5, Epoch 1/20 => Loss 2.327,  Train_accy 72.50, Test_accy 82.11:   5%|▌         | 1/20 [01:05<20:36, 65.08s/it]SNet: Task 5, Epoch 2/20 => Loss 2.240,  Train_accy 79.08:   5%|▌         | 1/20 [02:05<20:36, 65.08s/it]                 SNet: Task 5, Epoch 2/20 => Loss 2.240,  Train_accy 79.08:  10%|█         | 2/20 [02:05<18:46, 62.59s/it]SNet: Task 5, Epoch 3/20 => Loss 2.254,  Train_accy 78.11:  10%|█         | 2/20 [03:06<18:46, 62.59s/it]SNet: Task 5, Epoch 3/20 => Loss 2.254,  Train_accy 78.11:  15%|█▌        | 3/20 [03:06<17:30, 61.80s/it]SNet: Task 5, Epoch 4/20 => Loss 2.214,  Train_accy 81.08:  15%|█▌        | 3/20 [04:07<17:30, 61.80s/it]SNet: Task 5, Epoch 4/20 => Loss 2.214,  Train_accy 81.08:  20%|██        | 4/20 [04:07<16:23, 61.45s/it]SNet: Task 5, Epoch 5/20 => Loss 2.200,  Train_accy 83.34:  20%|██        | 4/20 [05:08<16:23, 61.45s/it]SNet: Task 5, Epoch 5/20 => Loss 2.200,  Train_accy 83.34:  25%|██▌       | 5/20 [05:08<15:18, 61.23s/it]SNet: Task 5, Epoch 6/20 => Loss 2.202,  Train_accy 82.12, Test_accy 87.76:  25%|██▌       | 5/20 [06:13<15:18, 61.23s/it]SNet: Task 5, Epoch 6/20 => Loss 2.202,  Train_accy 82.12, Test_accy 87.76:  30%|███       | 6/20 [06:13<14:35, 62.53s/it]SNet: Task 5, Epoch 7/20 => Loss 2.199,  Train_accy 83.34:  30%|███       | 6/20 [07:14<14:35, 62.53s/it]                 SNet: Task 5, Epoch 7/20 => Loss 2.199,  Train_accy 83.34:  35%|███▌      | 7/20 [07:14<13:25, 61.98s/it]SNet: Task 5, Epoch 8/20 => Loss 2.206,  Train_accy 83.67:  35%|███▌      | 7/20 [08:15<13:25, 61.98s/it]SNet: Task 5, Epoch 8/20 => Loss 2.206,  Train_accy 83.67:  40%|████      | 8/20 [08:15<12:19, 61.63s/it]SNet: Task 5, Epoch 9/20 => Loss 2.192,  Train_accy 84.70:  40%|████      | 8/20 [09:16<12:19, 61.63s/it]SNet: Task 5, Epoch 9/20 => Loss 2.192,  Train_accy 84.70:  45%|████▌     | 9/20 [09:16<11:15, 61.38s/it]SNet: Task 5, Epoch 10/20 => Loss 2.173,  Train_accy 84.96:  45%|████▌     | 9/20 [10:17<11:15, 61.38s/it]SNet: Task 5, Epoch 10/20 => Loss 2.173,  Train_accy 84.96:  50%|█████     | 10/20 [10:17<10:12, 61.22s/it]SNet: Task 5, Epoch 11/20 => Loss 2.177,  Train_accy 83.73, Test_accy 88.32:  50%|█████     | 10/20 [11:22<10:12, 61.22s/it]SNet: Task 5, Epoch 11/20 => Loss 2.177,  Train_accy 83.73, Test_accy 88.32:  55%|█████▌    | 11/20 [11:22<09:21, 62.40s/it]SNet: Task 5, Epoch 12/20 => Loss 2.198,  Train_accy 83.60:  55%|█████▌    | 11/20 [12:22<09:21, 62.40s/it]                 SNet: Task 5, Epoch 12/20 => Loss 2.198,  Train_accy 83.60:  60%|██████    | 12/20 [12:22<08:15, 61.91s/it]SNet: Task 5, Epoch 13/20 => Loss 2.171,  Train_accy 83.60:  60%|██████    | 12/20 [13:23<08:15, 61.91s/it]SNet: Task 5, Epoch 13/20 => Loss 2.171,  Train_accy 83.60:  65%|██████▌   | 13/20 [13:23<07:11, 61.59s/it]SNet: Task 5, Epoch 14/20 => Loss 2.173,  Train_accy 84.05:  65%|██████▌   | 13/20 [14:24<07:11, 61.59s/it]SNet: Task 5, Epoch 14/20 => Loss 2.173,  Train_accy 84.05:  70%|███████   | 14/20 [14:24<06:08, 61.38s/it]SNet: Task 5, Epoch 15/20 => Loss 2.225,  Train_accy 84.31:  70%|███████   | 14/20 [15:25<06:08, 61.38s/it]SNet: Task 5, Epoch 15/20 => Loss 2.225,  Train_accy 84.31:  75%|███████▌  | 15/20 [15:25<05:06, 61.22s/it]SNet: Task 5, Epoch 16/20 => Loss 2.184,  Train_accy 84.44, Test_accy 88.51:  75%|███████▌  | 15/20 [16:30<05:06, 61.22s/it]SNet: Task 5, Epoch 16/20 => Loss 2.184,  Train_accy 84.44, Test_accy 88.51:  80%|████████  | 16/20 [16:30<04:09, 62.35s/it]SNet: Task 5, Epoch 17/20 => Loss 2.203,  Train_accy 83.41:  80%|████████  | 16/20 [17:31<04:09, 62.35s/it]                 SNet: Task 5, Epoch 17/20 => Loss 2.203,  Train_accy 83.41:  85%|████████▌ | 17/20 [17:31<03:05, 61.89s/it]SNet: Task 5, Epoch 18/20 => Loss 2.183,  Train_accy 84.18:  85%|████████▌ | 17/20 [18:32<03:05, 61.89s/it]SNet: Task 5, Epoch 18/20 => Loss 2.183,  Train_accy 84.18:  90%|█████████ | 18/20 [18:32<02:03, 61.58s/it]SNet: Task 5, Epoch 19/20 => Loss 2.179,  Train_accy 85.47:  90%|█████████ | 18/20 [19:33<02:03, 61.58s/it]SNet: Task 5, Epoch 19/20 => Loss 2.179,  Train_accy 85.47:  95%|█████████▌| 19/20 [19:33<01:01, 61.37s/it]SNet: Task 5, Epoch 20/20 => Loss 2.179,  Train_accy 84.64:  95%|█████████▌| 19/20 [20:33<01:01, 61.37s/it]SNet: Task 5, Epoch 20/20 => Loss 2.179,  Train_accy 84.64: 100%|██████████| 20/20 [20:33<00:00, 61.24s/it]SNet: Task 5, Epoch 20/20 => Loss 2.179,  Train_accy 84.64: 100%|██████████| 20/20 [20:33<00:00, 61.70s/it]
2023-10-25 16:38:29,162 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 2.179,  Train_accy 84.64
2023-10-25 16:38:29,162 [foster.py] => do not weight align student!
2023-10-25 16:38:33,368 [foster.py] => darknet eval: 
2023-10-25 16:38:33,368 [foster.py] => CNN top1 curve: 88.51
2023-10-25 16:38:33,368 [foster.py] => CNN top5 curve: 99.06
2023-10-25 16:38:33,371 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 16:39:49,723 [foster.py] => Exemplar size: 1500
2023-10-25 16:39:50,310 [trainer.py] => CNN: {'total': 91.34, '00-09': 89.66, '10-19': 93.26, '20-29': 96.59, '30-39': 94.32, '40-49': 93.26, '50-59': 81.11, 'old': 93.42, 'new': 81.11}
2023-10-25 16:39:50,310 [trainer.py] => NME: {'total': 94.16, '00-09': 88.51, '10-19': 93.26, '20-29': 95.45, '30-39': 96.59, '40-49': 93.26, '50-59': 97.78, 'old': 93.42, 'new': 97.78}
2023-10-25 16:39:50,311 [trainer.py] => CNN top1 curve: [96.55, 90.34, 93.56, 90.06, 90.48, 91.34]
2023-10-25 16:39:50,311 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.43, 99.09, 98.87]
2023-10-25 16:39:50,311 [trainer.py] => NME top1 curve: [97.7, 93.18, 96.21, 92.05, 93.42, 94.16]
2023-10-25 16:39:50,311 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.72, 99.77, 99.62]

Average Accuracy (CNN): 92.055
Average Accuracy (NME): 94.45333333333333
2023-10-25 16:39:50,311 [trainer.py] => Average Accuracy (CNN): 92.055
2023-10-25 16:39:50,311 [trainer.py] => Average Accuracy (NME): 94.45333333333333
2023-10-25 16:39:50,315 [trainer.py] => All params: 105264374
2023-10-25 16:39:50,317 [trainer.py] => Trainable params: 52669662
2023-10-25 16:39:50,876 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 16:39:51,342 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 16:39:52,160 [foster.py] => Learning on 60-70
2023-10-25 16:39:52,165 [foster.py] => All params: 105287444
2023-10-25 16:39:52,168 [foster.py] => Trainable params: 52686962
2023-10-25 16:39:52,202 [foster.py] => per cls weights : [1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986 1.05427986
 0.67432086 0.67432086 0.67432086 0.67432086 0.67432086 0.67432086
 0.67432086 0.67432086 0.67432086 0.67432086]
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 7.719, Loss_clf 0.839, Loss_fe 4.485, Loss_kd 2.052, Train_accy 76.96, Test_accy 85.65:   0%|          | 0/20 [01:08<?, ?it/s]Task 6, Epoch 1/20 => Loss 7.719, Loss_clf 0.839, Loss_fe 4.485, Loss_kd 2.052, Train_accy 76.96, Test_accy 85.65:   5%|▌         | 1/20 [01:08<21:33, 68.09s/it]Task 6, Epoch 2/20 => Loss 7.333, Loss_clf 0.544, Loss_fe 4.413, Loss_kd 2.037, Train_accy 82.08:   5%|▌         | 1/20 [02:07<21:33, 68.09s/it]                 Task 6, Epoch 2/20 => Loss 7.333, Loss_clf 0.544, Loss_fe 4.413, Loss_kd 2.037, Train_accy 82.08:  10%|█         | 2/20 [02:07<18:53, 62.98s/it]Task 6, Epoch 3/20 => Loss 7.314, Loss_clf 0.536, Loss_fe 4.396, Loss_kd 2.041, Train_accy 81.47:  10%|█         | 2/20 [03:06<18:53, 62.98s/it]Task 6, Epoch 3/20 => Loss 7.314, Loss_clf 0.536, Loss_fe 4.396, Loss_kd 2.041, Train_accy 81.47:  15%|█▌        | 3/20 [03:06<17:23, 61.36s/it]Task 6, Epoch 4/20 => Loss 7.266, Loss_clf 0.510, Loss_fe 4.367, Loss_kd 2.049, Train_accy 82.75:  15%|█▌        | 3/20 [04:06<17:23, 61.36s/it]Task 6, Epoch 4/20 => Loss 7.266, Loss_clf 0.510, Loss_fe 4.367, Loss_kd 2.049, Train_accy 82.75:  20%|██        | 4/20 [04:06<16:09, 60.60s/it]Task 6, Epoch 5/20 => Loss 7.166, Loss_clf 0.487, Loss_fe 4.320, Loss_kd 2.022, Train_accy 83.03:  20%|██        | 4/20 [05:05<16:09, 60.60s/it]Task 6, Epoch 5/20 => Loss 7.166, Loss_clf 0.487, Loss_fe 4.320, Loss_kd 2.022, Train_accy 83.03:  25%|██▌       | 5/20 [05:05<15:02, 60.19s/it]Task 6, Epoch 6/20 => Loss 5.726, Loss_clf 0.539, Loss_fe 2.761, Loss_kd 2.080, Train_accy 82.08, Test_accy 87.26:  25%|██▌       | 5/20 [06:13<15:02, 60.19s/it]Task 6, Epoch 6/20 => Loss 5.726, Loss_clf 0.539, Loss_fe 2.761, Loss_kd 2.080, Train_accy 82.08, Test_accy 87.26:  30%|███       | 6/20 [06:13<14:40, 62.90s/it]Task 6, Epoch 7/20 => Loss 4.015, Loss_clf 0.496, Loss_fe 1.125, Loss_kd 2.053, Train_accy 83.70:  30%|███       | 6/20 [07:13<14:40, 62.90s/it]                 Task 6, Epoch 7/20 => Loss 4.015, Loss_clf 0.496, Loss_fe 1.125, Loss_kd 2.053, Train_accy 83.70:  35%|███▌      | 7/20 [07:13<13:23, 61.78s/it]Task 6, Epoch 8/20 => Loss 3.617, Loss_clf 0.460, Loss_fe 0.766, Loss_kd 2.049, Train_accy 84.14:  35%|███▌      | 7/20 [08:13<13:23, 61.78s/it]Task 6, Epoch 8/20 => Loss 3.617, Loss_clf 0.460, Loss_fe 0.766, Loss_kd 2.049, Train_accy 84.14:  40%|████      | 8/20 [08:13<12:12, 61.08s/it]Task 6, Epoch 9/20 => Loss 3.517, Loss_clf 0.458, Loss_fe 0.661, Loss_kd 2.056, Train_accy 84.31:  40%|████      | 8/20 [09:12<12:12, 61.08s/it]Task 6, Epoch 9/20 => Loss 3.517, Loss_clf 0.458, Loss_fe 0.661, Loss_kd 2.056, Train_accy 84.31:  45%|████▌     | 9/20 [09:12<11:06, 60.57s/it]Task 6, Epoch 10/20 => Loss 3.375, Loss_clf 0.434, Loss_fe 0.555, Loss_kd 2.045, Train_accy 85.03:  45%|████▌     | 9/20 [10:11<11:06, 60.57s/it]Task 6, Epoch 10/20 => Loss 3.375, Loss_clf 0.434, Loss_fe 0.555, Loss_kd 2.045, Train_accy 85.03:  50%|█████     | 10/20 [10:11<10:02, 60.23s/it]Task 6, Epoch 11/20 => Loss 3.384, Loss_clf 0.455, Loss_fe 0.542, Loss_kd 2.046, Train_accy 84.97, Test_accy 89.84:  50%|█████     | 10/20 [11:20<10:02, 60.23s/it]Task 6, Epoch 11/20 => Loss 3.384, Loss_clf 0.455, Loss_fe 0.542, Loss_kd 2.046, Train_accy 84.97, Test_accy 89.84:  55%|█████▌    | 11/20 [11:20<09:23, 62.64s/it]Task 6, Epoch 12/20 => Loss 3.336, Loss_clf 0.436, Loss_fe 0.491, Loss_kd 2.065, Train_accy 85.03:  55%|█████▌    | 11/20 [12:19<09:23, 62.64s/it]                 Task 6, Epoch 12/20 => Loss 3.336, Loss_clf 0.436, Loss_fe 0.491, Loss_kd 2.065, Train_accy 85.03:  60%|██████    | 12/20 [12:19<08:13, 61.67s/it]Task 6, Epoch 13/20 => Loss 3.239, Loss_clf 0.420, Loss_fe 0.420, Loss_kd 2.056, Train_accy 85.81:  60%|██████    | 12/20 [13:18<08:13, 61.67s/it]Task 6, Epoch 13/20 => Loss 3.239, Loss_clf 0.420, Loss_fe 0.420, Loss_kd 2.056, Train_accy 85.81:  65%|██████▌   | 13/20 [13:18<07:06, 60.99s/it]Task 6, Epoch 14/20 => Loss 3.137, Loss_clf 0.383, Loss_fe 0.378, Loss_kd 2.036, Train_accy 87.03:  65%|██████▌   | 13/20 [14:18<07:06, 60.99s/it]Task 6, Epoch 14/20 => Loss 3.137, Loss_clf 0.383, Loss_fe 0.378, Loss_kd 2.036, Train_accy 87.03:  70%|███████   | 14/20 [14:18<06:03, 60.54s/it]Task 6, Epoch 15/20 => Loss 3.112, Loss_clf 0.381, Loss_fe 0.359, Loss_kd 2.033, Train_accy 86.76:  70%|███████   | 14/20 [15:17<06:03, 60.54s/it]Task 6, Epoch 15/20 => Loss 3.112, Loss_clf 0.381, Loss_fe 0.359, Loss_kd 2.033, Train_accy 86.76:  75%|███████▌  | 15/20 [15:17<05:01, 60.21s/it]Task 6, Epoch 16/20 => Loss 3.211, Loss_clf 0.405, Loss_fe 0.393, Loss_kd 2.068, Train_accy 85.70, Test_accy 90.32:  75%|███████▌  | 15/20 [16:29<05:01, 60.21s/it]Task 6, Epoch 16/20 => Loss 3.211, Loss_clf 0.405, Loss_fe 0.393, Loss_kd 2.068, Train_accy 85.70, Test_accy 90.32:  80%|████████  | 16/20 [16:29<04:15, 63.75s/it]Task 6, Epoch 17/20 => Loss 3.140, Loss_clf 0.385, Loss_fe 0.353, Loss_kd 2.059, Train_accy 86.76:  80%|████████  | 16/20 [17:29<04:15, 63.75s/it]                 Task 6, Epoch 17/20 => Loss 3.140, Loss_clf 0.385, Loss_fe 0.353, Loss_kd 2.059, Train_accy 86.76:  85%|████████▌ | 17/20 [17:29<03:07, 62.46s/it]Task 6, Epoch 18/20 => Loss 3.077, Loss_clf 0.362, Loss_fe 0.333, Loss_kd 2.042, Train_accy 87.26:  85%|████████▌ | 17/20 [18:28<03:07, 62.46s/it]Task 6, Epoch 18/20 => Loss 3.077, Loss_clf 0.362, Loss_fe 0.333, Loss_kd 2.042, Train_accy 87.26:  90%|█████████ | 18/20 [18:28<02:03, 61.56s/it]Task 6, Epoch 19/20 => Loss 3.070, Loss_clf 0.367, Loss_fe 0.316, Loss_kd 2.046, Train_accy 87.42:  90%|█████████ | 18/20 [19:28<02:03, 61.56s/it]Task 6, Epoch 19/20 => Loss 3.070, Loss_clf 0.367, Loss_fe 0.316, Loss_kd 2.046, Train_accy 87.42:  95%|█████████▌| 19/20 [19:28<01:00, 60.91s/it]Task 6, Epoch 20/20 => Loss 3.075, Loss_clf 0.366, Loss_fe 0.331, Loss_kd 2.039, Train_accy 87.48:  95%|█████████▌| 19/20 [20:27<01:00, 60.91s/it]Task 6, Epoch 20/20 => Loss 3.075, Loss_clf 0.366, Loss_fe 0.331, Loss_kd 2.039, Train_accy 87.48: 100%|██████████| 20/20 [20:27<00:00, 60.46s/it]Task 6, Epoch 20/20 => Loss 3.075, Loss_clf 0.366, Loss_fe 0.331, Loss_kd 2.039, Train_accy 87.48: 100%|██████████| 20/20 [20:27<00:00, 61.38s/it]
2023-10-25 17:00:19,826 [foster.py] => Task 6, Epoch 20/20 => Loss 3.075, Loss_clf 0.366, Loss_fe 0.331, Loss_kd 2.039, Train_accy 87.48
2023-10-25 17:00:21,757 [foster.py] => do not weight align teacher!
2023-10-25 17:00:21,758 [foster.py] => per cls weights : [1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909 1.07147909
 0.57112546 0.57112546 0.57112546 0.57112546 0.57112546 0.57112546
 0.57112546 0.57112546 0.57112546 0.57112546]
2023-10-25 17:00:22,397 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 17:00:22,797 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 6, Epoch 1/20 => Loss 2.335,  Train_accy 75.85, Test_accy 82.90:   0%|          | 0/20 [01:15<?, ?it/s]SNet: Task 6, Epoch 1/20 => Loss 2.335,  Train_accy 75.85, Test_accy 82.90:   5%|▌         | 1/20 [01:15<23:56, 75.59s/it]SNet: Task 6, Epoch 2/20 => Loss 2.294,  Train_accy 79.08:   5%|▌         | 1/20 [02:26<23:56, 75.59s/it]                 SNet: Task 6, Epoch 2/20 => Loss 2.294,  Train_accy 79.08:  10%|█         | 2/20 [02:26<21:46, 72.59s/it]SNet: Task 6, Epoch 3/20 => Loss 2.300,  Train_accy 80.80:  10%|█         | 2/20 [03:36<21:46, 72.59s/it]SNet: Task 6, Epoch 3/20 => Loss 2.300,  Train_accy 80.80:  15%|█▌        | 3/20 [03:36<20:17, 71.64s/it]SNet: Task 6, Epoch 4/20 => Loss 2.273,  Train_accy 83.42:  15%|█▌        | 3/20 [04:47<20:17, 71.64s/it]SNet: Task 6, Epoch 4/20 => Loss 2.273,  Train_accy 83.42:  20%|██        | 4/20 [04:47<18:59, 71.20s/it]SNet: Task 6, Epoch 5/20 => Loss 2.283,  Train_accy 82.30:  20%|██        | 4/20 [05:57<18:59, 71.20s/it]SNet: Task 6, Epoch 5/20 => Loss 2.283,  Train_accy 82.30:  25%|██▌       | 5/20 [05:57<17:44, 70.94s/it]SNet: Task 6, Epoch 6/20 => Loss 2.286,  Train_accy 82.25, Test_accy 87.58:  25%|██▌       | 5/20 [07:12<17:44, 70.94s/it]SNet: Task 6, Epoch 6/20 => Loss 2.286,  Train_accy 82.25, Test_accy 87.58:  30%|███       | 6/20 [07:12<16:54, 72.44s/it]SNet: Task 6, Epoch 7/20 => Loss 2.249,  Train_accy 83.97:  30%|███       | 6/20 [08:23<16:54, 72.44s/it]                 SNet: Task 6, Epoch 7/20 => Loss 2.249,  Train_accy 83.97:  35%|███▌      | 7/20 [08:23<15:33, 71.81s/it]SNet: Task 6, Epoch 8/20 => Loss 2.274,  Train_accy 83.42:  35%|███▌      | 7/20 [09:33<15:33, 71.81s/it]SNet: Task 6, Epoch 8/20 => Loss 2.274,  Train_accy 83.42:  40%|████      | 8/20 [09:33<14:16, 71.40s/it]SNet: Task 6, Epoch 9/20 => Loss 2.271,  Train_accy 83.75:  40%|████      | 8/20 [10:44<14:16, 71.40s/it]SNet: Task 6, Epoch 9/20 => Loss 2.271,  Train_accy 83.75:  45%|████▌     | 9/20 [10:44<13:02, 71.12s/it]SNet: Task 6, Epoch 10/20 => Loss 2.268,  Train_accy 84.25:  45%|████▌     | 9/20 [11:54<13:02, 71.12s/it]SNet: Task 6, Epoch 10/20 => Loss 2.268,  Train_accy 84.25:  50%|█████     | 10/20 [11:54<11:49, 70.91s/it]SNet: Task 6, Epoch 11/20 => Loss 2.267,  Train_accy 83.31, Test_accy 87.90:  50%|█████     | 10/20 [13:10<11:49, 70.91s/it]SNet: Task 6, Epoch 11/20 => Loss 2.267,  Train_accy 83.31, Test_accy 87.90:  55%|█████▌    | 11/20 [13:10<10:50, 72.24s/it]SNet: Task 6, Epoch 12/20 => Loss 2.244,  Train_accy 84.42:  55%|█████▌    | 11/20 [14:20<10:50, 72.24s/it]                 SNet: Task 6, Epoch 12/20 => Loss 2.244,  Train_accy 84.42:  60%|██████    | 12/20 [14:20<09:33, 71.71s/it]SNet: Task 6, Epoch 13/20 => Loss 2.275,  Train_accy 84.42:  60%|██████    | 12/20 [15:31<09:33, 71.71s/it]SNet: Task 6, Epoch 13/20 => Loss 2.275,  Train_accy 84.42:  65%|██████▌   | 13/20 [15:31<08:19, 71.36s/it]SNet: Task 6, Epoch 14/20 => Loss 2.238,  Train_accy 84.36:  65%|██████▌   | 13/20 [16:41<08:19, 71.36s/it]SNet: Task 6, Epoch 14/20 => Loss 2.238,  Train_accy 84.36:  70%|███████   | 14/20 [16:41<07:06, 71.10s/it]SNet: Task 6, Epoch 15/20 => Loss 2.297,  Train_accy 82.80:  70%|███████   | 14/20 [17:52<07:06, 71.10s/it]SNet: Task 6, Epoch 15/20 => Loss 2.297,  Train_accy 82.80:  75%|███████▌  | 15/20 [17:52<05:54, 70.93s/it]SNet: Task 6, Epoch 16/20 => Loss 2.259,  Train_accy 83.64, Test_accy 88.87:  75%|███████▌  | 15/20 [19:07<05:54, 70.93s/it]SNet: Task 6, Epoch 16/20 => Loss 2.259,  Train_accy 83.64, Test_accy 88.87:  80%|████████  | 16/20 [19:07<04:48, 72.23s/it]SNet: Task 6, Epoch 17/20 => Loss 2.247,  Train_accy 84.75:  80%|████████  | 16/20 [20:18<04:48, 72.23s/it]                 SNet: Task 6, Epoch 17/20 => Loss 2.247,  Train_accy 84.75:  85%|████████▌ | 17/20 [20:18<03:35, 71.72s/it]SNet: Task 6, Epoch 18/20 => Loss 2.279,  Train_accy 83.36:  85%|████████▌ | 17/20 [21:28<03:35, 71.72s/it]SNet: Task 6, Epoch 18/20 => Loss 2.279,  Train_accy 83.36:  90%|█████████ | 18/20 [21:28<02:22, 71.36s/it]SNet: Task 6, Epoch 19/20 => Loss 2.244,  Train_accy 84.36:  90%|█████████ | 18/20 [22:39<02:22, 71.36s/it]SNet: Task 6, Epoch 19/20 => Loss 2.244,  Train_accy 84.36:  95%|█████████▌| 19/20 [22:39<01:11, 71.10s/it]SNet: Task 6, Epoch 20/20 => Loss 2.239,  Train_accy 85.03:  95%|█████████▌| 19/20 [23:49<01:11, 71.10s/it]SNet: Task 6, Epoch 20/20 => Loss 2.239,  Train_accy 85.03: 100%|██████████| 20/20 [23:49<00:00, 70.93s/it]SNet: Task 6, Epoch 20/20 => Loss 2.239,  Train_accy 85.03: 100%|██████████| 20/20 [23:49<00:00, 71.48s/it]
2023-10-25 17:24:13,286 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 2.239,  Train_accy 85.03
2023-10-25 17:24:13,289 [foster.py] => do not weight align student!
2023-10-25 17:24:18,046 [foster.py] => darknet eval: 
2023-10-25 17:24:18,046 [foster.py] => CNN top1 curve: 88.87
2023-10-25 17:24:18,046 [foster.py] => CNN top5 curve: 98.55
2023-10-25 17:24:18,048 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 17:25:44,921 [foster.py] => Exemplar size: 1750
2023-10-25 17:25:45,506 [trainer.py] => CNN: {'total': 90.32, '00-09': 88.51, '10-19': 94.38, '20-29': 95.45, '30-39': 95.45, '40-49': 93.26, '50-59': 94.44, '60-69': 70.79, 'old': 93.6, 'new': 70.79}
2023-10-25 17:25:45,506 [trainer.py] => NME: {'total': 92.42, '00-09': 87.36, '10-19': 92.13, '20-29': 94.32, '30-39': 94.32, '40-49': 94.38, '50-59': 94.44, '60-69': 89.89, 'old': 92.84, 'new': 89.89}
2023-10-25 17:25:45,507 [trainer.py] => CNN top1 curve: [96.55, 90.34, 93.56, 90.06, 90.48, 91.34, 90.32]
2023-10-25 17:25:45,507 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.43, 99.09, 98.87, 99.03]
2023-10-25 17:25:45,507 [trainer.py] => NME top1 curve: [97.7, 93.18, 96.21, 92.05, 93.42, 94.16, 92.42]
2023-10-25 17:25:45,507 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.72, 99.77, 99.62, 99.52]

Average Accuracy (CNN): 91.80714285714286
Average Accuracy (NME): 94.16285714285713
2023-10-25 17:25:45,507 [trainer.py] => Average Accuracy (CNN): 91.80714285714286
2023-10-25 17:25:45,507 [trainer.py] => Average Accuracy (NME): 94.16285714285713
2023-10-25 17:25:45,510 [trainer.py] => All params: 105287444
2023-10-25 17:25:45,513 [trainer.py] => Trainable params: 52686962
2023-10-25 17:25:46,057 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 17:25:46,374 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 17:25:47,122 [foster.py] => Learning on 70-80
2023-10-25 17:25:47,127 [foster.py] => All params: 105310514
2023-10-25 17:25:47,130 [foster.py] => Trainable params: 52704262
2023-10-25 17:25:47,164 [foster.py] => per cls weights : [1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479 1.04717479
 1.04717479 1.04717479 1.04717479 1.04717479 0.66977644 0.66977644
 0.66977644 0.66977644 0.66977644 0.66977644 0.66977644 0.66977644
 0.66977644 0.66977644]
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 5.666, Loss_clf 0.790, Loss_fe 2.475, Loss_kd 2.101, Train_accy 75.54, Test_accy 82.82:   0%|          | 0/20 [01:17<?, ?it/s]Task 7, Epoch 1/20 => Loss 5.666, Loss_clf 0.790, Loss_fe 2.475, Loss_kd 2.101, Train_accy 75.54, Test_accy 82.82:   5%|▌         | 1/20 [01:17<24:30, 77.39s/it]Task 7, Epoch 2/20 => Loss 3.937, Loss_clf 0.572, Loss_fe 0.959, Loss_kd 2.106, Train_accy 78.86:   5%|▌         | 1/20 [02:25<24:30, 77.39s/it]                 Task 7, Epoch 2/20 => Loss 3.937, Loss_clf 0.572, Loss_fe 0.959, Loss_kd 2.106, Train_accy 78.86:  10%|█         | 2/20 [02:25<21:29, 71.64s/it]Task 7, Epoch 3/20 => Loss 3.707, Loss_clf 0.538, Loss_fe 0.741, Loss_kd 2.125, Train_accy 81.15:  10%|█         | 2/20 [03:32<21:29, 71.64s/it]Task 7, Epoch 3/20 => Loss 3.707, Loss_clf 0.538, Loss_fe 0.741, Loss_kd 2.125, Train_accy 81.15:  15%|█▌        | 3/20 [03:32<19:46, 69.81s/it]Task 7, Epoch 4/20 => Loss 3.604, Loss_clf 0.519, Loss_fe 0.674, Loss_kd 2.109, Train_accy 81.74:  15%|█▌        | 3/20 [04:40<19:46, 69.81s/it]Task 7, Epoch 4/20 => Loss 3.604, Loss_clf 0.519, Loss_fe 0.674, Loss_kd 2.109, Train_accy 81.74:  20%|██        | 4/20 [04:40<18:23, 68.96s/it]Task 7, Epoch 5/20 => Loss 3.356, Loss_clf 0.434, Loss_fe 0.538, Loss_kd 2.086, Train_accy 83.64:  20%|██        | 4/20 [05:47<18:23, 68.96s/it]Task 7, Epoch 5/20 => Loss 3.356, Loss_clf 0.434, Loss_fe 0.538, Loss_kd 2.086, Train_accy 83.64:  25%|██▌       | 5/20 [05:47<17:07, 68.49s/it]Task 7, Epoch 6/20 => Loss 3.411, Loss_clf 0.451, Loss_fe 0.543, Loss_kd 2.115, Train_accy 83.25, Test_accy 88.03:  25%|██▌       | 5/20 [07:05<17:07, 68.49s/it]Task 7, Epoch 6/20 => Loss 3.411, Loss_clf 0.451, Loss_fe 0.543, Loss_kd 2.115, Train_accy 83.25, Test_accy 88.03:  30%|███       | 6/20 [07:05<16:41, 71.53s/it]Task 7, Epoch 7/20 => Loss 3.335, Loss_clf 0.447, Loss_fe 0.499, Loss_kd 2.090, Train_accy 84.62:  30%|███       | 6/20 [08:13<16:41, 71.53s/it]                 Task 7, Epoch 7/20 => Loss 3.335, Loss_clf 0.447, Loss_fe 0.499, Loss_kd 2.090, Train_accy 84.62:  35%|███▌      | 7/20 [08:13<15:13, 70.26s/it]Task 7, Epoch 8/20 => Loss 3.209, Loss_clf 0.394, Loss_fe 0.438, Loss_kd 2.080, Train_accy 85.74:  35%|███▌      | 7/20 [09:20<15:13, 70.26s/it]Task 7, Epoch 8/20 => Loss 3.209, Loss_clf 0.394, Loss_fe 0.438, Loss_kd 2.080, Train_accy 85.74:  40%|████      | 8/20 [09:20<13:53, 69.43s/it]Task 7, Epoch 9/20 => Loss 3.248, Loss_clf 0.412, Loss_fe 0.430, Loss_kd 2.106, Train_accy 83.98:  40%|████      | 8/20 [10:28<13:53, 69.43s/it]Task 7, Epoch 9/20 => Loss 3.248, Loss_clf 0.412, Loss_fe 0.430, Loss_kd 2.106, Train_accy 83.98:  45%|████▌     | 9/20 [10:28<12:37, 68.87s/it]Task 7, Epoch 10/20 => Loss 3.262, Loss_clf 0.431, Loss_fe 0.422, Loss_kd 2.108, Train_accy 84.57:  45%|████▌     | 9/20 [11:35<12:37, 68.87s/it]Task 7, Epoch 10/20 => Loss 3.262, Loss_clf 0.431, Loss_fe 0.422, Loss_kd 2.108, Train_accy 84.57:  50%|█████     | 10/20 [11:35<11:24, 68.49s/it]Task 7, Epoch 11/20 => Loss 3.222, Loss_clf 0.428, Loss_fe 0.401, Loss_kd 2.093, Train_accy 85.45, Test_accy 88.45:  50%|█████     | 10/20 [12:53<11:24, 68.49s/it]Task 7, Epoch 11/20 => Loss 3.222, Loss_clf 0.428, Loss_fe 0.401, Loss_kd 2.093, Train_accy 85.45, Test_accy 88.45:  55%|█████▌    | 11/20 [12:53<10:41, 71.23s/it]Task 7, Epoch 12/20 => Loss 3.130, Loss_clf 0.386, Loss_fe 0.343, Loss_kd 2.100, Train_accy 85.64:  55%|█████▌    | 11/20 [14:01<10:41, 71.23s/it]                 Task 7, Epoch 12/20 => Loss 3.130, Loss_clf 0.386, Loss_fe 0.343, Loss_kd 2.100, Train_accy 85.64:  60%|██████    | 12/20 [14:01<09:21, 70.13s/it]Task 7, Epoch 13/20 => Loss 3.154, Loss_clf 0.387, Loss_fe 0.352, Loss_kd 2.113, Train_accy 86.08:  60%|██████    | 12/20 [15:08<09:21, 70.13s/it]Task 7, Epoch 13/20 => Loss 3.154, Loss_clf 0.387, Loss_fe 0.352, Loss_kd 2.113, Train_accy 86.08:  65%|██████▌   | 13/20 [15:08<08:05, 69.37s/it]Task 7, Epoch 14/20 => Loss 3.149, Loss_clf 0.397, Loss_fe 0.343, Loss_kd 2.108, Train_accy 86.13:  65%|██████▌   | 13/20 [16:16<08:05, 69.37s/it]Task 7, Epoch 14/20 => Loss 3.149, Loss_clf 0.397, Loss_fe 0.343, Loss_kd 2.108, Train_accy 86.13:  70%|███████   | 14/20 [16:16<06:53, 68.86s/it]Task 7, Epoch 15/20 => Loss 3.002, Loss_clf 0.349, Loss_fe 0.273, Loss_kd 2.083, Train_accy 87.65:  70%|███████   | 14/20 [17:23<06:53, 68.86s/it]Task 7, Epoch 15/20 => Loss 3.002, Loss_clf 0.349, Loss_fe 0.273, Loss_kd 2.083, Train_accy 87.65:  75%|███████▌  | 15/20 [17:23<05:42, 68.49s/it]Task 7, Epoch 16/20 => Loss 3.178, Loss_clf 0.411, Loss_fe 0.339, Loss_kd 2.124, Train_accy 85.30, Test_accy 89.30:  75%|███████▌  | 15/20 [18:41<05:42, 68.49s/it]Task 7, Epoch 16/20 => Loss 3.178, Loss_clf 0.411, Loss_fe 0.339, Loss_kd 2.124, Train_accy 85.30, Test_accy 89.30:  80%|████████  | 16/20 [18:41<04:44, 71.20s/it]Task 7, Epoch 17/20 => Loss 3.049, Loss_clf 0.369, Loss_fe 0.290, Loss_kd 2.091, Train_accy 86.52:  80%|████████  | 16/20 [19:49<04:44, 71.20s/it]                 Task 7, Epoch 17/20 => Loss 3.049, Loss_clf 0.369, Loss_fe 0.290, Loss_kd 2.091, Train_accy 86.52:  85%|████████▌ | 17/20 [19:49<03:30, 70.12s/it]Task 7, Epoch 18/20 => Loss 3.067, Loss_clf 0.365, Loss_fe 0.305, Loss_kd 2.097, Train_accy 87.11:  85%|████████▌ | 17/20 [20:56<03:30, 70.12s/it]Task 7, Epoch 18/20 => Loss 3.067, Loss_clf 0.365, Loss_fe 0.305, Loss_kd 2.097, Train_accy 87.11:  90%|█████████ | 18/20 [20:56<02:18, 69.39s/it]Task 7, Epoch 19/20 => Loss 2.988, Loss_clf 0.338, Loss_fe 0.269, Loss_kd 2.083, Train_accy 88.28:  90%|█████████ | 18/20 [22:04<02:18, 69.39s/it]Task 7, Epoch 19/20 => Loss 2.988, Loss_clf 0.338, Loss_fe 0.269, Loss_kd 2.083, Train_accy 88.28:  95%|█████████▌| 19/20 [22:04<01:08, 68.86s/it]Task 7, Epoch 20/20 => Loss 3.039, Loss_clf 0.352, Loss_fe 0.291, Loss_kd 2.097, Train_accy 87.50:  95%|█████████▌| 19/20 [23:12<01:08, 68.86s/it]Task 7, Epoch 20/20 => Loss 3.039, Loss_clf 0.352, Loss_fe 0.291, Loss_kd 2.097, Train_accy 87.50: 100%|██████████| 20/20 [23:12<00:00, 68.50s/it]Task 7, Epoch 20/20 => Loss 3.039, Loss_clf 0.352, Loss_fe 0.291, Loss_kd 2.097, Train_accy 87.50: 100%|██████████| 20/20 [23:12<00:00, 69.60s/it]
2023-10-25 17:48:59,214 [foster.py] => Task 7, Epoch 20/20 => Loss 3.039, Loss_clf 0.352, Loss_fe 0.291, Loss_kd 2.097, Train_accy 87.50
2023-10-25 17:48:59,219 [foster.py] => do not weight align teacher!
2023-10-25 17:48:59,220 [foster.py] => per cls weights : [1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033 1.06199033
 1.06199033 1.06199033 1.06199033 1.06199033 0.56606771 0.56606771
 0.56606771 0.56606771 0.56606771 0.56606771 0.56606771 0.56606771
 0.56606771 0.56606771]
2023-10-25 17:48:59,839 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 17:49:00,310 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 7, Epoch 1/20 => Loss 2.357,  Train_accy 73.97, Test_accy 80.00:   0%|          | 0/20 [01:25<?, ?it/s]SNet: Task 7, Epoch 1/20 => Loss 2.357,  Train_accy 73.97, Test_accy 80.00:   5%|▌         | 1/20 [01:25<27:06, 85.61s/it]SNet: Task 7, Epoch 2/20 => Loss 2.308,  Train_accy 75.34:   5%|▌         | 1/20 [02:45<27:06, 85.61s/it]                 SNet: Task 7, Epoch 2/20 => Loss 2.308,  Train_accy 75.34:  10%|█         | 2/20 [02:45<24:44, 82.45s/it]SNet: Task 7, Epoch 3/20 => Loss 2.288,  Train_accy 77.44:  10%|█         | 2/20 [04:06<24:44, 82.45s/it]SNet: Task 7, Epoch 3/20 => Loss 2.288,  Train_accy 77.44:  15%|█▌        | 3/20 [04:06<23:04, 81.42s/it]SNet: Task 7, Epoch 4/20 => Loss 2.297,  Train_accy 77.59:  15%|█▌        | 3/20 [05:26<23:04, 81.42s/it]SNet: Task 7, Epoch 4/20 => Loss 2.297,  Train_accy 77.59:  20%|██        | 4/20 [05:26<21:35, 80.95s/it]SNet: Task 7, Epoch 5/20 => Loss 2.299,  Train_accy 78.47:  20%|██        | 4/20 [06:46<21:35, 80.95s/it]SNet: Task 7, Epoch 5/20 => Loss 2.299,  Train_accy 78.47:  25%|██▌       | 5/20 [06:46<20:10, 80.70s/it]SNet: Task 7, Epoch 6/20 => Loss 2.284,  Train_accy 79.05, Test_accy 84.65:  25%|██▌       | 5/20 [08:12<20:10, 80.70s/it]SNet: Task 7, Epoch 6/20 => Loss 2.284,  Train_accy 79.05, Test_accy 84.65:  30%|███       | 6/20 [08:12<19:13, 82.36s/it]SNet: Task 7, Epoch 7/20 => Loss 2.268,  Train_accy 80.66:  30%|███       | 6/20 [09:32<19:13, 82.36s/it]                 SNet: Task 7, Epoch 7/20 => Loss 2.268,  Train_accy 80.66:  35%|███▌      | 7/20 [09:32<17:41, 81.67s/it]SNet: Task 7, Epoch 8/20 => Loss 2.280,  Train_accy 80.03:  35%|███▌      | 7/20 [10:52<17:41, 81.67s/it]SNet: Task 7, Epoch 8/20 => Loss 2.280,  Train_accy 80.03:  40%|████      | 8/20 [10:52<16:14, 81.20s/it]SNet: Task 7, Epoch 9/20 => Loss 2.255,  Train_accy 80.18:  40%|████      | 8/20 [12:12<16:14, 81.20s/it]SNet: Task 7, Epoch 9/20 => Loss 2.255,  Train_accy 80.18:  45%|████▌     | 9/20 [12:12<14:49, 80.89s/it]SNet: Task 7, Epoch 10/20 => Loss 2.254,  Train_accy 81.05:  45%|████▌     | 9/20 [13:33<14:49, 80.89s/it]SNet: Task 7, Epoch 10/20 => Loss 2.254,  Train_accy 81.05:  50%|█████     | 10/20 [13:33<13:27, 80.72s/it]SNet: Task 7, Epoch 11/20 => Loss 2.270,  Train_accy 80.37, Test_accy 85.49:  50%|█████     | 10/20 [14:58<13:27, 80.72s/it]SNet: Task 7, Epoch 11/20 => Loss 2.270,  Train_accy 80.37, Test_accy 85.49:  55%|█████▌    | 11/20 [14:58<12:20, 82.24s/it]SNet: Task 7, Epoch 12/20 => Loss 2.245,  Train_accy 81.10:  55%|█████▌    | 11/20 [16:19<12:20, 82.24s/it]                 SNet: Task 7, Epoch 12/20 => Loss 2.245,  Train_accy 81.10:  60%|██████    | 12/20 [16:19<10:53, 81.63s/it]SNet: Task 7, Epoch 13/20 => Loss 2.252,  Train_accy 82.08:  60%|██████    | 12/20 [17:39<10:53, 81.63s/it]SNet: Task 7, Epoch 13/20 => Loss 2.252,  Train_accy 82.08:  65%|██████▌   | 13/20 [17:39<09:28, 81.25s/it]SNet: Task 7, Epoch 14/20 => Loss 2.262,  Train_accy 81.88:  65%|██████▌   | 13/20 [18:59<09:28, 81.25s/it]SNet: Task 7, Epoch 14/20 => Loss 2.262,  Train_accy 81.88:  70%|███████   | 14/20 [18:59<08:05, 80.95s/it]SNet: Task 7, Epoch 15/20 => Loss 2.269,  Train_accy 79.93:  70%|███████   | 14/20 [20:19<08:05, 80.95s/it]SNet: Task 7, Epoch 15/20 => Loss 2.269,  Train_accy 79.93:  75%|███████▌  | 15/20 [20:19<06:43, 80.75s/it]SNet: Task 7, Epoch 16/20 => Loss 2.264,  Train_accy 81.69, Test_accy 85.21:  75%|███████▌  | 15/20 [21:45<06:43, 80.75s/it]SNet: Task 7, Epoch 16/20 => Loss 2.264,  Train_accy 81.69, Test_accy 85.21:  80%|████████  | 16/20 [21:45<05:28, 82.23s/it]SNet: Task 7, Epoch 17/20 => Loss 2.254,  Train_accy 80.66:  80%|████████  | 16/20 [23:05<05:28, 82.23s/it]                 SNet: Task 7, Epoch 17/20 => Loss 2.254,  Train_accy 80.66:  85%|████████▌ | 17/20 [23:05<04:04, 81.63s/it]SNet: Task 7, Epoch 18/20 => Loss 2.256,  Train_accy 81.64:  85%|████████▌ | 17/20 [24:26<04:04, 81.63s/it]SNet: Task 7, Epoch 18/20 => Loss 2.256,  Train_accy 81.64:  90%|█████████ | 18/20 [24:26<02:42, 81.20s/it]SNet: Task 7, Epoch 19/20 => Loss 2.262,  Train_accy 81.49:  90%|█████████ | 18/20 [25:46<02:42, 81.20s/it]SNet: Task 7, Epoch 19/20 => Loss 2.262,  Train_accy 81.49:  95%|█████████▌| 19/20 [25:46<01:20, 80.91s/it]SNet: Task 7, Epoch 20/20 => Loss 2.272,  Train_accy 80.37:  95%|█████████▌| 19/20 [27:06<01:20, 80.91s/it]SNet: Task 7, Epoch 20/20 => Loss 2.272,  Train_accy 80.37: 100%|██████████| 20/20 [27:06<00:00, 80.70s/it]SNet: Task 7, Epoch 20/20 => Loss 2.272,  Train_accy 80.37: 100%|██████████| 20/20 [27:06<00:00, 81.32s/it]
2023-10-25 18:16:08,047 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 2.272,  Train_accy 80.37
2023-10-25 18:16:08,048 [foster.py] => do not weight align student!
2023-10-25 18:16:13,453 [foster.py] => darknet eval: 
2023-10-25 18:16:13,453 [foster.py] => CNN top1 curve: 85.35
2023-10-25 18:16:13,453 [foster.py] => CNN top5 curve: 98.73
2023-10-25 18:16:13,455 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 18:17:52,789 [foster.py] => Exemplar size: 2000
2023-10-25 18:17:53,382 [trainer.py] => CNN: {'total': 89.44, '00-09': 86.21, '10-19': 93.26, '20-29': 96.59, '30-39': 94.32, '40-49': 93.26, '50-59': 96.67, '60-69': 86.52, '70-79': 68.89, 'old': 92.42, 'new': 68.89}
2023-10-25 18:17:53,382 [trainer.py] => NME: {'total': 93.94, '00-09': 88.51, '10-19': 92.13, '20-29': 96.59, '30-39': 96.59, '40-49': 93.26, '50-59': 96.67, '60-69': 92.13, '70-79': 95.56, 'old': 93.71, 'new': 95.56}
2023-10-25 18:17:53,382 [trainer.py] => CNN top1 curve: [96.55, 90.34, 93.56, 90.06, 90.48, 91.34, 90.32, 89.44]
2023-10-25 18:17:53,382 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.43, 99.09, 98.87, 99.03, 99.15]
2023-10-25 18:17:53,382 [trainer.py] => NME top1 curve: [97.7, 93.18, 96.21, 92.05, 93.42, 94.16, 92.42, 93.94]
2023-10-25 18:17:53,382 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.72, 99.77, 99.62, 99.52, 99.44]

Average Accuracy (CNN): 91.51125000000002
Average Accuracy (NME): 94.13499999999999
2023-10-25 18:17:53,382 [trainer.py] => Average Accuracy (CNN): 91.51125000000002
2023-10-25 18:17:53,382 [trainer.py] => Average Accuracy (NME): 94.13499999999999
2023-10-25 18:17:53,386 [trainer.py] => All params: 105310514
2023-10-25 18:17:53,389 [trainer.py] => Trainable params: 52704262
2023-10-25 18:17:53,960 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 18:17:54,339 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 18:17:54,922 [foster.py] => Learning on 80-90
2023-10-25 18:17:54,928 [foster.py] => All params: 105333584
2023-10-25 18:17:54,931 [foster.py] => Trainable params: 52721562
2023-10-25 18:17:54,964 [foster.py] => per cls weights : [1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  1.0417145  1.0417145  1.0417145  1.0417145
 1.0417145  1.0417145  0.66628401 0.66628401 0.66628401 0.66628401
 0.66628401 0.66628401 0.66628401 0.66628401 0.66628401 0.66628401]
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 5.583, Loss_clf 0.695, Loss_fe 2.459, Loss_kd 2.159, Train_accy 78.76, Test_accy 85.95:   0%|          | 0/20 [01:26<?, ?it/s]Task 8, Epoch 1/20 => Loss 5.583, Loss_clf 0.695, Loss_fe 2.459, Loss_kd 2.159, Train_accy 78.76, Test_accy 85.95:   5%|▌         | 1/20 [01:26<27:26, 86.65s/it]Task 8, Epoch 2/20 => Loss 3.892, Loss_clf 0.509, Loss_fe 0.942, Loss_kd 2.170, Train_accy 82.90:   5%|▌         | 1/20 [02:42<27:26, 86.65s/it]                 Task 8, Epoch 2/20 => Loss 3.892, Loss_clf 0.509, Loss_fe 0.942, Loss_kd 2.170, Train_accy 82.90:  10%|█         | 2/20 [02:42<24:04, 80.24s/it]Task 8, Epoch 3/20 => Loss 3.714, Loss_clf 0.486, Loss_fe 0.779, Loss_kd 2.176, Train_accy 83.60:  10%|█         | 2/20 [03:58<24:04, 80.24s/it]Task 8, Epoch 3/20 => Loss 3.714, Loss_clf 0.486, Loss_fe 0.779, Loss_kd 2.176, Train_accy 83.60:  15%|█▌        | 3/20 [03:58<22:08, 78.14s/it]Task 8, Epoch 4/20 => Loss 3.588, Loss_clf 0.473, Loss_fe 0.685, Loss_kd 2.159, Train_accy 83.17:  15%|█▌        | 3/20 [05:13<22:08, 78.14s/it]Task 8, Epoch 4/20 => Loss 3.588, Loss_clf 0.473, Loss_fe 0.685, Loss_kd 2.159, Train_accy 83.17:  20%|██        | 4/20 [05:13<20:35, 77.19s/it]Task 8, Epoch 5/20 => Loss 3.532, Loss_clf 0.465, Loss_fe 0.636, Loss_kd 2.161, Train_accy 84.34:  20%|██        | 4/20 [06:29<20:35, 77.19s/it]Task 8, Epoch 5/20 => Loss 3.532, Loss_clf 0.465, Loss_fe 0.636, Loss_kd 2.161, Train_accy 84.34:  25%|██▌       | 5/20 [06:29<19:10, 76.67s/it]Task 8, Epoch 6/20 => Loss 3.489, Loss_clf 0.463, Loss_fe 0.585, Loss_kd 2.170, Train_accy 84.65, Test_accy 88.08:  25%|██▌       | 5/20 [07:56<19:10, 76.67s/it]Task 8, Epoch 6/20 => Loss 3.489, Loss_clf 0.463, Loss_fe 0.585, Loss_kd 2.170, Train_accy 84.65, Test_accy 88.08:  30%|███       | 6/20 [07:56<18:40, 80.05s/it]Task 8, Epoch 7/20 => Loss 3.394, Loss_clf 0.438, Loss_fe 0.515, Loss_kd 2.169, Train_accy 84.21:  30%|███       | 6/20 [09:11<18:40, 80.05s/it]                 Task 8, Epoch 7/20 => Loss 3.394, Loss_clf 0.438, Loss_fe 0.515, Loss_kd 2.169, Train_accy 84.21:  35%|███▌      | 7/20 [09:11<17:02, 78.63s/it]Task 8, Epoch 8/20 => Loss 3.330, Loss_clf 0.419, Loss_fe 0.465, Loss_kd 2.174, Train_accy 85.78:  35%|███▌      | 7/20 [10:27<17:02, 78.63s/it]Task 8, Epoch 8/20 => Loss 3.330, Loss_clf 0.419, Loss_fe 0.465, Loss_kd 2.174, Train_accy 85.78:  40%|████      | 8/20 [10:27<15:32, 77.70s/it]Task 8, Epoch 9/20 => Loss 3.274, Loss_clf 0.417, Loss_fe 0.434, Loss_kd 2.154, Train_accy 85.91:  40%|████      | 8/20 [11:43<15:32, 77.70s/it]Task 8, Epoch 9/20 => Loss 3.274, Loss_clf 0.417, Loss_fe 0.434, Loss_kd 2.154, Train_accy 85.91:  45%|████▌     | 9/20 [11:43<14:07, 77.07s/it]Task 8, Epoch 10/20 => Loss 3.214, Loss_clf 0.383, Loss_fe 0.401, Loss_kd 2.160, Train_accy 87.13:  45%|████▌     | 9/20 [12:58<14:07, 77.07s/it]Task 8, Epoch 10/20 => Loss 3.214, Loss_clf 0.383, Loss_fe 0.401, Loss_kd 2.160, Train_accy 87.13:  50%|█████     | 10/20 [12:58<12:46, 76.64s/it]Task 8, Epoch 11/20 => Loss 3.311, Loss_clf 0.433, Loss_fe 0.422, Loss_kd 2.184, Train_accy 85.43, Test_accy 90.21:  50%|█████     | 10/20 [14:25<12:46, 76.64s/it]Task 8, Epoch 11/20 => Loss 3.311, Loss_clf 0.433, Loss_fe 0.422, Loss_kd 2.184, Train_accy 85.43, Test_accy 90.21:  55%|█████▌    | 11/20 [14:25<11:57, 79.68s/it]Task 8, Epoch 12/20 => Loss 3.209, Loss_clf 0.402, Loss_fe 0.380, Loss_kd 2.157, Train_accy 86.31:  55%|█████▌    | 11/20 [15:41<11:57, 79.68s/it]                 Task 8, Epoch 12/20 => Loss 3.209, Loss_clf 0.402, Loss_fe 0.380, Loss_kd 2.157, Train_accy 86.31:  60%|██████    | 12/20 [15:41<10:27, 78.47s/it]Task 8, Epoch 13/20 => Loss 3.125, Loss_clf 0.378, Loss_fe 0.341, Loss_kd 2.138, Train_accy 88.01:  60%|██████    | 12/20 [16:56<10:27, 78.47s/it]Task 8, Epoch 13/20 => Loss 3.125, Loss_clf 0.378, Loss_fe 0.341, Loss_kd 2.138, Train_accy 88.01:  65%|██████▌   | 13/20 [16:56<09:03, 77.64s/it]Task 8, Epoch 14/20 => Loss 3.235, Loss_clf 0.409, Loss_fe 0.381, Loss_kd 2.173, Train_accy 86.87:  65%|██████▌   | 13/20 [18:12<09:03, 77.64s/it]Task 8, Epoch 14/20 => Loss 3.235, Loss_clf 0.409, Loss_fe 0.381, Loss_kd 2.173, Train_accy 86.87:  70%|███████   | 14/20 [18:12<07:42, 77.06s/it]Task 8, Epoch 15/20 => Loss 3.068, Loss_clf 0.358, Loss_fe 0.305, Loss_kd 2.138, Train_accy 87.61:  70%|███████   | 14/20 [19:28<07:42, 77.06s/it]Task 8, Epoch 15/20 => Loss 3.068, Loss_clf 0.358, Loss_fe 0.305, Loss_kd 2.138, Train_accy 87.61:  75%|███████▌  | 15/20 [19:28<06:23, 76.63s/it]Task 8, Epoch 16/20 => Loss 3.154, Loss_clf 0.386, Loss_fe 0.332, Loss_kd 2.166, Train_accy 87.09, Test_accy 89.96:  75%|███████▌  | 15/20 [20:54<06:23, 76.63s/it]Task 8, Epoch 16/20 => Loss 3.154, Loss_clf 0.386, Loss_fe 0.332, Loss_kd 2.166, Train_accy 87.09, Test_accy 89.96:  80%|████████  | 16/20 [20:54<05:18, 79.63s/it]Task 8, Epoch 17/20 => Loss 3.099, Loss_clf 0.370, Loss_fe 0.307, Loss_kd 2.153, Train_accy 87.75:  80%|████████  | 16/20 [23:16<05:18, 79.63s/it]                 Task 8, Epoch 17/20 => Loss 3.099, Loss_clf 0.370, Loss_fe 0.307, Loss_kd 2.153, Train_accy 87.75:  85%|████████▌ | 17/20 [23:16<04:54, 98.25s/it]Task 8, Epoch 18/20 => Loss 3.132, Loss_clf 0.378, Loss_fe 0.306, Loss_kd 2.176, Train_accy 88.84:  85%|████████▌ | 17/20 [24:32<04:54, 98.25s/it]Task 8, Epoch 18/20 => Loss 3.132, Loss_clf 0.378, Loss_fe 0.306, Loss_kd 2.176, Train_accy 88.84:  90%|█████████ | 18/20 [24:32<03:02, 91.48s/it]Task 8, Epoch 19/20 => Loss 3.085, Loss_clf 0.365, Loss_fe 0.292, Loss_kd 2.159, Train_accy 89.14:  90%|█████████ | 18/20 [25:47<03:02, 91.48s/it]Task 8, Epoch 19/20 => Loss 3.085, Loss_clf 0.365, Loss_fe 0.292, Loss_kd 2.159, Train_accy 89.14:  95%|█████████▌| 19/20 [25:47<01:26, 86.73s/it]Task 8, Epoch 20/20 => Loss 3.040, Loss_clf 0.340, Loss_fe 0.278, Loss_kd 2.153, Train_accy 88.92:  95%|█████████▌| 19/20 [27:03<01:26, 86.73s/it]Task 8, Epoch 20/20 => Loss 3.040, Loss_clf 0.340, Loss_fe 0.278, Loss_kd 2.153, Train_accy 88.92: 100%|██████████| 20/20 [27:03<00:00, 83.41s/it]Task 8, Epoch 20/20 => Loss 3.040, Loss_clf 0.340, Loss_fe 0.278, Loss_kd 2.153, Train_accy 88.92: 100%|██████████| 20/20 [27:03<00:00, 81.17s/it]
2023-10-25 18:44:58,437 [foster.py] => Task 8, Epoch 20/20 => Loss 3.040, Loss_clf 0.340, Loss_fe 0.278, Loss_kd 2.153, Train_accy 88.92
2023-10-25 18:44:58,439 [foster.py] => do not weight align teacher!
2023-10-25 18:44:58,440 [foster.py] => per cls weights : [1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557 1.05472557
 1.05472557 1.05472557 0.56219541 0.56219541 0.56219541 0.56219541
 0.56219541 0.56219541 0.56219541 0.56219541 0.56219541 0.56219541]
2023-10-25 18:44:59,074 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 18:44:59,907 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 8, Epoch 1/20 => Loss 2.352,  Train_accy 76.14, Test_accy 82.06:   0%|          | 0/20 [01:35<?, ?it/s]SNet: Task 8, Epoch 1/20 => Loss 2.352,  Train_accy 76.14, Test_accy 82.06:   5%|▌         | 1/20 [01:35<30:20, 95.82s/it]SNet: Task 8, Epoch 2/20 => Loss 2.302,  Train_accy 78.46:   5%|▌         | 1/20 [03:05<30:20, 95.82s/it]                 SNet: Task 8, Epoch 2/20 => Loss 2.302,  Train_accy 78.46:  10%|█         | 2/20 [03:05<27:40, 92.26s/it]SNet: Task 8, Epoch 3/20 => Loss 2.326,  Train_accy 79.24:  10%|█         | 2/20 [04:35<27:40, 92.26s/it]SNet: Task 8, Epoch 3/20 => Loss 2.326,  Train_accy 79.24:  15%|█▌        | 3/20 [04:35<25:49, 91.13s/it]SNet: Task 8, Epoch 4/20 => Loss 2.316,  Train_accy 80.51:  15%|█▌        | 3/20 [06:05<25:49, 91.13s/it]SNet: Task 8, Epoch 4/20 => Loss 2.316,  Train_accy 80.51:  20%|██        | 4/20 [06:05<24:09, 90.59s/it]SNet: Task 8, Epoch 5/20 => Loss 2.288,  Train_accy 82.03:  20%|██        | 4/20 [07:34<24:09, 90.59s/it]SNet: Task 8, Epoch 5/20 => Loss 2.288,  Train_accy 82.03:  25%|██▌       | 5/20 [07:34<22:34, 90.29s/it]SNet: Task 8, Epoch 6/20 => Loss 2.290,  Train_accy 81.51, Test_accy 86.20:  25%|██▌       | 5/20 [09:10<22:34, 90.29s/it]SNet: Task 8, Epoch 6/20 => Loss 2.290,  Train_accy 81.51, Test_accy 86.20:  30%|███       | 6/20 [09:10<21:30, 92.18s/it]SNet: Task 8, Epoch 7/20 => Loss 2.299,  Train_accy 82.77:  30%|███       | 6/20 [10:40<21:30, 92.18s/it]                 SNet: Task 8, Epoch 7/20 => Loss 2.299,  Train_accy 82.77:  35%|███▌      | 7/20 [10:40<19:48, 91.40s/it]SNet: Task 8, Epoch 8/20 => Loss 2.288,  Train_accy 82.42:  35%|███▌      | 7/20 [12:10<19:48, 91.40s/it]SNet: Task 8, Epoch 8/20 => Loss 2.288,  Train_accy 82.42:  40%|████      | 8/20 [12:10<18:10, 90.88s/it]SNet: Task 8, Epoch 9/20 => Loss 2.281,  Train_accy 82.86:  40%|████      | 8/20 [13:40<18:10, 90.88s/it]SNet: Task 8, Epoch 9/20 => Loss 2.281,  Train_accy 82.86:  45%|████▌     | 9/20 [13:40<16:35, 90.54s/it]SNet: Task 8, Epoch 10/20 => Loss 2.278,  Train_accy 83.78:  45%|████▌     | 9/20 [15:09<16:35, 90.54s/it]SNet: Task 8, Epoch 10/20 => Loss 2.278,  Train_accy 83.78:  50%|█████     | 10/20 [15:09<15:03, 90.30s/it]SNet: Task 8, Epoch 11/20 => Loss 2.308,  Train_accy 83.60, Test_accy 86.70:  50%|█████     | 10/20 [16:45<15:03, 90.30s/it]SNet: Task 8, Epoch 11/20 => Loss 2.308,  Train_accy 83.60, Test_accy 86.70:  55%|█████▌    | 11/20 [16:45<13:47, 91.96s/it]SNet: Task 8, Epoch 12/20 => Loss 2.281,  Train_accy 83.65:  55%|█████▌    | 11/20 [18:15<13:47, 91.96s/it]                 SNet: Task 8, Epoch 12/20 => Loss 2.281,  Train_accy 83.65:  60%|██████    | 12/20 [18:15<12:10, 91.29s/it]SNet: Task 8, Epoch 13/20 => Loss 2.295,  Train_accy 83.12:  60%|██████    | 12/20 [19:45<12:10, 91.29s/it]SNet: Task 8, Epoch 13/20 => Loss 2.295,  Train_accy 83.12:  65%|██████▌   | 13/20 [19:45<10:35, 90.84s/it]SNet: Task 8, Epoch 14/20 => Loss 2.284,  Train_accy 83.86:  65%|██████▌   | 13/20 [21:14<10:35, 90.84s/it]SNet: Task 8, Epoch 14/20 => Loss 2.284,  Train_accy 83.86:  70%|███████   | 14/20 [21:14<09:03, 90.53s/it]SNet: Task 8, Epoch 15/20 => Loss 2.279,  Train_accy 83.52:  70%|███████   | 14/20 [22:44<09:03, 90.53s/it]SNet: Task 8, Epoch 15/20 => Loss 2.279,  Train_accy 83.52:  75%|███████▌  | 15/20 [22:44<07:31, 90.29s/it]SNet: Task 8, Epoch 16/20 => Loss 2.259,  Train_accy 84.65, Test_accy 86.70:  75%|███████▌  | 15/20 [24:20<07:31, 90.29s/it]SNet: Task 8, Epoch 16/20 => Loss 2.259,  Train_accy 84.65, Test_accy 86.70:  80%|████████  | 16/20 [24:20<06:07, 91.98s/it]SNet: Task 8, Epoch 17/20 => Loss 2.275,  Train_accy 84.39:  80%|████████  | 16/20 [25:50<06:07, 91.98s/it]                 SNet: Task 8, Epoch 17/20 => Loss 2.275,  Train_accy 84.39:  85%|████████▌ | 17/20 [25:50<04:33, 91.31s/it]SNet: Task 8, Epoch 18/20 => Loss 2.294,  Train_accy 83.17:  85%|████████▌ | 17/20 [27:20<04:33, 91.31s/it]SNet: Task 8, Epoch 18/20 => Loss 2.294,  Train_accy 83.17:  90%|█████████ | 18/20 [27:20<03:01, 90.84s/it]SNet: Task 8, Epoch 19/20 => Loss 2.257,  Train_accy 85.04:  90%|█████████ | 18/20 [28:49<03:01, 90.84s/it]SNet: Task 8, Epoch 19/20 => Loss 2.257,  Train_accy 85.04:  95%|█████████▌| 19/20 [28:49<01:30, 90.53s/it]SNet: Task 8, Epoch 20/20 => Loss 2.291,  Train_accy 83.65:  95%|█████████▌| 19/20 [30:19<01:30, 90.53s/it]SNet: Task 8, Epoch 20/20 => Loss 2.291,  Train_accy 83.65: 100%|██████████| 20/20 [30:19<00:00, 90.31s/it]SNet: Task 8, Epoch 20/20 => Loss 2.291,  Train_accy 83.65: 100%|██████████| 20/20 [30:19<00:00, 90.99s/it]
2023-10-25 19:15:19,713 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 2.291,  Train_accy 83.65
2023-10-25 19:15:19,714 [foster.py] => do not weight align student!
2023-10-25 19:15:25,688 [foster.py] => darknet eval: 
2023-10-25 19:15:25,688 [foster.py] => CNN top1 curve: 87.08
2023-10-25 19:15:25,688 [foster.py] => CNN top5 curve: 99.12
2023-10-25 19:15:25,691 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 19:17:17,303 [foster.py] => Exemplar size: 2250
2023-10-25 19:17:17,898 [trainer.py] => CNN: {'total': 89.59, '00-09': 85.06, '10-19': 92.13, '20-29': 95.45, '30-39': 94.32, '40-49': 95.51, '50-59': 94.44, '60-69': 85.39, '70-79': 90.0, '80-89': 73.56, 'old': 91.55, 'new': 73.56}
2023-10-25 19:17:17,899 [trainer.py] => NME: {'total': 93.6, '00-09': 88.51, '10-19': 92.13, '20-29': 96.59, '30-39': 93.18, '40-49': 94.38, '50-59': 94.44, '60-69': 88.76, '70-79': 95.56, '80-89': 98.85, 'old': 92.96, 'new': 98.85}
2023-10-25 19:17:17,899 [trainer.py] => CNN top1 curve: [96.55, 90.34, 93.56, 90.06, 90.48, 91.34, 90.32, 89.44, 89.59]
2023-10-25 19:17:17,899 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.43, 99.09, 98.87, 99.03, 99.15, 99.5]
2023-10-25 19:17:17,899 [trainer.py] => NME top1 curve: [97.7, 93.18, 96.21, 92.05, 93.42, 94.16, 92.42, 93.94, 93.6]
2023-10-25 19:17:17,899 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.72, 99.77, 99.62, 99.52, 99.44, 99.25]

Average Accuracy (CNN): 91.2977777777778
Average Accuracy (NME): 94.07555555555555
2023-10-25 19:17:17,899 [trainer.py] => Average Accuracy (CNN): 91.2977777777778
2023-10-25 19:17:17,899 [trainer.py] => Average Accuracy (NME): 94.07555555555555
2023-10-25 19:17:17,903 [trainer.py] => All params: 105333584
2023-10-25 19:17:17,906 [trainer.py] => Trainable params: 52721562
2023-10-25 19:17:18,526 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 19:17:18,908 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 19:17:19,650 [foster.py] => Learning on 90-100
2023-10-25 19:17:19,656 [foster.py] => All params: 105356654
2023-10-25 19:17:19,659 [foster.py] => Trainable params: 52738862
2023-10-25 19:17:19,692 [foster.py] => per cls weights : [1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709 1.03738709
 0.66351619 0.66351619 0.66351619 0.66351619 0.66351619 0.66351619
 0.66351619 0.66351619 0.66351619 0.66351619]
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 5.261, Loss_clf 0.739, Loss_fe 2.105, Loss_kd 2.175, Train_accy 78.61, Test_accy 87.25:   0%|          | 0/20 [01:36<?, ?it/s]Task 9, Epoch 1/20 => Loss 5.261, Loss_clf 0.739, Loss_fe 2.105, Loss_kd 2.175, Train_accy 78.61, Test_accy 87.25:   5%|▌         | 1/20 [01:36<30:25, 96.09s/it]Task 9, Epoch 2/20 => Loss 3.863, Loss_clf 0.538, Loss_fe 0.906, Loss_kd 2.177, Train_accy 82.34:   5%|▌         | 1/20 [03:00<30:25, 96.09s/it]                 Task 9, Epoch 2/20 => Loss 3.863, Loss_clf 0.538, Loss_fe 0.906, Loss_kd 2.177, Train_accy 82.34:  10%|█         | 2/20 [03:00<26:43, 89.07s/it]Task 9, Epoch 3/20 => Loss 3.696, Loss_clf 0.524, Loss_fe 0.747, Loss_kd 2.182, Train_accy 82.69:  10%|█         | 2/20 [04:24<26:43, 89.07s/it]Task 9, Epoch 3/20 => Loss 3.696, Loss_clf 0.524, Loss_fe 0.747, Loss_kd 2.182, Train_accy 82.69:  15%|█▌        | 3/20 [04:24<24:36, 86.85s/it]Task 9, Epoch 4/20 => Loss 3.573, Loss_clf 0.475, Loss_fe 0.676, Loss_kd 2.180, Train_accy 83.95:  15%|█▌        | 3/20 [05:48<24:36, 86.85s/it]Task 9, Epoch 4/20 => Loss 3.573, Loss_clf 0.475, Loss_fe 0.676, Loss_kd 2.180, Train_accy 83.95:  20%|██        | 4/20 [05:48<22:52, 85.80s/it]Task 9, Epoch 5/20 => Loss 3.516, Loss_clf 0.480, Loss_fe 0.626, Loss_kd 2.169, Train_accy 84.42:  20%|██        | 4/20 [07:12<22:52, 85.80s/it]Task 9, Epoch 5/20 => Loss 3.516, Loss_clf 0.480, Loss_fe 0.626, Loss_kd 2.169, Train_accy 84.42:  25%|██▌       | 5/20 [07:12<21:18, 85.21s/it]Task 9, Epoch 6/20 => Loss 3.278, Loss_clf 0.395, Loss_fe 0.486, Loss_kd 2.157, Train_accy 85.83, Test_accy 88.94:  25%|██▌       | 5/20 [08:49<21:18, 85.21s/it]Task 9, Epoch 6/20 => Loss 3.278, Loss_clf 0.395, Loss_fe 0.486, Loss_kd 2.157, Train_accy 85.83, Test_accy 88.94:  30%|███       | 6/20 [08:49<20:48, 89.15s/it]Task 9, Epoch 7/20 => Loss 3.374, Loss_clf 0.442, Loss_fe 0.517, Loss_kd 2.173, Train_accy 85.09:  30%|███       | 6/20 [10:13<20:48, 89.15s/it]                 Task 9, Epoch 7/20 => Loss 3.374, Loss_clf 0.442, Loss_fe 0.517, Loss_kd 2.173, Train_accy 85.09:  35%|███▌      | 7/20 [10:13<18:57, 87.54s/it]Task 9, Epoch 8/20 => Loss 3.350, Loss_clf 0.437, Loss_fe 0.490, Loss_kd 2.181, Train_accy 84.97:  35%|███▌      | 7/20 [11:38<18:57, 87.54s/it]Task 9, Epoch 8/20 => Loss 3.350, Loss_clf 0.437, Loss_fe 0.490, Loss_kd 2.181, Train_accy 84.97:  40%|████      | 8/20 [11:38<17:17, 86.47s/it]Task 9, Epoch 9/20 => Loss 3.385, Loss_clf 0.463, Loss_fe 0.493, Loss_kd 2.186, Train_accy 84.62:  40%|████      | 8/20 [13:02<17:17, 86.47s/it]Task 9, Epoch 9/20 => Loss 3.385, Loss_clf 0.463, Loss_fe 0.493, Loss_kd 2.186, Train_accy 84.62:  45%|████▌     | 9/20 [13:02<15:43, 85.74s/it]Task 9, Epoch 10/20 => Loss 3.348, Loss_clf 0.474, Loss_fe 0.449, Loss_kd 2.183, Train_accy 84.50:  45%|████▌     | 9/20 [14:26<15:43, 85.74s/it]Task 9, Epoch 10/20 => Loss 3.348, Loss_clf 0.474, Loss_fe 0.449, Loss_kd 2.183, Train_accy 84.50:  50%|█████     | 10/20 [14:26<14:12, 85.25s/it]Task 9, Epoch 11/20 => Loss 3.240, Loss_clf 0.406, Loss_fe 0.406, Loss_kd 2.185, Train_accy 85.99, Test_accy 88.94:  50%|█████     | 10/20 [16:02<14:12, 85.25s/it]Task 9, Epoch 11/20 => Loss 3.240, Loss_clf 0.406, Loss_fe 0.406, Loss_kd 2.185, Train_accy 85.99, Test_accy 88.94:  55%|█████▌    | 11/20 [16:02<13:17, 88.62s/it]Task 9, Epoch 12/20 => Loss 3.266, Loss_clf 0.435, Loss_fe 0.401, Loss_kd 2.187, Train_accy 85.83:  55%|█████▌    | 11/20 [17:26<13:17, 88.62s/it]                 Task 9, Epoch 12/20 => Loss 3.266, Loss_clf 0.435, Loss_fe 0.401, Loss_kd 2.187, Train_accy 85.83:  60%|██████    | 12/20 [17:26<11:38, 87.26s/it]Task 9, Epoch 13/20 => Loss 3.154, Loss_clf 0.393, Loss_fe 0.352, Loss_kd 2.168, Train_accy 85.71:  60%|██████    | 12/20 [18:52<11:38, 87.26s/it]Task 9, Epoch 13/20 => Loss 3.154, Loss_clf 0.393, Loss_fe 0.352, Loss_kd 2.168, Train_accy 85.71:  65%|██████▌   | 13/20 [18:52<10:07, 86.78s/it]Task 9, Epoch 14/20 => Loss 3.145, Loss_clf 0.383, Loss_fe 0.342, Loss_kd 2.178, Train_accy 86.54:  65%|██████▌   | 13/20 [20:16<10:07, 86.78s/it]Task 9, Epoch 14/20 => Loss 3.145, Loss_clf 0.383, Loss_fe 0.342, Loss_kd 2.178, Train_accy 86.54:  70%|███████   | 14/20 [20:16<08:36, 86.02s/it]Task 9, Epoch 15/20 => Loss 3.107, Loss_clf 0.364, Loss_fe 0.319, Loss_kd 2.182, Train_accy 87.09:  70%|███████   | 14/20 [21:40<08:36, 86.02s/it]Task 9, Epoch 15/20 => Loss 3.107, Loss_clf 0.364, Loss_fe 0.319, Loss_kd 2.182, Train_accy 87.09:  75%|███████▌  | 15/20 [21:40<07:07, 85.47s/it]Task 9, Epoch 16/20 => Loss 3.145, Loss_clf 0.403, Loss_fe 0.323, Loss_kd 2.177, Train_accy 85.99, Test_accy 89.73:  75%|███████▌  | 15/20 [23:17<07:07, 85.47s/it]Task 9, Epoch 16/20 => Loss 3.145, Loss_clf 0.403, Loss_fe 0.323, Loss_kd 2.177, Train_accy 85.99, Test_accy 89.73:  80%|████████  | 16/20 [23:17<05:54, 88.71s/it]Task 9, Epoch 17/20 => Loss 3.041, Loss_clf 0.345, Loss_fe 0.297, Loss_kd 2.158, Train_accy 87.87:  80%|████████  | 16/20 [24:41<05:54, 88.71s/it]                 Task 9, Epoch 17/20 => Loss 3.041, Loss_clf 0.345, Loss_fe 0.297, Loss_kd 2.158, Train_accy 87.87:  85%|████████▌ | 17/20 [24:41<04:22, 87.35s/it]Task 9, Epoch 18/20 => Loss 3.048, Loss_clf 0.353, Loss_fe 0.289, Loss_kd 2.165, Train_accy 87.21:  85%|████████▌ | 17/20 [26:05<04:22, 87.35s/it]Task 9, Epoch 18/20 => Loss 3.048, Loss_clf 0.353, Loss_fe 0.289, Loss_kd 2.165, Train_accy 87.21:  90%|█████████ | 18/20 [26:05<02:52, 86.40s/it]Task 9, Epoch 19/20 => Loss 3.121, Loss_clf 0.393, Loss_fe 0.302, Loss_kd 2.183, Train_accy 86.62:  90%|█████████ | 18/20 [27:29<02:52, 86.40s/it]Task 9, Epoch 19/20 => Loss 3.121, Loss_clf 0.393, Loss_fe 0.302, Loss_kd 2.183, Train_accy 86.62:  95%|█████████▌| 19/20 [27:29<01:25, 85.73s/it]Task 9, Epoch 20/20 => Loss 3.071, Loss_clf 0.366, Loss_fe 0.301, Loss_kd 2.163, Train_accy 87.24:  95%|█████████▌| 19/20 [28:53<01:25, 85.73s/it]Task 9, Epoch 20/20 => Loss 3.071, Loss_clf 0.366, Loss_fe 0.301, Loss_kd 2.163, Train_accy 87.24: 100%|██████████| 20/20 [28:53<00:00, 85.27s/it]Task 9, Epoch 20/20 => Loss 3.071, Loss_clf 0.366, Loss_fe 0.301, Loss_kd 2.163, Train_accy 87.24: 100%|██████████| 20/20 [28:53<00:00, 86.69s/it]
2023-10-25 19:46:13,502 [foster.py] => Task 9, Epoch 20/20 => Loss 3.071, Loss_clf 0.366, Loss_fe 0.301, Loss_kd 2.163, Train_accy 87.24
2023-10-25 19:46:13,503 [foster.py] => do not weight align teacher!
2023-10-25 19:46:13,504 [foster.py] => per cls weights : [1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494 1.04898494
 0.55913551 0.55913551 0.55913551 0.55913551 0.55913551 0.55913551
 0.55913551 0.55913551 0.55913551 0.55913551]
2023-10-25 19:46:14,139 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 19:46:14,523 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 9, Epoch 1/20 => Loss 2.291,  Train_accy 79.00, Test_accy 83.30:   0%|          | 0/20 [01:46<?, ?it/s]SNet: Task 9, Epoch 1/20 => Loss 2.291,  Train_accy 79.00, Test_accy 83.30:   5%|▌         | 1/20 [01:46<33:42, 106.42s/it]SNet: Task 9, Epoch 2/20 => Loss 2.309,  Train_accy 78.89:   5%|▌         | 1/20 [03:26<33:42, 106.42s/it]                 SNet: Task 9, Epoch 2/20 => Loss 2.309,  Train_accy 78.89:  10%|█         | 2/20 [03:26<30:46, 102.56s/it]SNet: Task 9, Epoch 3/20 => Loss 2.281,  Train_accy 81.44:  10%|█         | 2/20 [05:05<30:46, 102.56s/it]SNet: Task 9, Epoch 3/20 => Loss 2.281,  Train_accy 81.44:  15%|█▌        | 3/20 [05:05<28:40, 101.22s/it]SNet: Task 9, Epoch 4/20 => Loss 2.289,  Train_accy 81.87:  15%|█▌        | 3/20 [06:45<28:40, 101.22s/it]SNet: Task 9, Epoch 4/20 => Loss 2.289,  Train_accy 81.87:  20%|██        | 4/20 [06:45<26:49, 100.60s/it]SNet: Task 9, Epoch 5/20 => Loss 2.293,  Train_accy 81.75:  20%|██        | 4/20 [08:25<26:49, 100.60s/it]SNet: Task 9, Epoch 5/20 => Loss 2.293,  Train_accy 81.75:  25%|██▌       | 5/20 [08:25<25:03, 100.26s/it]SNet: Task 9, Epoch 6/20 => Loss 2.281,  Train_accy 81.40, Test_accy 87.47:  25%|██▌       | 5/20 [10:11<25:03, 100.26s/it]SNet: Task 9, Epoch 6/20 => Loss 2.281,  Train_accy 81.40, Test_accy 87.47:  30%|███       | 6/20 [10:11<23:52, 102.30s/it]SNet: Task 9, Epoch 7/20 => Loss 2.270,  Train_accy 83.28:  30%|███       | 6/20 [11:51<23:52, 102.30s/it]                 SNet: Task 9, Epoch 7/20 => Loss 2.270,  Train_accy 83.28:  35%|███▌      | 7/20 [11:51<21:58, 101.44s/it]SNet: Task 9, Epoch 8/20 => Loss 2.272,  Train_accy 83.79:  35%|███▌      | 7/20 [13:30<21:58, 101.44s/it]SNet: Task 9, Epoch 8/20 => Loss 2.272,  Train_accy 83.79:  40%|████      | 8/20 [13:30<20:10, 100.87s/it]SNet: Task 9, Epoch 9/20 => Loss 2.236,  Train_accy 84.65:  40%|████      | 8/20 [15:10<20:10, 100.87s/it]SNet: Task 9, Epoch 9/20 => Loss 2.236,  Train_accy 84.65:  45%|████▌     | 9/20 [15:10<18:25, 100.48s/it]SNet: Task 9, Epoch 10/20 => Loss 2.277,  Train_accy 83.75:  45%|████▌     | 9/20 [16:50<18:25, 100.48s/it]SNet: Task 9, Epoch 10/20 => Loss 2.277,  Train_accy 83.75:  50%|█████     | 10/20 [16:50<16:42, 100.22s/it]SNet: Task 9, Epoch 11/20 => Loss 2.279,  Train_accy 82.97, Test_accy 88.04:  50%|█████     | 10/20 [18:36<16:42, 100.22s/it]SNet: Task 9, Epoch 11/20 => Loss 2.279,  Train_accy 82.97, Test_accy 88.04:  55%|█████▌    | 11/20 [18:36<15:18, 102.07s/it]SNet: Task 9, Epoch 12/20 => Loss 2.261,  Train_accy 83.36:  55%|█████▌    | 11/20 [20:15<15:18, 102.07s/it]                 SNet: Task 9, Epoch 12/20 => Loss 2.261,  Train_accy 83.36:  60%|██████    | 12/20 [20:15<13:30, 101.33s/it]SNet: Task 9, Epoch 13/20 => Loss 2.257,  Train_accy 83.95:  60%|██████    | 12/20 [21:55<13:30, 101.33s/it]SNet: Task 9, Epoch 13/20 => Loss 2.257,  Train_accy 83.95:  65%|██████▌   | 13/20 [21:55<11:45, 100.82s/it]SNet: Task 9, Epoch 14/20 => Loss 2.272,  Train_accy 83.48:  65%|██████▌   | 13/20 [23:35<11:45, 100.82s/it]SNet: Task 9, Epoch 14/20 => Loss 2.272,  Train_accy 83.48:  70%|███████   | 14/20 [23:35<10:02, 100.47s/it]SNet: Task 9, Epoch 15/20 => Loss 2.268,  Train_accy 84.46:  70%|███████   | 14/20 [25:14<10:02, 100.47s/it]SNet: Task 9, Epoch 15/20 => Loss 2.268,  Train_accy 84.46:  75%|███████▌  | 15/20 [25:14<08:21, 100.22s/it]SNet: Task 9, Epoch 16/20 => Loss 2.244,  Train_accy 85.16, Test_accy 88.15:  75%|███████▌  | 15/20 [27:01<08:21, 100.22s/it]SNet: Task 9, Epoch 16/20 => Loss 2.244,  Train_accy 85.16, Test_accy 88.15:  80%|████████  | 16/20 [27:01<06:48, 102.05s/it]SNet: Task 9, Epoch 17/20 => Loss 2.246,  Train_accy 84.03:  80%|████████  | 16/20 [28:40<06:48, 102.05s/it]                 SNet: Task 9, Epoch 17/20 => Loss 2.246,  Train_accy 84.03:  85%|████████▌ | 17/20 [28:40<05:03, 101.31s/it]SNet: Task 9, Epoch 18/20 => Loss 2.271,  Train_accy 82.85:  85%|████████▌ | 17/20 [30:20<05:03, 101.31s/it]SNet: Task 9, Epoch 18/20 => Loss 2.271,  Train_accy 82.85:  90%|█████████ | 18/20 [30:20<03:21, 100.83s/it]SNet: Task 9, Epoch 19/20 => Loss 2.283,  Train_accy 83.59:  90%|█████████ | 18/20 [32:00<03:21, 100.83s/it]SNet: Task 9, Epoch 19/20 => Loss 2.283,  Train_accy 83.59:  95%|█████████▌| 19/20 [32:00<01:40, 100.46s/it]SNet: Task 9, Epoch 20/20 => Loss 2.263,  Train_accy 83.83:  95%|█████████▌| 19/20 [33:39<01:40, 100.46s/it]SNet: Task 9, Epoch 20/20 => Loss 2.263,  Train_accy 83.83: 100%|██████████| 20/20 [33:39<00:00, 100.22s/it]SNet: Task 9, Epoch 20/20 => Loss 2.263,  Train_accy 83.83: 100%|██████████| 20/20 [33:39<00:00, 100.99s/it]
2023-10-25 20:19:54,847 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 2.263,  Train_accy 83.83
2023-10-25 20:19:54,862 [foster.py] => do not weight align student!
2023-10-25 20:20:01,429 [foster.py] => darknet eval: 
2023-10-25 20:20:01,430 [foster.py] => CNN top1 curve: 88.15
2023-10-25 20:20:01,430 [foster.py] => CNN top5 curve: 98.98
2023-10-25 20:20:01,432 [base.py] => Constructing exemplars for new classes...(25 per classes)
2023-10-25 20:22:09,633 [foster.py] => Exemplar size: 2500
2023-10-25 20:22:10,228 [trainer.py] => CNN: {'total': 89.62, '00-09': 85.06, '10-19': 93.26, '20-29': 96.59, '30-39': 93.18, '40-49': 93.26, '50-59': 95.56, '60-69': 86.52, '70-79': 93.33, '80-89': 96.55, '90-99': 62.92, 'old': 92.6, 'new': 62.92}
2023-10-25 20:22:10,228 [trainer.py] => NME: {'total': 93.0, '00-09': 87.36, '10-19': 88.76, '20-29': 95.45, '30-39': 96.59, '40-49': 93.26, '50-59': 93.33, '60-69': 87.64, '70-79': 96.67, '80-89': 98.85, '90-99': 92.13, 'old': 93.1, 'new': 92.13}
2023-10-25 20:22:10,228 [trainer.py] => CNN top1 curve: [96.55, 90.34, 93.56, 90.06, 90.48, 91.34, 90.32, 89.44, 89.59, 89.62]
2023-10-25 20:22:10,228 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.43, 99.09, 98.87, 99.03, 99.15, 99.5, 99.21]
2023-10-25 20:22:10,228 [trainer.py] => NME top1 curve: [97.7, 93.18, 96.21, 92.05, 93.42, 94.16, 92.42, 93.94, 93.6, 93.0]
2023-10-25 20:22:10,228 [trainer.py] => NME top5 curve: [100.0, 100.0, 100.0, 99.72, 99.77, 99.62, 99.52, 99.44, 99.25, 99.32]

Average Accuracy (CNN): 91.13000000000002
Average Accuracy (NME): 93.96799999999999
2023-10-25 20:22:10,228 [trainer.py] => Average Accuracy (CNN): 91.13000000000002
2023-10-25 20:22:10,228 [trainer.py] => Average Accuracy (NME): 93.96799999999999
2023-10-25 20:22:10,232 [trainer.py] => All params: 105356654
2023-10-25 20:22:10,235 [trainer.py] => Trainable params: 52738862
2023-10-25 20:22:10,797 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 20:22:11,498 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2023-10-25 20:22:11,595 [foster.py] => Learning on 100-110
2023-10-25 20:22:11,600 [foster.py] => All params: 105379724
2023-10-25 20:22:11,603 [foster.py] => Trainable params: 52756162
/home/users/smu/zichent1/study/pilot/models/foster.py:147: RuntimeWarning: divide by zero encountered in divide
  per_cls_weights = (1.0 - self.beta1) / np.array(effective_num)
/home/users/smu/zichent1/study/pilot/models/foster.py:149: RuntimeWarning: invalid value encountered in divide
  per_cls_weights / np.sum(per_cls_weights) * len(cls_num_list)
2023-10-25 20:22:11,682 [foster.py] => per cls weights : [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0. nan nan nan nan nan nan nan nan
 nan nan]
  0%|          | 0/20 [00:00<?, ?it/s]Task 10, Epoch 1/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.52, Test_accy 1.02:   0%|          | 0/20 [01:35<?, ?it/s]Task 10, Epoch 1/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.52, Test_accy 1.02:   5%|▌         | 1/20 [01:35<30:10, 95.32s/it]Task 10, Epoch 2/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:   5%|▌         | 1/20 [02:57<30:10, 95.32s/it]                Task 10, Epoch 2/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  10%|█         | 2/20 [02:57<26:18, 87.72s/it]Task 10, Epoch 3/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  10%|█         | 2/20 [04:20<26:18, 87.72s/it]Task 10, Epoch 3/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  15%|█▌        | 3/20 [04:20<24:10, 85.30s/it]Task 10, Epoch 4/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  15%|█▌        | 3/20 [05:42<24:10, 85.30s/it]Task 10, Epoch 4/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  20%|██        | 4/20 [05:42<22:26, 84.17s/it]Task 10, Epoch 5/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  20%|██        | 4/20 [07:05<22:26, 84.17s/it]Task 10, Epoch 5/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  25%|██▌       | 5/20 [07:05<20:54, 83.60s/it]Task 10, Epoch 6/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00, Test_accy 1.02:  25%|██▌       | 5/20 [08:39<20:54, 83.60s/it]Task 10, Epoch 6/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00, Test_accy 1.02:  30%|███       | 6/20 [08:39<20:22, 87.30s/it]Task 10, Epoch 7/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  30%|███       | 6/20 [10:02<20:22, 87.30s/it]                Task 10, Epoch 7/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  35%|███▌      | 7/20 [10:02<18:34, 85.70s/it]Task 10, Epoch 8/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  35%|███▌      | 7/20 [11:24<18:34, 85.70s/it]Task 10, Epoch 8/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  40%|████      | 8/20 [11:24<16:55, 84.66s/it]Task 10, Epoch 9/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  40%|████      | 8/20 [12:46<16:55, 84.66s/it]Task 10, Epoch 9/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  45%|████▌     | 9/20 [12:46<15:23, 83.96s/it]Task 10, Epoch 10/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  45%|████▌     | 9/20 [14:09<15:23, 83.96s/it]Task 10, Epoch 10/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  50%|█████     | 10/20 [14:09<13:54, 83.47s/it]Task 10, Epoch 11/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00, Test_accy 1.02:  50%|█████     | 10/20 [15:43<13:54, 83.47s/it]Task 10, Epoch 11/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00, Test_accy 1.02:  55%|█████▌    | 11/20 [15:43<13:01, 86.82s/it]Task 10, Epoch 12/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  55%|█████▌    | 11/20 [17:06<13:01, 86.82s/it]                Task 10, Epoch 12/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  60%|██████    | 12/20 [17:06<11:23, 85.49s/it]Task 10, Epoch 13/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  60%|██████    | 12/20 [18:28<11:23, 85.49s/it]Task 10, Epoch 13/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  65%|██████▌   | 13/20 [18:28<09:51, 84.55s/it]Task 10, Epoch 14/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  65%|██████▌   | 13/20 [19:50<09:51, 84.55s/it]Task 10, Epoch 14/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  70%|███████   | 14/20 [19:50<08:23, 83.91s/it]Task 10, Epoch 15/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  70%|███████   | 14/20 [21:13<08:23, 83.91s/it]Task 10, Epoch 15/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  75%|███████▌  | 15/20 [21:13<06:57, 83.47s/it]Task 10, Epoch 16/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00, Test_accy 1.02:  75%|███████▌  | 15/20 [22:48<06:57, 83.47s/it]Task 10, Epoch 16/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00, Test_accy 1.02:  80%|████████  | 16/20 [22:48<05:47, 86.82s/it]Task 10, Epoch 17/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  80%|████████  | 16/20 [24:10<05:47, 86.82s/it]                Task 10, Epoch 17/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  85%|████████▌ | 17/20 [24:10<04:16, 85.49s/it]Task 10, Epoch 18/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  85%|████████▌ | 17/20 [25:32<04:16, 85.49s/it]Task 10, Epoch 18/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  90%|█████████ | 18/20 [25:32<02:49, 84.57s/it]Task 10, Epoch 19/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  90%|█████████ | 18/20 [26:55<02:49, 84.57s/it]Task 10, Epoch 19/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  95%|█████████▌| 19/20 [26:55<01:23, 83.93s/it]Task 10, Epoch 20/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00:  95%|█████████▌| 19/20 [28:17<01:23, 83.93s/it]Task 10, Epoch 20/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00: 100%|██████████| 20/20 [28:17<00:00, 83.49s/it]Task 10, Epoch 20/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00: 100%|██████████| 20/20 [28:17<00:00, 84.89s/it]
2023-10-25 20:50:29,400 [foster.py] => Task 10, Epoch 20/20 => Loss nan, Loss_clf nan, Loss_fe nan, Loss_kd nan, Train_accy 1.00
2023-10-25 20:50:29,402 [foster.py] => do not weight align teacher!
/home/users/smu/zichent1/study/pilot/models/foster.py:187: RuntimeWarning: divide by zero encountered in divide
  per_cls_weights = (1.0 - self.beta2) / np.array(effective_num)
/home/users/smu/zichent1/study/pilot/models/foster.py:189: RuntimeWarning: invalid value encountered in divide
  per_cls_weights / np.sum(per_cls_weights) * len(cls_num_list)
2023-10-25 20:50:29,403 [foster.py] => per cls weights : [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
  0.  0.  0.  0.  0.  0.  0.  0.  0.  0. nan nan nan nan nan nan nan nan
 nan nan]
2023-10-25 20:50:30,014 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/caformer_m36.sail_in22k_ft_in1k_384)
2023-10-25 20:50:30,542 [_hub.py] => [timm/caformer_m36.sail_in22k_ft_in1k_384] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 10, Epoch 1/20 => Loss nan,  Train_accy 1.44, Test_accy 1.02:   0%|          | 0/20 [01:44<?, ?it/s]SNet: Task 10, Epoch 1/20 => Loss nan,  Train_accy 1.44, Test_accy 1.02:   5%|▌         | 1/20 [01:44<33:03, 104.40s/it]SNet: Task 10, Epoch 2/20 => Loss nan,  Train_accy 1.00:   5%|▌         | 1/20 [03:22<33:03, 104.40s/it]                SNet: Task 10, Epoch 2/20 => Loss nan,  Train_accy 1.00:  10%|█         | 2/20 [03:22<30:16, 100.92s/it]SNet: Task 10, Epoch 3/20 => Loss nan,  Train_accy 1.00:  10%|█         | 2/20 [05:00<30:16, 100.92s/it]SNet: Task 10, Epoch 3/20 => Loss nan,  Train_accy 1.00:  15%|█▌        | 3/20 [05:00<28:11, 99.49s/it] SNet: Task 10, Epoch 4/20 => Loss nan,  Train_accy 1.00:  15%|█▌        | 3/20 [06:38<28:11, 99.49s/it]SNet: Task 10, Epoch 4/20 => Loss nan,  Train_accy 1.00:  20%|██        | 4/20 [06:38<26:21, 98.82s/it]SNet: Task 10, Epoch 5/20 => Loss nan,  Train_accy 1.00:  20%|██        | 4/20 [08:16<26:21, 98.82s/it]SNet: Task 10, Epoch 5/20 => Loss nan,  Train_accy 1.00:  25%|██▌       | 5/20 [08:16<24:36, 98.45s/it]SNet: Task 10, Epoch 6/20 => Loss nan,  Train_accy 1.00, Test_accy 1.02:  25%|██▌       | 5/20 [10:00<24:36, 98.45s/it]SNet: Task 10, Epoch 6/20 => Loss nan,  Train_accy 1.00, Test_accy 1.02:  30%|███       | 6/20 [10:00<23:27, 100.51s/it]SNet: Task 10, Epoch 7/20 => Loss nan,  Train_accy 1.00:  30%|███       | 6/20 [11:38<23:27, 100.51s/it]                SNet: Task 10, Epoch 7/20 => Loss nan,  Train_accy 1.00:  35%|███▌      | 7/20 [11:38<21:35, 99.62s/it] SNet: Task 10, Epoch 8/20 => Loss nan,  Train_accy 1.00:  35%|███▌      | 7/20 [13:16<21:35, 99.62s/it]SNet: Task 10, Epoch 8/20 => Loss nan,  Train_accy 1.00:  40%|████      | 8/20 [13:16<19:48, 99.03s/it]SNet: Task 10, Epoch 9/20 => Loss nan,  Train_accy 1.00:  40%|████      | 8/20 [14:54<19:48, 99.03s/it]SNet: Task 10, Epoch 9/20 => Loss nan,  Train_accy 1.00:  45%|████▌     | 9/20 [14:54<18:05, 98.64s/it]SNet: Task 10, Epoch 10/20 => Loss nan,  Train_accy 1.00:  45%|████▌     | 9/20 [16:31<18:05, 98.64s/it]SNet: Task 10, Epoch 10/20 => Loss nan,  Train_accy 1.00:  50%|█████     | 10/20 [16:31<16:23, 98.39s/it]SNet: Task 10, Epoch 11/20 => Loss nan,  Train_accy 1.00, Test_accy 1.02:  50%|█████     | 10/20 [18:16<16:23, 98.39s/it]SNet: Task 10, Epoch 11/20 => Loss nan,  Train_accy 1.00, Test_accy 1.02:  55%|█████▌    | 11/20 [18:16<15:02, 100.24s/it]SNet: Task 10, Epoch 12/20 => Loss nan,  Train_accy 1.00:  55%|█████▌    | 11/20 [19:54<15:02, 100.24s/it]                SNet: Task 10, Epoch 12/20 => Loss nan,  Train_accy 1.00:  60%|██████    | 12/20 [19:54<13:16, 99.50s/it] SNet: Task 10, Epoch 13/20 => Loss nan,  Train_accy 1.00:  60%|██████    | 12/20 [21:31<13:16, 99.50s/it]SNet: Task 10, Epoch 13/20 => Loss nan,  Train_accy 1.00:  65%|██████▌   | 13/20 [21:31<11:32, 98.97s/it]SNet: Task 10, Epoch 14/20 => Loss nan,  Train_accy 1.00:  65%|██████▌   | 13/20 [23:09<11:32, 98.97s/it]SNet: Task 10, Epoch 14/20 => Loss nan,  Train_accy 1.00:  70%|███████   | 14/20 [23:09<09:51, 98.63s/it]SNet: Task 10, Epoch 15/20 => Loss nan,  Train_accy 1.00:  70%|███████   | 14/20 [24:47<09:51, 98.63s/it]SNet: Task 10, Epoch 15/20 => Loss nan,  Train_accy 1.00:  75%|███████▌  | 15/20 [24:47<08:11, 98.39s/it]SNet: Task 10, Epoch 16/20 => Loss nan,  Train_accy 1.00, Test_accy 1.02:  75%|███████▌  | 15/20 [26:32<08:11, 98.39s/it]SNet: Task 10, Epoch 16/20 => Loss nan,  Train_accy 1.00, Test_accy 1.02:  80%|████████  | 16/20 [26:32<06:40, 100.21s/it]SNet: Task 10, Epoch 17/20 => Loss nan,  Train_accy 1.00:  80%|████████  | 16/20 [28:09<06:40, 100.21s/it]                SNet: Task 10, Epoch 17/20 => Loss nan,  Train_accy 1.00:  85%|████████▌ | 17/20 [28:09<04:58, 99.49s/it] SNet: Task 10, Epoch 18/20 => Loss nan,  Train_accy 1.00:  85%|████████▌ | 17/20 [29:47<04:58, 99.49s/it]SNet: Task 10, Epoch 18/20 => Loss nan,  Train_accy 1.00:  90%|█████████ | 18/20 [29:47<03:17, 98.98s/it]SNet: Task 10, Epoch 19/20 => Loss nan,  Train_accy 1.00:  90%|█████████ | 18/20 [31:25<03:17, 98.98s/it]SNet: Task 10, Epoch 19/20 => Loss nan,  Train_accy 1.00:  95%|█████████▌| 19/20 [31:25<01:38, 98.62s/it]SNet: Task 10, Epoch 20/20 => Loss nan,  Train_accy 1.00:  95%|█████████▌| 19/20 [33:03<01:38, 98.62s/it]SNet: Task 10, Epoch 20/20 => Loss nan,  Train_accy 1.00: 100%|██████████| 20/20 [33:03<00:00, 98.38s/it]SNet: Task 10, Epoch 20/20 => Loss nan,  Train_accy 1.00: 100%|██████████| 20/20 [33:03<00:00, 99.16s/it]
2023-10-25 21:23:33,893 [foster.py] => SNet: Task 10, Epoch 20/20 => Loss nan,  Train_accy 1.00
2023-10-25 21:23:33,894 [foster.py] => do not weight align student!
/home/users/smu/zichent1/study/pilot/utils/toolkit.py:60: RuntimeWarning: invalid value encountered in scalar divide
  (y_pred[idxes] == y_true[idxes]).sum() * 100 / len(idxes), decimals=2
2023-10-25 21:23:40,509 [foster.py] => darknet eval: 
2023-10-25 21:23:40,509 [foster.py] => CNN top1 curve: 1.02
2023-10-25 21:23:40,509 [foster.py] => CNN top5 curve: 5.08
2023-10-25 21:23:40,512 [base.py] => Constructing exemplars for new classes...(25 per classes)
Traceback (most recent call last):
  File "/home/users/smu/zichent1/study/pilot/main.py", line 41, in <module>
    main()
  File "/home/users/smu/zichent1/study/pilot/main.py", line 12, in main
    train(args)
  File "/home/users/smu/zichent1/study/pilot/trainer.py", line 18, in train
    _train(args)
  File "/home/users/smu/zichent1/study/pilot/trainer.py", line 68, in _train
    model.incremental_train(data_manager)
  File "/home/users/smu/zichent1/study/pilot/models/foster.py", line 88, in incremental_train
    self.build_rehearsal_memory(data_manager, self.samples_per_class)
  File "/home/users/smu/zichent1/study/pilot/models/base.py", line 55, in build_rehearsal_memory
    self._construct_exemplar_unified(data_manager, per_class)
  File "/home/users/smu/zichent1/study/pilot/models/base.py", line 423, in _construct_exemplar_unified
    vectors, _ = self._extract_vectors(class_loader)
  File "/home/users/smu/zichent1/study/pilot/models/base.py", line 275, in _extract_vectors
    return np.concatenate(vectors), np.concatenate(targets)
ValueError: need at least one array to concatenate
======================================================================================

			Resource Usage on 2023-10-25 21:25:14.082457:

	JobId: 4099175.pbs101  
	Project: 21026844 
	Exit Status: 1
	NCPUs Requested: 16				NCPUs Used: 16
							CPU Time Used: 08:40:47
	Memory Requested: 110gb 			Memory Used: 19174468kb
							Vmem Used: 368330184kb
	Walltime requested: 24:00:00 			Walltime Used: 07:04:38
	
	Execution Nodes Used: (x1000c0s2b0n1:ngpus=1:ncpus=16:mem=115343360kb)
	
 ======================================================================================
